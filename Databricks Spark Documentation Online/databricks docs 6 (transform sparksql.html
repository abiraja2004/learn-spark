<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>databricks docs 6 (transform sparksql - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"serverlessDefaultSparkVersion":"2.2.x-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","enableTableHandler":false,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableFindAndReplace":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 RC1 (Scala 2.10)","packageLabel":"spark-image-b4aa93c32938e1947a3e5565e7f963af5c05e5bf2fcd0c69fa0cdc5a7f3f35d5","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-f43ddf8ad9acfd71338f5a51345f077173d236016ad7e39ffd6f698403acd4ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"3.1.x-scala2.11","displayName":"3.1 beta (Scala 2.11)","packageLabel":"spark-image-156e7fe2ab001d34ed6296c64799b21e48ec12170bcdfa5503f3253ac90d7bf9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"3.1.x-scala2.10","displayName":"3.1 beta (Scala 2.10)","packageLabel":"spark-image-d100fd3fc8250b24cdbeb07135d560388ac5ebef1e0fa5b19966ebb6a481dea2","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 RC1 (Scala 2.11)","packageLabel":"spark-image-6db1dbb7890e46eddcc56d5c944ea7a4fd6ea4080c61326ea1a4b4320a035950","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableClearStateAndRunAll":true,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":6,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"r4.16xlarge":16,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":8,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.75,"r4.8xlarge":8,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.375,"p2.16xlarge":24,"i3.8xlarge":12,"i3.16xlarge":24,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1.5,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":3,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"c4.8xlarge":4,"i3.xlarge":1.5,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.50","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"preferStartTerminatedCluster":true,"enableNonPollingTableCall":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"2162bae813344ed1541d63a989142c9938e96057","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewJobList":true,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3117922773650486,"name":"databricks docs 6 (transform sparksql","language":"python","commands":[{"version":"CommandV1","origId":3117922773650487,"guid":"28bedde4-cf4e-45f9-bd81-b7b0616b0b56","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql.functions import *\nfrom pyspark.sql.types import *\n\n# Convenience function for turning JSON strings into DataFrames.\ndef jsonToDataFrame(json, schema=None):\n  # SparkSessions are available with Spark 2.0+\n  reader = spark.read\n  if schema:\n    reader.schema(schema)\n  return reader.json(sc.parallelize([json]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529317727,"submitTime":1501529317517,"finishTime":1501529317885,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e1564056-982d-4ab8-b178-330decd242ba"},{"version":"CommandV1","origId":3117922773650489,"guid":"d3a8cb7a-8ce5-457a-a6f1-5513c6a3d245","subtype":"command","commandType":"auto","position":2.0,"command":"schema = StructType().add(\"a\", StructType().add(\"b\", IntegerType()))\n                          \nevents = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n     \"b\": 1\n  }\n}\n\"\"\", schema)\n\ndisplay(events.select(\"a.b\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529324591,"submitTime":1501529324591,"finishTime":1501529329555,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9ea1b3e7-0b67-4665-a4b3-74763725f470"},{"version":"CommandV1","origId":3117922773650490,"guid":"156f6112-9be7-40e1-a7bf-16a5e76d4bf2","subtype":"command","commandType":"auto","position":3.0,"command":"# Using a map\nschema = StructType().add(\"a\", MapType(StringType(), IntegerType()))\n                          \nevents = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n     \"b\": 1\n  }\n}\n\"\"\", schema)\n\ndisplay(events.select(\"a.b\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529334406,"submitTime":1501529334408,"finishTime":1501529334812,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"42493d20-52b7-4223-9754-a6a3e8b807fa"},{"version":"CommandV1","origId":3117922773650491,"guid":"83702b8a-abd1-4b64-a5d1-75574a37a47a","subtype":"command","commandType":"auto","position":4.0,"command":"events = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n     \"b\": 1,\n     \"c\": 2\n  }\n}\n\"\"\")\n\ndisplay(events.select(\"a.*\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"\"long\"","metadata":"{}"},{"name":"c","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529342297,"submitTime":1501529342300,"finishTime":1501529342821,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5415757e-c83b-46d1-bf7e-6a8112b0acfb"},{"version":"CommandV1","origId":3117922773650492,"guid":"34e91a31-8581-461c-b10f-f94b20a4da86","subtype":"command","commandType":"auto","position":5.0,"command":"events = jsonToDataFrame(\"\"\"\n{\n  \"a\": 1,\n  \"b\": 2,\n  \"c\": 3\n}\n\"\"\")\n\ndisplay(events.select(struct(col(\"a\").alias(\"y\")).alias(\"x\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"y\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529349882,"submitTime":1501529349884,"finishTime":1501529350370,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"79ea1619-ac60-4822-88ca-e1f74fbd498a"},{"version":"CommandV1","origId":3117922773650493,"guid":"d14f2065-d9f2-408f-ab33-ba2ce4165f40","subtype":"command","commandType":"auto","position":6.0,"command":"events = jsonToDataFrame(\"\"\"\n{\n  \"a\": 1,\n  \"b\": 2\n}\n\"\"\")\n\ndisplay(events.select(struct(\"*\").alias(\"x\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1,2]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"a\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"b\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529357349,"submitTime":1501529357351,"finishTime":1501529357793,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9b496213-e472-4686-93ab-1859cd6d36ad"},{"version":"CommandV1","origId":3117922773650494,"guid":"dac97095-ec63-42a9-bd3a-aebb7a92291e","subtype":"command","commandType":"auto","position":7.0,"command":"events = jsonToDataFrame(\"\"\"\n{\n  \"a\": [1, 2]\n}\n\"\"\")\n\ndisplay(events.select(col(\"a\").getItem(0).alias(\"x\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529364000,"submitTime":1501529364001,"finishTime":1501529364481,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"789722c4-24d0-48d7-a39c-8a14a9e4e197"},{"version":"CommandV1","origId":3117922773650495,"guid":"3fd8ca4a-0b55-492f-8d1f-8e1742415e03","subtype":"command","commandType":"auto","position":8.0,"command":"# Using a map\nschema = StructType().add(\"a\", MapType(StringType(), IntegerType()))\n\nevents = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n    \"b\": 1\n  }\n}\n\"\"\", schema)\n\ndisplay(events.select(col(\"a\").getItem(\"b\").alias(\"x\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529370598,"submitTime":1501529370597,"finishTime":1501529370872,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"da10957c-127e-4b6d-8413-f7243ad3909e"},{"version":"CommandV1","origId":3117922773650496,"guid":"2f4baf5a-7774-4ead-a5b9-0f8b1648bf81","subtype":"command","commandType":"auto","position":9.0,"command":"events = jsonToDataFrame(\"\"\"\n{\n  \"a\": [1, 2]\n}\n\"\"\")\n\ndisplay(events.select(explode(\"a\").alias(\"x\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1],[2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529377371,"submitTime":1501529377370,"finishTime":1501529377826,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"48b81b56-6c78-4cc0-aebc-17c58d056187"},{"version":"CommandV1","origId":3117922773650497,"guid":"93a9ebf1-7df3-4615-89cb-b9d0aaaf0314","subtype":"command","commandType":"auto","position":10.0,"command":"# Using a map\nschema = StructType().add(\"a\", MapType(StringType(), IntegerType()))\n\nevents = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n    \"b\": 1,\n    \"c\": 2\n  }\n}\n\"\"\", schema)\n\ndisplay(events.select(explode(\"a\").alias(\"x\", \"y\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["b",1],["c",2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"string\"","metadata":"{}"},{"name":"y","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529384032,"submitTime":1501529384031,"finishTime":1501529384386,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"37c6d29b-c6e3-4882-911f-3de8c092d9b1"},{"version":"CommandV1","origId":3117922773650498,"guid":"fe5fb03b-535a-46f4-bb85-2507173b1a7b","subtype":"command","commandType":"auto","position":11.0,"command":"events = jsonToDataFrame(\"\"\"\n[{ \"x\": 1 }, { \"x\": 2 }]\n\"\"\")\n\ndisplay(events.select(collect_list(\"x\").alias(\"x\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1,2]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529390259,"submitTime":1501529390258,"finishTime":1501529390957,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4e8217eb-5ee0-48d9-b2f0-18d94f085c85"},{"version":"CommandV1","origId":3117922773650499,"guid":"823aa975-ec9d-472c-8796-f3e009b05a7d","subtype":"command","commandType":"auto","position":12.0,"command":"# using an aggregation\nevents = jsonToDataFrame(\"\"\"\n[{ \"x\": 1, \"y\": \"a\" }, { \"x\": 2, \"y\": \"b\" }]\n\"\"\")\n\ndisplay(events.groupBy(\"y\").agg(collect_list(\"x\").alias(\"x\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["b",[2]],["a",[1]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"y","type":"\"string\"","metadata":"{}"},{"name":"x","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529397448,"submitTime":1501529397447,"finishTime":1501529398612,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6fc88cf8-4a8a-4c7a-aea0-fbd2d2e6c307"},{"version":"CommandV1","origId":3117922773650500,"guid":"c46c12c4-82c2-47cb-a39b-d3ef2b2a65d5","subtype":"command","commandType":"auto","position":13.0,"command":"events = jsonToDataFrame(\"\"\"\n{\n  \"a\": [\n    {\"b\": 1},\n    {\"b\": 2}\n  ]\n}\n\"\"\")\n\ndisplay(events.select(\"a.b\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1,2]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529406190,"submitTime":1501529406190,"finishTime":1501529406610,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f9493191-66d6-493c-8453-83c7e921abd4"},{"version":"CommandV1","origId":3117922773650501,"guid":"dbacf519-95e3-4f1c-ad9e-8383154f56fd","subtype":"command","commandType":"auto","position":14.0,"command":"events = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n    \"b\": 1\n  }\n}\n\"\"\")\n\ndisplay(events.select(to_json(\"a\").alias(\"c\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["{\"b\":1}"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529413286,"submitTime":1501529413284,"finishTime":1501529413730,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9575ff8e-6907-4e97-97e6-c0abbea43ea9"},{"version":"CommandV1","origId":3117922773650502,"guid":"746f3c68-0bc0-49bf-884a-f20ae17c2886","subtype":"command","commandType":"auto","position":15.0,"command":"events = jsonToDataFrame(\"\"\"\n{\n  \"a\": \"{\\\\\"b\\\\\":1}\"\n}\n\"\"\")\n\nschema = StructType().add(\"b\", IntegerType())\ndisplay(events.select(from_json(\"a\", schema).alias(\"c\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"b\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529419265,"submitTime":1501529419263,"finishTime":1501529419687,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b200c789-8529-4b30-b8e9-14d85ca3d70e"},{"version":"CommandV1","origId":3117922773650503,"guid":"c048faf8-60b0-4128-944b-ae41f2ef1873","subtype":"command","commandType":"auto","position":16.0,"command":"events = jsonToDataFrame(\"\"\"\n{\n  \"a\": \"{\\\\\"b\\\\\":{\\\\\"x\\\\\":1,\\\\\"y\\\\\":{\\\\\"z\\\\\":2}}}\"\n}\n\"\"\")\n\nschema = StructType().add(\"b\", StructType().add(\"x\", IntegerType())\n                            .add(\"y\", StringType()))\ndisplay(events.select(from_json(\"a\", schema).alias(\"c\")))\n\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[[1,"{\"z\":2}"]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"b\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"x\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"y\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529426358,"submitTime":1501529426348,"finishTime":1501529426774,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f36920aa-84b6-4de8-88b6-7c332b8fd1ad"},{"version":"CommandV1","origId":3117922773650504,"guid":"05ab00b4-876d-41a1-af6a-c8173b936127","subtype":"command","commandType":"auto","position":17.0,"command":"events = jsonToDataFrame(\"\"\"\n{\n  \"a\": \"{\\\\\"b\\\\\":1}\"\n}\n\"\"\")\n\ndisplay(events.select(json_tuple(\"a\", \"b\").alias(\"c\")))\n\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529432333,"submitTime":1501529432331,"finishTime":1501529432770,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fff40d9f-05fa-4ee8-b9b9-a5c2629999c5"},{"version":"CommandV1","origId":3117922773650505,"guid":"a2b43ea5-e44a-4dd1-92d2-5a8ff26a0542","subtype":"command","commandType":"auto","position":18.0,"command":"events = jsonToDataFrame(\"\"\"\n[{ \"a\": \"x: 1\" }, { \"a\": \"y: 2\" }]\n\"\"\")\n\ndisplay(events.select(regexp_extract(\"a\", \"([a-z]):\", 1).alias(\"c\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["x"],["y"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529444722,"submitTime":1501529444720,"finishTime":1501529445106,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3b361626-8c63-46cf-8b67-ace06ae5aca5"},{"version":"CommandV1","origId":3117922773650506,"guid":"46cd4b58-e71b-49c6-87c5-7ff60e65b2b9","subtype":"command","commandType":"auto","position":19.0,"command":"%scala\nimport org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n\n// Convenience function for turning JSON strings into DataFrames.\ndef jsonToDataFrame(json: String, schema: StructType = null): DataFrame = {\n  // SparkSessions are available with Spark 2.0+\n  val reader = spark.read\n  Option(schema).foreach(reader.schema)\n  reader.json(sc.parallelize(Array(json)))\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\njsonToDataFrame: (json: String, schema: org.apache.spark.sql.types.StructType)org.apache.spark.sql.DataFrame\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-19-d28ca422bfc1&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">5</span>\n<span class=\"ansiyellow\">    (/, Convenience, function, for, turning, JSON, strings, into, DataFrames.)</span>\n<span class=\"ansigrey\">     ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1501529468355,"submitTime":1501529468315,"finishTime":1501529474473,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f75f79b5-caf2-4614-9e56-e1ed31680d3b"},{"version":"CommandV1","origId":3117922773650507,"guid":"f8471964-2167-4810-9823-29b63c59a343","subtype":"command","commandType":"auto","position":20.0,"command":"%scala\n// Using a struct\nval schema = new StructType().add(\"a\", new StructType().add(\"b\", IntegerType))\n                          \nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n     \"b\": 1\n  }\n}\n\"\"\", schema)\n\ndisplay(events.select(\"a.b\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529482553,"submitTime":1501529482548,"finishTime":1501529483376,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"408b7050-34a9-406f-850c-731e999b2325"},{"version":"CommandV1","origId":3117922773650508,"guid":"12271724-5da5-4343-9720-c522867f1bf6","subtype":"command","commandType":"auto","position":21.0,"command":"%scala\nval schema = new StructType().add(\"a\", MapType(StringType, IntegerType))\n                          \nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n     \"b\": 1\n  }\n}\n\"\"\", schema)\n\ndisplay(events.select(\"a.b\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529492577,"submitTime":1501529492572,"finishTime":1501529492901,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7cc93228-3fd3-4797-8633-359b1eca0115"},{"version":"CommandV1","origId":3117922773650509,"guid":"b85d8e87-1386-48ad-a5b0-1527e3424d5e","subtype":"command","commandType":"auto","position":22.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n     \"b\": 1,\n     \"c\": 2\n  }\n}\n\"\"\")\n\ndisplay(events.select(\"a.*\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"\"long\"","metadata":"{}"},{"name":"c","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529501657,"submitTime":1501529501652,"finishTime":1501529501997,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f3ed77af-c4c1-42e0-a59c-b42821cda779"},{"version":"CommandV1","origId":3117922773650510,"guid":"a71b6682-adf2-4398-b550-76a4ea2e9412","subtype":"command","commandType":"auto","position":23.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": 1,\n  \"b\": 2,\n  \"c\": 3\n}\n\"\"\")\n\ndisplay(events.select(struct('a as 'y) as 'x))\n\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"y\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529509629,"submitTime":1501529509624,"finishTime":1501529510024,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2d8ea1eb-b059-4cc0-8e49-d84fac815f29"},{"version":"CommandV1","origId":3117922773650511,"guid":"5d05e1b7-504f-411e-af97-3bb542b5f2d4","subtype":"command","commandType":"auto","position":24.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": 1,\n  \"b\": 2\n}\n\"\"\")\n\ndisplay(events.select(struct(\"*\") as 'x))\n\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1,2]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"a\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"b\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529518314,"submitTime":1501529518308,"finishTime":1501529518712,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ad634ac1-5c80-4da0-9a04-8e37e26ebdc0"},{"version":"CommandV1","origId":3117922773650512,"guid":"448781b5-c269-4c07-b7ad-93594f3dc45c","subtype":"command","commandType":"auto","position":25.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": [1, 2]\n}\n\"\"\")\n\ndisplay(events.select('a.getItem(0) as 'x))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529526365,"submitTime":1501529526360,"finishTime":1501529526694,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5b430320-c7d5-449b-8067-2f94e11e61d0"},{"version":"CommandV1","origId":3117922773650513,"guid":"241919f0-29f7-435c-8f92-e87c5be74e4a","subtype":"command","commandType":"auto","position":26.0,"command":"%scala\nval schema = new StructType().add(\"a\", MapType(StringType, IntegerType))\n\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n    \"b\": 1\n  }\n}\n\"\"\", schema)\n\ndisplay(events.select('a.getItem(\"b\") as 'x))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529533825,"submitTime":1501529533818,"finishTime":1501529534062,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2fa93e54-1ff6-4444-8db1-9c6443b63a3d"},{"version":"CommandV1","origId":3117922773650514,"guid":"34b36fb9-ccd8-42c1-a062-bf09b2a9944a","subtype":"command","commandType":"auto","position":27.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": [1, 2]\n}\n\"\"\")\n\ndisplay(events.select(explode('a) as 'x))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1],[2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529541847,"submitTime":1501529541842,"finishTime":1501529542088,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9c3b6ac2-17e9-4e77-a3b3-b61bfb7c7d44"},{"version":"CommandV1","origId":3117922773650515,"guid":"ca8fa0e8-f2cd-4add-a1ae-236ce92db6e5","subtype":"command","commandType":"auto","position":28.0,"command":"%scala\n// Using a map\nval schema = new StructType().add(\"a\", MapType(StringType, IntegerType))\n\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n    \"b\": 1,\n    \"c\": 2\n  }\n}\n\"\"\", schema)\n\ndisplay(events.select(explode('a) as (Seq(\"x\", \"y\"))))\n\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["b",1],["c",2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"string\"","metadata":"{}"},{"name":"y","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529549592,"submitTime":1501529549586,"finishTime":1501529549825,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8aefc758-f9b2-4e56-8fb7-624a4d8f0f18"},{"version":"CommandV1","origId":3117922773650516,"guid":"91113f13-6df6-47df-91a5-4e322e93ed07","subtype":"command","commandType":"auto","position":29.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n[{ \"x\": 1 }, { \"x\": 2 }]\n\"\"\")\n\ndisplay(events.select(collect_list('x) as 'x))\n\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1,2]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529557426,"submitTime":1501529557419,"finishTime":1501529557758,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0821f040-1494-4e6c-b676-5bd9430137d1"},{"version":"CommandV1","origId":3117922773650517,"guid":"c071b255-618f-4bbc-a7bf-1994ab035fe7","subtype":"command","commandType":"auto","position":30.0,"command":"%scala\n// using an aggregation\nval events = jsonToDataFrame(\"\"\"\n[{ \"x\": 1, \"y\": \"a\" }, { \"x\": 2, \"y\": \"b\" }]\n\"\"\")\n\ndisplay(events.groupBy(\"y\").agg(collect_list('x) as 'x))\n\n\t","commandVersion":0,"state":"finished","results":{"type":"table","data":[["b",[2]],["a",[1]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"y","type":"\"string\"","metadata":"{}"},{"name":"x","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529565638,"submitTime":1501529565631,"finishTime":1501529566385,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a6e2420f-1bf1-4c83-94e5-6054c5201be5"},{"version":"CommandV1","origId":3117922773650518,"guid":"c4345b07-884e-4408-a65b-e9b7a23a9d78","subtype":"command","commandType":"auto","position":31.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": [\n    {\"b\": 1},\n    {\"b\": 2}\n  ]\n}\n\"\"\")\n\ndisplay(events.select(\"a.b\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1,2]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529573425,"submitTime":1501529573418,"finishTime":1501529573662,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"136a7b9f-419c-4c96-a4ab-dd301a5c2b46"},{"version":"CommandV1","origId":3117922773650519,"guid":"3be81f76-05c0-4a5f-b96b-1934fce3c4d5","subtype":"command","commandType":"auto","position":32.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n    \"b\": 1\n  }\n}\n\"\"\")\n\ndisplay(events.select(to_json('a) as 'c))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["{\"b\":1}"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529582168,"submitTime":1501529582161,"finishTime":1501529582403,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"53d0c42c-0f93-4ab4-af71-fa6e9d200bd6"},{"version":"CommandV1","origId":3117922773650520,"guid":"54dee5f7-ff7c-46bb-9de7-91e9811f69fb","subtype":"command","commandType":"auto","position":33.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": \"{\\\"b\\\":1}\"\n}\n\"\"\")\n\nval schema = new StructType().add(\"b\", IntegerType)\ndisplay(events.select(from_json('a, schema) as 'c))\n\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"b\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529588937,"submitTime":1501529588929,"finishTime":1501529589182,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eed61916-0573-4323-88ff-59a5c8b3ae38"},{"version":"CommandV1","origId":3117922773650521,"guid":"6365a0a9-2f8f-41f0-be4b-a34a6d08c178","subtype":"command","commandType":"auto","position":34.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": \"{\\\"b\\\":{\\\"x\\\":1,\\\"y\\\":{\\\"z\\\":2}}}\"\n}\n\"\"\")\n\nval schema = new StructType().add(\"b\", new StructType().add(\"x\", IntegerType)\n  .add(\"y\", StringType))\ndisplay(events.select(from_json('a, schema) as 'c))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[[1,"{\"z\":2}"]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"b\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"x\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"y\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529596715,"submitTime":1501529596707,"finishTime":1501529597006,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8f7cb8f6-e98e-4bef-bec5-cdfb7080ae33"},{"version":"CommandV1","origId":3117922773650522,"guid":"2556d335-6cc8-42ec-9ca5-514514f4a671","subtype":"command","commandType":"auto","position":35.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n{\n  \"a\": \"{\\\"b\\\":1}\"\n}\n\"\"\")\n\ndisplay(events.select(json_tuple('a, \"b\") as 'c))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529603987,"submitTime":1501529603978,"finishTime":1501529604242,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d79204e3-ecef-446c-abaa-22192dbc4821"},{"version":"CommandV1","origId":3117922773650523,"guid":"06cad207-cb2b-477b-b44e-21ac0892ccc2","subtype":"command","commandType":"auto","position":36.0,"command":"%scala\nval events = jsonToDataFrame(\"\"\"\n[{ \"a\": \"x: 1\" }, { \"a\": \"y: 2\" }]\n\"\"\")\n\ndisplay(events.select(regexp_extract('a, \"([a-z]):\", 1) as 'c))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["x"],["y"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529612584,"submitTime":1501529612575,"finishTime":1501529612793,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4d9c50d9-c966-44f3-afd1-cb404f532868"},{"version":"CommandV1","origId":3117922773650524,"guid":"1988b1bc-d571-43ee-bac4-cb4252605434","subtype":"command","commandType":"auto","position":37.0,"command":"from pyspark.sql.functions import *\nfrom pyspark.sql.types import *\n\n# Convenience function for turning JSON strings into DataFrames.\ndef jsonToDataFrame(json, schema=None):\n  # SparkSessions are available with Spark 2.0+\n  reader = spark.read\n  if schema:\n    reader.schema(schema)\n  reader.json(sc.parallelize([json])).createOrReplaceTempView(\"events\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529620753,"submitTime":1501529620744,"finishTime":1501529620828,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9b7f19b1-6fe5-4e22-b9fb-007f9058745e"},{"version":"CommandV1","origId":3117922773650525,"guid":"3c717dd4-ee39-43a9-a15d-1a86829fb467","subtype":"command","commandType":"auto","position":38.0,"command":"# Using a struct\nschema = StructType().add(\"a\", StructType().add(\"b\", IntegerType()))\n                          \njsonToDataFrame(\"\"\"\n{\n  \"a\": {\n     \"b\": 1\n  }\n}\n\"\"\", schema)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529629052,"submitTime":1501529629043,"finishTime":1501529629124,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f578438b-e1b2-4e83-ad8c-c7203d918b5e"},{"version":"CommandV1","origId":3117922773650526,"guid":"66b6e05f-f2ba-4ba6-a07e-9ff035dccc8b","subtype":"command","commandType":"auto","position":39.0,"command":"# Using a map\nschema = StructType().add(\"a\", MapType(StringType(), IntegerType()))\n                          \njsonToDataFrame(\"\"\"\n{\n  \"a\": {\n     \"b\": 1\n  }\n}\n\"\"\", schema)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529634892,"submitTime":1501529634882,"finishTime":1501529635014,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3193a42f-6aaf-46b8-9652-6e577caf22c2"},{"version":"CommandV1","origId":3117922773650527,"guid":"c3decdc2-8733-47ec-bc28-3108f5839838","subtype":"command","commandType":"auto","position":40.0,"command":"%sql\nselect a.b from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-23-533bb8a0e323&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    select a.b from events</span>\n<span class=\"ansigrey\">           ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1501529651260,"submitTime":1501529651238,"finishTime":1501529651723,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"acdc6cc4-771a-42ec-b9fa-0116a622b013"},{"version":"CommandV1","origId":3117922773650528,"guid":"78115592-ef7c-4c8c-8fea-255cd33fa2fe","subtype":"command","commandType":"auto","position":41.0,"command":"jsonToDataFrame(\"\"\"\n{\n  \"a\": {\n     \"b\": 1,\n     \"c\": 2\n  }\n}\n\"\"\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529658214,"submitTime":1501529658204,"finishTime":1501529658387,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ef4c0b8d-9c8b-4c17-a7ab-70a8ea8d27d0"},{"version":"CommandV1","origId":3117922773650529,"guid":"73bf0f36-1ef2-408a-9140-27fea239c097","subtype":"command","commandType":"auto","position":42.0,"command":"%sql\nselect a.* from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"\"long\"","metadata":"{}"},{"name":"c","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529669567,"submitTime":1501529669556,"finishTime":1501529669784,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"33a09850-9dca-4b5c-a6fa-6b0e37b3ce27"},{"version":"CommandV1","origId":3117922773650530,"guid":"9f67db81-748f-4e55-9cb8-701133be5694","subtype":"command","commandType":"auto","position":43.0,"command":"jsonToDataFrame(\"\"\"\n{\n  \"a\": 1,\n  \"b\": 2,\n  \"c\": 3\n}\n\"\"\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529675022,"submitTime":1501529675011,"finishTime":1501529675194,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ade52bf9-f60e-4f52-b088-af645d8bce7d"},{"version":"CommandV1","origId":3117922773650531,"guid":"2e4ff4dd-2dfa-47cb-b693-9d2257bb0a04","subtype":"command","commandType":"auto","position":44.0,"command":"%sql\nselect named_struct(\"y\", a) as x from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"y\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:50: error: not found: value select\n              select named_struct(&quot;y&quot;, a) as x from events\n              ^\n</div>","error":null,"workflows":[],"startTime":1501529687558,"submitTime":1501529687546,"finishTime":1501529687801,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dd725ab7-9928-4819-9f02-b42abd81eae1"},{"version":"CommandV1","origId":3117922773650532,"guid":"71cc9aea-d3e7-4d5f-ba9e-5262d8267a45","subtype":"command","commandType":"auto","position":45.0,"command":"jsonToDataFrame(\"\"\"\n{\n  \"a\": 1,\n  \"b\": 2\n}\n\"\"\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529694488,"submitTime":1501529694475,"finishTime":1501529694662,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0b8e6cdc-a962-4606-8dde-77666611ee41"},{"version":"CommandV1","origId":3117922773650533,"guid":"78209b13-eb67-4e7c-9d09-54f0ea45c6b2","subtype":"command","commandType":"auto","position":46.0,"command":"%sql\nselect struct(*) as x from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1,2]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"a\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"b\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529701174,"submitTime":1501529701162,"finishTime":1501529701397,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"51cb98d8-b68b-4869-a3fa-f48dd9fbf447"},{"version":"CommandV1","origId":3117922773650534,"guid":"540d8823-c9fa-47a4-af99-668db7201596","subtype":"command","commandType":"auto","position":47.0,"command":"jsonToDataFrame(\"\"\"\n{\n  \"a\": [1, 2]\n}\n\"\"\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529707469,"submitTime":1501529707457,"finishTime":1501529707591,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b1b366dd-0af4-4982-ae9a-590b2310e17c"},{"version":"CommandV1","origId":3117922773650535,"guid":"54398839-1aad-49f8-bf13-1f63569b722a","subtype":"command","commandType":"auto","position":48.0,"command":"%sql\nselect a[0] as x from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529714456,"submitTime":1501529714444,"finishTime":1501529714647,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3d91159b-18ea-4e96-acba-b76b99be1051"},{"version":"CommandV1","origId":3117922773650536,"guid":"11bfea22-2ed4-42e1-8e6c-7b34c4037730","subtype":"command","commandType":"auto","position":49.0,"command":"# Using a map\nschema = StructType().add(\"a\", MapType(StringType(), IntegerType()))\n\njsonToDataFrame(\"\"\"\n{\n  \"a\": {\n    \"b\": 1\n  }\n}\n\"\"\", schema)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529720734,"submitTime":1501529720721,"finishTime":1501529720805,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e1fa8c10-bf43-4779-922d-c2b8da3771e8"},{"version":"CommandV1","origId":3117922773650537,"guid":"37eb27e8-2b9f-4b0d-b53d-7730b8d11c31","subtype":"command","commandType":"auto","position":50.0,"command":"%sql\nselect a['b'] as x from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529727558,"submitTime":1501529727545,"finishTime":1501529727744,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a417d94-d244-48d5-b932-bf44ae6808ff"},{"version":"CommandV1","origId":3117922773650538,"guid":"b2386778-fc59-4467-a90c-6036fcc2bcfa","subtype":"command","commandType":"auto","position":51.0,"command":"jsonToDataFrame(\"\"\"\n{\n  \"a\": [1, 2]\n}\n\"\"\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529732846,"submitTime":1501529732833,"finishTime":1501529733020,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2091ee71-d2c7-4542-bc60-7397f7be26e2"},{"version":"CommandV1","origId":3117922773650539,"guid":"16b257fb-68f8-4dd5-9279-cc8e5234991b","subtype":"command","commandType":"auto","position":52.0,"command":"%sql\nselect explode(a) as x from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1],[2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529739212,"submitTime":1501529739199,"finishTime":1501529739403,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"04988b1e-7af1-47cd-bf89-ec6ef1c9664a"},{"version":"CommandV1","origId":3117922773650540,"guid":"acf925dc-dffc-4342-b3dc-ffa584ebd391","subtype":"command","commandType":"auto","position":53.0,"command":"schema = StructType().add(\"a\", MapType(StringType(), IntegerType()))\n\njsonToDataFrame(\"\"\"\n{\n  \"a\": {\n    \"b\": 1,\n    \"c\": 2\n  }\n}\n\"\"\", schema)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529744216,"submitTime":1501529744202,"finishTime":1501529744338,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ef42356f-b5e9-4805-b2e7-8b34faea40a7"},{"version":"CommandV1","origId":3117922773650541,"guid":"d80bc204-3177-4d69-beee-59290fde29ac","subtype":"command","commandType":"auto","position":54.0,"command":"%sql\nselect explode(a) as (x, y) from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[["b",1],["c",2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"\"string\"","metadata":"{}"},{"name":"y","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529751221,"submitTime":1501529751208,"finishTime":1501529751412,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"933d33cd-af8d-40c7-bc68-a9ee8ab4118f"},{"version":"CommandV1","origId":3117922773650542,"guid":"10bdce91-e8bf-4dd6-95d3-9e2777085fb7","subtype":"command","commandType":"auto","position":55.0,"command":"jsonToDataFrame(\"\"\"\n[{ \"x\": 1 }, { \"x\": 2 }]\n\"\"\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529756643,"submitTime":1501529756629,"finishTime":1501529756766,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c196ab63-c7a5-4572-85c2-1e1d07d5cfce"},{"version":"CommandV1","origId":3117922773650543,"guid":"f7e14926-b70d-465e-a6c7-a5b9e592effd","subtype":"command","commandType":"auto","position":56.0,"command":"%sql\nselect collect_list(x) as x from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1,2]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"x","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529762606,"submitTime":1501529762593,"finishTime":1501529762727,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ce83ff2f-36b6-4ca0-9d51-2eb150e5b93d"},{"version":"CommandV1","origId":3117922773650544,"guid":"25ceeb81-ade4-4fdf-ae63-cea9affa0185","subtype":"command","commandType":"auto","position":57.0,"command":"jsonToDataFrame(\"\"\"\n[{ \"x\": 1, \"y\": \"a\" }, { \"x\": 2, \"y\": \"b\" }]\n\"\"\")\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529768469,"submitTime":1501529768455,"finishTime":1501529768643,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"43674dc7-c60f-4c65-919c-c313791b1969"},{"version":"CommandV1","origId":3117922773650545,"guid":"9cc2d1e9-7bb5-4df1-933e-9a3045989e64","subtype":"command","commandType":"auto","position":58.0,"command":"%sql\nselect y, collect_list(x) as x from events group by y","commandVersion":0,"state":"finished","results":{"type":"table","data":[["b",[2]],["a",[1]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"y","type":"\"string\"","metadata":"{}"},{"name":"x","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529779430,"submitTime":1501529779416,"finishTime":1501529780002,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8462a8af-5dc2-4955-a114-d6697d22bbe8"},{"version":"CommandV1","origId":3117922773650546,"guid":"df9171ac-0e34-4183-93eb-c5920ae7dd06","subtype":"command","commandType":"auto","position":59.0,"command":"jsonToDataFrame(\"\"\"\n{\n  \"a\": [\n    {\"b\": 1},\n    {\"b\": 2}\n  ]\n}\n\"\"\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529784586,"submitTime":1501529784572,"finishTime":1501529784708,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fed5fb02-642d-4356-b106-77a974b9ad15"},{"version":"CommandV1","origId":3117922773650547,"guid":"977956d9-202f-43b0-89c4-0b788338649e","subtype":"command","commandType":"auto","position":60.0,"command":"%sql\nselect a.b from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[1,2]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"b","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529796316,"submitTime":1501529796300,"finishTime":1501529796564,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d2f74910-db1f-4cca-8375-141603fcc8ac"},{"version":"CommandV1","origId":3117922773650548,"guid":"42dff3f9-e838-469f-b726-a92b11d1d91d","subtype":"command","commandType":"auto","position":61.0,"command":"jsonToDataFrame(\"\"\"\n{\n  \"a\": \"{\\\\\"b\\\\\":1}\"\n}\n\"\"\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529804800,"submitTime":1501529804783,"finishTime":1501529804923,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0a23e30d-fb1e-4fe7-88f9-86d60b7bec63"},{"version":"CommandV1","origId":3117922773650549,"guid":"d1e138fb-8cb6-4d58-b018-70d9c4730163","subtype":"command","commandType":"auto","position":62.0,"command":"%sql\nselect json_tuple(a, \"b\") as c from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529813849,"submitTime":1501529813830,"finishTime":1501529814039,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9e4f9f97-4a36-435f-beb9-64b3a815b333"},{"version":"CommandV1","origId":3117922773650550,"guid":"4b8b5a32-84da-4680-bfed-2baabb0767fe","subtype":"command","commandType":"auto","position":63.0,"command":"jsonToDataFrame(\"\"\"\n[{ \"a\": \"x: 1\" }, { \"a\": \"y: 2\" }]\n\"\"\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529821922,"submitTime":1501529821906,"finishTime":1501529822045,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eb7866a3-58e0-4752-9a53-9e103fa0c61a"},{"version":"CommandV1","origId":3117922773650551,"guid":"74b67ccc-26a3-45d6-b209-17a72106ed8c","subtype":"command","commandType":"auto","position":64.0,"command":"%sql\nselect regexp_extract(a, \"([a-z]):\", 1) as c from events","commandVersion":0,"state":"finished","results":{"type":"table","data":[["x"],["y"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529829860,"submitTime":1501529829845,"finishTime":1501529830052,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3ec556a7-7d76-4ea8-820a-2c2e2b59886b"},{"version":"CommandV1","origId":3117922773650552,"guid":"253c72b4-ea1c-4799-bdc8-b5c3a815bb9d","subtype":"command","commandType":"auto","position":65.0,"command":"%sql\nCREATE OR REPLACE TEMPORARY VIEW nested_data AS\nSELECT   id AS key,\n         ARRAY(CAST(RAND(1) * 100 AS INT), CAST(RAND(2) * 100 AS INT), CAST(RAND(3) * 100 AS INT), CAST(RAND(4) * 100 AS INT), CAST(RAND(5) * 100 AS INT)) AS values\n         ,\n         ARRAY(ARRAY(CAST(RAND(1) * 100 AS INT), CAST(RAND(2) * 100 AS INT)), ARRAY(CAST(RAND(3) * 100 AS INT), CAST(RAND(4) * 100 AS INT), CAST(RAND(5) * 100 AS INT))) AS nested_values\nFROM range(5)","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-37-d860c4a18f2b&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    CREATE OR REPLACE TEMPORARY VIEW nested_data AS</span>\n<span class=\"ansigrey\">            ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1501529893756,"submitTime":1501529893739,"finishTime":1501529893959,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e4ef9589-0c57-4533-b951-4fd7bdd3bad5"},{"version":"CommandV1","origId":3117922773650553,"guid":"501ac50c-138b-4fc3-9996-1fb2b2abfe87","subtype":"command","commandType":"auto","position":66.0,"command":"%sql SELECT * FROM nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,[26,11,66,8,47],[[26,11],[66,8,47]]],[1,[66,8,47,91,6],[[66,8],[47,91,6]]],[2,[8,47,91,6,70],[[8,47],[91,6,70]]],[3,[91,6,70,41,19],[[91,6],[70,41,19]]],[4,[6,70,41,19,12],[[6,70],[41,19,12]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"long\"","metadata":"{}"},{"name":"values","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"nested_values","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true},\"containsNull\":false}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529900234,"submitTime":1501529900217,"finishTime":1501529900452,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6f69b250-d4e0-47f3-9a0b-78fb8dea4fa3"},{"version":"CommandV1","origId":3117922773650554,"guid":"014f05ef-b89c-4890-9d1e-6082b372dc2f","subtype":"command","commandType":"auto","position":67.0,"command":"%sql\nSELECT  key,\n        values,\n        TRANSFORM(values, value -> value + 1) AS values_plus_one\nFROM    nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,[26,11,66,8,47],[27,12,67,9,48]],[1,[66,8,47,91,6],[67,9,48,92,7]],[2,[8,47,91,6,70],[9,48,92,7,71]],[3,[91,6,70,41,19],[92,7,71,42,20]],[4,[6,70,41,19,12],[7,71,42,20,13]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"long\"","metadata":"{}"},{"name":"values","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"values_plus_one","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529913423,"submitTime":1501529913405,"finishTime":1501529913613,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e534f200-3d81-4d5f-9df8-6de21c8134ea"},{"version":"CommandV1","origId":3117922773650555,"guid":"60823f29-96ef-45dd-ace8-ade5fa042586","subtype":"command","commandType":"auto","position":68.0,"command":"%sql\nSELECT  key,\n        values,\n        TRANSFORM(values, value -> value + key) AS values_plus_key\nFROM    nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,[26,11,66,8,47],[26,11,66,8,47]],[1,[66,8,47,91,6],[67,9,48,92,7]],[2,[8,47,91,6,70],[10,49,93,8,72]],[3,[91,6,70,41,19],[94,9,73,44,22]],[4,[6,70,41,19,12],[10,74,45,23,16]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"long\"","metadata":"{}"},{"name":"values","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"values_plus_key","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529926556,"submitTime":1501529926549,"finishTime":1501529926687,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"31507e84-8bd4-41ef-b9c9-3d27cfd7dfdb"},{"version":"CommandV1","origId":3117922773650556,"guid":"65864031-aea5-455c-bf39-32192cfd3493","subtype":"command","commandType":"auto","position":69.0,"command":"%sql\nSELECT   key,\n         nested_values,\n         TRANSFORM(nested_values,\n           values -> TRANSFORM(values,\n             value -> value + key + SIZE(values))) AS new_nested_values\nFROM     nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,[[26,11],[66,8,47]],[[28,13],[69,11,50]]],[1,[[66,8],[47,91,6]],[[69,11],[51,95,10]]],[2,[[8,47],[91,6,70]],[[12,51],[96,11,75]]],[3,[[91,6],[70,41,19]],[[96,11],[76,47,25]]],[4,[[6,70],[41,19,12]],[[12,76],[48,26,19]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"long\"","metadata":"{}"},{"name":"nested_values","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true},\"containsNull\":false}","metadata":"{}"},{"name":"new_nested_values","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true},\"containsNull\":false}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529950641,"submitTime":1501529950623,"finishTime":1501529950830,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b6f52261-4248-4585-83c5-b5c0b34c08be"},{"version":"CommandV1","origId":3117922773650557,"guid":"676f0dde-01ee-4b26-bfdc-88d7e7884734","subtype":"command","commandType":"auto","position":70.0,"command":"%sql\nSELECT   key,\n         values,\n         TRANSFORM(values, value -> value + key) transformed_values\nFROM     nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,[26,11,66,8,47],[26,11,66,8,47]],[1,[66,8,47,91,6],[67,9,48,92,7]],[2,[8,47,91,6,70],[10,49,93,8,72]],[3,[91,6,70,41,19],[94,9,73,44,22]],[4,[6,70,41,19,12],[10,74,45,23,16]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"long\"","metadata":"{}"},{"name":"values","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"transformed_values","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529959722,"submitTime":1501529959703,"finishTime":1501529959856,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cde934a6-e5be-409b-a355-1e35296ea178"},{"version":"CommandV1","origId":3117922773650558,"guid":"e892d20e-ba3c-44ca-b056-9044762881ab","subtype":"command","commandType":"auto","position":71.0,"command":"%sql\nSELECT   key,\n         values,\n         EXISTS(values, value -> value % 10 == 1) filtered_values\nFROM     nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,[26,11,66,8,47],true],[1,[66,8,47,91,6],true],[2,[8,47,91,6,70],true],[3,[91,6,70,41,19],true],[4,[6,70,41,19,12],true]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"long\"","metadata":"{}"},{"name":"values","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"filtered_values","type":"\"boolean\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529969064,"submitTime":1501529969045,"finishTime":1501529969193,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"14444266-5398-4b18-a9b9-03c906e4765e"},{"version":"CommandV1","origId":3117922773650559,"guid":"ec4b165c-c644-4d21-96ca-4953b85a2d74","subtype":"command","commandType":"auto","position":72.0,"command":"%sql\nSELECT   key,\n         values,\n         FILTER(values, value -> value > 50) filtered_values\nFROM     nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,[26,11,66,8,47],[66]],[1,[66,8,47,91,6],[66,91]],[2,[8,47,91,6,70],[91,70]],[3,[91,6,70,41,19],[91,70]],[4,[6,70,41,19,12],[70]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"long\"","metadata":"{}"},{"name":"values","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"filtered_values","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529977181,"submitTime":1501529977162,"finishTime":1501529977316,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1c717217-3908-4290-833c-b47e025c1c19"},{"version":"CommandV1","origId":3117922773650560,"guid":"2c47fb21-86c5-4424-8981-4821df3a1c28","subtype":"command","commandType":"auto","position":73.0,"command":"%sql\nSELECT   key,\n         values,\n         REDUCE(values, 0, (value, acc) -> value + acc, acc -> acc) summed_values,\n         REDUCE(values, 0, (value, acc) -> value + acc) summed_values_simple\nFROM     nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,[26,11,66,8,47],158,158],[1,[66,8,47,91,6],218,218],[2,[8,47,91,6,70],222,222],[3,[91,6,70,41,19],227,227],[4,[6,70,41,19,12],148,148]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"long\"","metadata":"{}"},{"name":"values","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"summed_values","type":"\"integer\"","metadata":"{}"},{"name":"summed_values_simple","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529984726,"submitTime":1501529984706,"finishTime":1501529984918,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"90afd0a2-c4dd-4e32-bf0f-6c87e37cf6aa"},{"version":"CommandV1","origId":3117922773650561,"guid":"5ae9d9f5-30a1-4454-8cbd-adbf9dc96bd2","subtype":"command","commandType":"auto","position":74.0,"command":"%sql\nSELECT   key,\n         values,\n         AGGREGATE(values,\n           (1.0 AS product, 0 AS N),\n           (buffer, value) -> (value * buffer.product, buffer.N + 1),\n           buffer -> Power(buffer.product, 1.0 / buffer.N)) geomean\nFROM     nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,[26,11,66,8,47],23.454142676002885],[1,[66,8,47,91,6],26.692231612583978],[2,[8,47,91,6,70],27.008204014429833],[3,[91,6,70,41,19],31.243927982192833],[4,[6,70,41,19,12],20.835004511045007]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"long\"","metadata":"{}"},{"name":"values","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"geomean","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501529991785,"submitTime":1501529991765,"finishTime":1501529992028,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"de7da466-fbad-4bf9-8804-8aa189556eb3"},{"version":"CommandV1","origId":3117922773650562,"guid":"d4ed48d2-faa8-463b-828d-ded87f2b8f63","subtype":"command","commandType":"auto","position":75.0,"command":"from pyspark.sql.functions import *\nfrom pyspark.sql.types import *\n\nschema = StructType() \\\n          .add(\"dc_id\", StringType()) \\\n          .add(\"source\", MapType(StringType(), StructType() \\\n                        .add(\"description\", StringType()) \\\n                        .add(\"ip\", StringType()) \\\n                        .add(\"id\", IntegerType()) \\\n                        .add(\"temp\", ArrayType(IntegerType())) \\\n                        .add(\"c02_level\", ArrayType(IntegerType())) \\\n                        .add(\"geo\", StructType() \\\n                              .add(\"lat\", DoubleType()) \\\n                              .add(\"long\", DoubleType()))))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530001961,"submitTime":1501530001940,"finishTime":1501530002011,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a9876538-08ea-413e-a42f-e6687d7bb3ec"},{"version":"CommandV1","origId":3117922773650563,"guid":"fb417dd8-5bb5-4fd0-8e00-627f46d5a0a6","subtype":"command","commandType":"auto","position":76.0,"command":"def jsonToDataFrame(json, schema=None):\n  # SparkSessions are available with Spark 2.0+\n  reader = spark.read\n  if schema:\n    reader.schema(schema)\n  return reader.json(sc.parallelize([json]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530012702,"submitTime":1501530012681,"finishTime":1501530012743,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a486e844-0f2c-4999-bcf1-2bda1693be23"},{"version":"CommandV1","origId":3117922773650564,"guid":"d2a5480b-2b69-4c7c-a168-8a8cf2c3580b","subtype":"command","commandType":"auto","position":77.0,"command":"dataDF = jsonToDataFrame( \"\"\"{\n\n    \"dc_id\": \"dc-101\",\n    \"source\": {\n        \"sensor-igauge\": {\n        \"id\": 10,\n        \"ip\": \"68.28.91.22\",\n        \"description\": \"Sensor attached to the container ceilings\",\n        \"temp\":[35,35,35,36,35,35,32,35,30,35,32,35],\n        \"c02_level\": [1475,1476,1473],\n        \"geo\": {\"lat\":38.00, \"long\":97.00}                        \n      },\n      \"sensor-ipad\": {\n        \"id\": 13,\n        \"ip\": \"67.185.72.1\",\n        \"description\": \"Sensor ipad attached to carbon cylinders\",\n        \"temp\": [45,45,45,46,45,45,42,35,40,45,42,45],\n        \"c02_level\": [1370,1371,1372],\n        \"geo\": {\"lat\":47.41, \"long\":-122.00}\n      },\n      \"sensor-inest\": {\n        \"id\": 8,\n        \"ip\": \"208.109.163.218\",\n        \"description\": \"Sensor attached to the factory ceilings\",\n        \"temp\": [40,40,40,40,40,43,42,40,40,45,42,45],\n        \"c02_level\": [1346,1345, 1343],\n        \"geo\": {\"lat\":33.61, \"long\":-111.89}\n      },\n      \"sensor-istick\": {\n        \"id\": 5,\n        \"ip\": \"204.116.105.67\",\n        \"description\": \"Sensor embedded in exhaust pipes in the ceilings\",\n        \"temp\":[30,30,30,30,40,43,42,40,40,35,42,35],\n        \"c02_level\": [1574,1570, 1576],\n        \"geo\": {\"lat\":35.93, \"long\":-85.46}\n      }\n    }\n  }\"\"\", schema)\n\ndisplay(dataDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101",{"sensor-igauge":{"schema":[{"nullable":true,"name":"description","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"ip","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"temp","comment":null,"metadata":{"map":{}},"dataType":{"elementType":{},"containsNull":true}},{"nullable":true,"name":"c02_level","comment":null,"metadata":{"map":{}},"dataType":{"elementType":{},"containsNull":true}},{"nullable":true,"name":"geo","comment":null,"metadata":{"map":{}},"dataType":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}]}],"values":["Sensor attached to the container ceilings","68.28.91.22",10,[35,35,35,36,35,35,32,35,30,35,32,35],[1475,1476,1473],{"schema":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":[38.0,97.0]}]},"sensor-ipad":{"schema":[{"nullable":true,"name":"description","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"ip","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"temp","comment":null,"metadata":{"map":{}},"dataType":{"elementType":{},"containsNull":true}},{"nullable":true,"name":"c02_level","comment":null,"metadata":{"map":{}},"dataType":{"elementType":{},"containsNull":true}},{"nullable":true,"name":"geo","comment":null,"metadata":{"map":{}},"dataType":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}]}],"values":["Sensor ipad attached to carbon cylinders","67.185.72.1",13,[45,45,45,46,45,45,42,35,40,45,42,45],[1370,1371,1372],{"schema":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":[47.41,-122.0]}]},"sensor-inest":{"schema":[{"nullable":true,"name":"description","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"ip","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"temp","comment":null,"metadata":{"map":{}},"dataType":{"elementType":{},"containsNull":true}},{"nullable":true,"name":"c02_level","comment":null,"metadata":{"map":{}},"dataType":{"elementType":{},"containsNull":true}},{"nullable":true,"name":"geo","comment":null,"metadata":{"map":{}},"dataType":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}]}],"values":["Sensor attached to the factory ceilings","208.109.163.218",8,[40,40,40,40,40,43,42,40,40,45,42,45],[1346,1345,1343],{"schema":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":[33.61,-111.89]}]},"sensor-istick":{"schema":[{"nullable":true,"name":"description","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"ip","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"temp","comment":null,"metadata":{"map":{}},"dataType":{"elementType":{},"containsNull":true}},{"nullable":true,"name":"c02_level","comment":null,"metadata":{"map":{}},"dataType":{"elementType":{},"containsNull":true}},{"nullable":true,"name":"geo","comment":null,"metadata":{"map":{}},"dataType":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}]}],"values":["Sensor embedded in exhaust pipes in the ceilings","204.116.105.67",5,[30,30,30,30,40,43,42,40,40,35,42,35],[1574,1570,1576],{"schema":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":[35.93,-85.46]}]}}]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"source","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"description\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"ip\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"id\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"temp\",\"type\":{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true},\"nullable\":true,\"metadata\":{}},{\"name\":\"c02_level\",\"type\":{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true},\"nullable\":true,\"metadata\":{}},{\"name\":\"geo\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"lat\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"long\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}}]},\"valueContainsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530022768,"submitTime":1501530022747,"finishTime":1501530023144,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"438d3ad4-1cff-4171-a446-1a6f7b8a4834"},{"version":"CommandV1","origId":3117922773650565,"guid":"f136c544-8971-4882-b489-4f55179ea924","subtype":"command","commandType":"auto","position":78.0,"command":"dataDF.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- dc_id: string (nullable = true)\n |-- source: map (nullable = true)\n |    |-- key: string\n |    |-- value: struct (valueContainsNull = true)\n |    |    |-- description: string (nullable = true)\n |    |    |-- ip: string (nullable = true)\n |    |    |-- id: integer (nullable = true)\n |    |    |-- temp: array (nullable = true)\n |    |    |    |-- element: integer (containsNull = true)\n |    |    |-- c02_level: array (nullable = true)\n |    |    |    |-- element: integer (containsNull = true)\n |    |    |-- geo: struct (nullable = true)\n |    |    |    |-- lat: double (nullable = true)\n |    |    |    |-- long: double (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530038705,"submitTime":1501530038684,"finishTime":1501530038776,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d0ab1bfc-ce24-4564-a45b-63d4e5443c24"},{"version":"CommandV1","origId":3117922773650566,"guid":"d3cb2912-6520-4db6-bd7b-8c8aed69375c","subtype":"command","commandType":"auto","position":79.0,"command":"explodedDF = dataDF.select(\"dc_id\", explode(\"source\"))\ndisplay(explodedDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101","sensor-igauge",["Sensor attached to the container ceilings","68.28.91.22",10,[35,35,35,36,35,35,32,35,30,35,32,35],[1475,1476,1473],[38.0,97.0]]],["dc-101","sensor-ipad",["Sensor ipad attached to carbon cylinders","67.185.72.1",13,[45,45,45,46,45,45,42,35,40,45,42,45],[1370,1371,1372],[47.41,-122.0]]],["dc-101","sensor-inest",["Sensor attached to the factory ceilings","208.109.163.218",8,[40,40,40,40,40,43,42,40,40,45,42,45],[1346,1345,1343],[33.61,-111.89]]],["dc-101","sensor-istick",["Sensor embedded in exhaust pipes in the ceilings","204.116.105.67",5,[30,30,30,30,40,43,42,40,40,35,42,35],[1574,1570,1576],[35.93,-85.46]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"value","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"description\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"ip\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"id\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"temp\",\"type\":{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true},\"nullable\":true,\"metadata\":{}},{\"name\":\"c02_level\",\"type\":{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true},\"nullable\":true,\"metadata\":{}},{\"name\":\"geo\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"lat\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"long\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530046357,"submitTime":1501530046336,"finishTime":1501530046681,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e22f2ce2-1c67-442a-a9e8-bbf908441980"},{"version":"CommandV1","origId":3117922773650567,"guid":"a1f89aef-3e0d-4607-8bbf-397fbdf9137d","subtype":"command","commandType":"auto","position":80.0,"command":"devicesDataDF = explodedDF.select(\"dc_id\", \"key\", \\\n                        \"value.ip\", \\\n                        col(\"value.id\").alias(\"device_id\"), \\\n                        col(\"value.c02_level\").alias(\"c02_levels\"), \\\n                        \"value.temp\")\ndisplay(devicesDataDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101","sensor-igauge","68.28.91.22",10,[1475,1476,1473],[35,35,35,36,35,35,32,35,30,35,32,35]],["dc-101","sensor-ipad","67.185.72.1",13,[1370,1371,1372],[45,45,45,46,45,45,42,35,40,45,42,45]],["dc-101","sensor-inest","208.109.163.218",8,[1346,1345,1343],[40,40,40,40,40,43,42,40,40,45,42,45]],["dc-101","sensor-istick","204.116.105.67",5,[1574,1570,1576],[30,30,30,30,40,43,42,40,40,35,42,35]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530057233,"submitTime":1501530057211,"finishTime":1501530057560,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2e09b99c-b317-48b7-b97d-82c0ab91c541"},{"version":"CommandV1","origId":3117922773650568,"guid":"a00af154-6245-4fab-a63a-827372a11f54","subtype":"command","commandType":"auto","position":81.0,"command":"devicesDataDF.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- dc_id: string (nullable = true)\n |-- key: string (nullable = false)\n |-- ip: string (nullable = true)\n |-- device_id: integer (nullable = true)\n |-- c02_levels: array (nullable = true)\n |    |-- element: integer (containsNull = true)\n |-- temp: array (nullable = true)\n |    |-- element: integer (containsNull = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530068966,"submitTime":1501530068945,"finishTime":1501530069039,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"271efc44-b115-462d-af83-42a3ed624bcf"},{"version":"CommandV1","origId":3117922773650569,"guid":"09a0dc7b-4d4b-437f-97da-a830e6a8fa23","subtype":"command","commandType":"auto","position":82.0,"command":"devicesDataDF.createOrReplaceTempView(\"data_center_iot_devices\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530075251,"submitTime":1501530075229,"finishTime":1501530075323,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"68056a26-f859-4105-86cb-f1539769e2af"},{"version":"CommandV1","origId":3117922773650570,"guid":"6a48b1f7-d473-4255-8761-c29320222025","subtype":"command","commandType":"auto","position":83.0,"command":"%sql select * from data_center_iot_devices","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101","sensor-igauge","68.28.91.22",10,[1475,1476,1473],[35,35,35,36,35,35,32,35,30,35,32,35]],["dc-101","sensor-ipad","67.185.72.1",13,[1370,1371,1372],[45,45,45,46,45,45,42,35,40,45,42,45]],["dc-101","sensor-inest","208.109.163.218",8,[1346,1345,1343],[40,40,40,40,40,43,42,40,40,45,42,45]],["dc-101","sensor-istick","204.116.105.67",5,[1574,1570,1576],[30,30,30,30,40,43,42,40,40,35,42,35]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530081860,"submitTime":1501530081838,"finishTime":1501530082085,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f638daae-05b5-4dbd-838f-abfeea52867e"},{"version":"CommandV1","origId":3117922773650571,"guid":"b18e3927-057d-4772-aa65-c214d76a8062","subtype":"command","commandType":"auto","position":84.0,"command":"%sql describe data_center_iot_devices","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc_id","string",null],["key","string",null],["ip","string",null],["device_id","int",null],["c02_levels","array<int>",null],["temp","array<int>",null]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_name","type":"\"string\"","metadata":"{\"comment\":\"name of the column\"}"},{"name":"data_type","type":"\"string\"","metadata":"{\"comment\":\"data type of the column\"}"},{"name":"comment","type":"\"string\"","metadata":"{\"comment\":\"comment of the column\"}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530088028,"submitTime":1501530088006,"finishTime":1501530088066,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"004de24f-e9aa-4760-b8dd-60e3a01ce359"},{"version":"CommandV1","origId":3117922773650572,"guid":"c74d0771-adf4-4075-9f98-4d4ed976a76e","subtype":"command","commandType":"auto","position":85.0,"command":"%sql select key, ip, device_id, temp,\n     transform (temp, t -> ((t * 9) div 5) + 32 ) as fahrenheit_temp\n     from data_center_iot_devices","commandVersion":0,"state":"finished","results":{"type":"table","data":[["sensor-igauge","68.28.91.22",10,[35,35,35,36,35,35,32,35,30,35,32,35],[95,95,95,96,95,95,89,95,86,95,89,95]],["sensor-ipad","67.185.72.1",13,[45,45,45,46,45,45,42,35,40,45,42,45],[113,113,113,114,113,113,107,95,104,113,107,113]],["sensor-inest","208.109.163.218",8,[40,40,40,40,40,43,42,40,40,45,42,45],[104,104,104,104,104,109,107,104,104,113,107,113]],["sensor-istick","204.116.105.67",5,[30,30,30,30,40,43,42,40,40,35,42,35],[86,86,86,86,104,109,107,104,104,95,107,95]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"fahrenheit_temp","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530101435,"submitTime":1501530101412,"finishTime":1501530101708,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ab6ac8f3-458c-4850-84f3-80e013f0461c"},{"version":"CommandV1","origId":3117922773650573,"guid":"f1675cff-71e0-4a90-9935-cf6316580215","subtype":"command","commandType":"auto","position":86.0,"command":"%sql select dc_id, key, ip, device_id, c02_levels, temp, \n     transform (c02_levels, t -> t > 1300) as high_c02_levels\n     from data_center_iot_devices","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101","sensor-igauge","68.28.91.22",10,[1475,1476,1473],[35,35,35,36,35,35,32,35,30,35,32,35],[true,true,true]],["dc-101","sensor-ipad","67.185.72.1",13,[1370,1371,1372],[45,45,45,46,45,45,42,35,40,45,42,45],[true,true,true]],["dc-101","sensor-inest","208.109.163.218",8,[1346,1345,1343],[40,40,40,40,40,43,42,40,40,45,42,45],[true,true,true]],["dc-101","sensor-istick","204.116.105.67",5,[1574,1570,1576],[30,30,30,30,40,43,42,40,40,35,42,35],[true,true,true]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"high_c02_levels","type":"{\"type\":\"array\",\"elementType\":\"boolean\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530134360,"submitTime":1501530134336,"finishTime":1501530134628,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7514bb33-7870-4f00-bd5f-00f65afc696b"},{"version":"CommandV1","origId":3117922773650574,"guid":"5be59ddc-5493-4d98-8ae1-13c83ca00fff","subtype":"command","commandType":"auto","position":87.0,"command":"%sql select dc_id, key, ip, device_id, c02_levels, temp, \n     filter (c02_levels, t -> t > 1300) as high_c02_levels\n     from data_center_iot_devices","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101","sensor-igauge","68.28.91.22",10,[1475,1476,1473],[35,35,35,36,35,35,32,35,30,35,32,35],[1475,1476,1473]],["dc-101","sensor-ipad","67.185.72.1",13,[1370,1371,1372],[45,45,45,46,45,45,42,35,40,45,42,45],[1370,1371,1372]],["dc-101","sensor-inest","208.109.163.218",8,[1346,1345,1343],[40,40,40,40,40,43,42,40,40,45,42,45],[1346,1345,1343]],["dc-101","sensor-istick","204.116.105.67",5,[1574,1570,1576],[30,30,30,30,40,43,42,40,40,35,42,35],[1574,1570,1576]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"high_c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530158115,"submitTime":1501530158091,"finishTime":1501530158383,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"53657a5d-6279-4e02-ad31-c7d6c3078f93"},{"version":"CommandV1","origId":3117922773650575,"guid":"8d6bbbab-4965-46a9-a685-e861a4edeafa","subtype":"command","commandType":"auto","position":88.0,"command":"%sql select dc_id, key, ip, device_id, c02_levels, temp, \n     filter (c02_levels, t -> t < 1300 ) as high_c02_levels\n     from data_center_iot_devices","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101","sensor-igauge","68.28.91.22",10,[1475,1476,1473],[35,35,35,36,35,35,32,35,30,35,32,35],[]],["dc-101","sensor-ipad","67.185.72.1",13,[1370,1371,1372],[45,45,45,46,45,45,42,35,40,45,42,45],[]],["dc-101","sensor-inest","208.109.163.218",8,[1346,1345,1343],[40,40,40,40,40,43,42,40,40,45,42,45],[]],["dc-101","sensor-istick","204.116.105.67",5,[1574,1570,1576],[30,30,30,30,40,43,42,40,40,35,42,35],[]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"high_c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530164146,"submitTime":1501530164122,"finishTime":1501530164389,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"90e3a56e-c4f5-4f1e-bac8-19298184e034"},{"version":"CommandV1","origId":3117922773650576,"guid":"c6457311-7ad2-48b2-8736-a60cdd4fc2ec","subtype":"command","commandType":"auto","position":89.0,"command":"%sql select dc_id, key, ip, device_id, c02_levels, temp, \n     exists (temp, t -> t = 45 ) as value_exists\n     from data_center_iot_devices","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101","sensor-igauge","68.28.91.22",10,[1475,1476,1473],[35,35,35,36,35,35,32,35,30,35,32,35],false],["dc-101","sensor-ipad","67.185.72.1",13,[1370,1371,1372],[45,45,45,46,45,45,42,35,40,45,42,45],true],["dc-101","sensor-inest","208.109.163.218",8,[1346,1345,1343],[40,40,40,40,40,43,42,40,40,45,42,45],true],["dc-101","sensor-istick","204.116.105.67",5,[1574,1570,1576],[30,30,30,30,40,43,42,40,40,35,42,35],false]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"value_exists","type":"\"boolean\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530170792,"submitTime":1501530170768,"finishTime":1501530171033,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a0b22a92-7121-43e6-9bfc-4df4dc78ad70"},{"version":"CommandV1","origId":3117922773650577,"guid":"5ef38d5e-36d3-41cc-8c73-d8377d14eac4","subtype":"command","commandType":"auto","position":90.0,"command":"%sql select dc_id, key, ip, device_id, c02_levels, temp, \n     exists (c02_levels, t -> t = 1570 ) as high_c02_levels\n     from data_center_iot_devices","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101","sensor-igauge","68.28.91.22",10,[1475,1476,1473],[35,35,35,36,35,35,32,35,30,35,32,35],false],["dc-101","sensor-ipad","67.185.72.1",13,[1370,1371,1372],[45,45,45,46,45,45,42,35,40,45,42,45],false],["dc-101","sensor-inest","208.109.163.218",8,[1346,1345,1343],[40,40,40,40,40,43,42,40,40,45,42,45],false],["dc-101","sensor-istick","204.116.105.67",5,[1574,1570,1576],[30,30,30,30,40,43,42,40,40,35,42,35],true]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"high_c02_levels","type":"\"boolean\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530176111,"submitTime":1501530176085,"finishTime":1501530176368,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"15438d7d-beb3-4c2c-8ac7-638834dafe7f"},{"version":"CommandV1","origId":3117922773650578,"guid":"6a9b65a9-ca5d-4756-a97c-187d5c97e068","subtype":"command","commandType":"auto","position":91.0,"command":"%sql select key, ip, device_id, temp,\n    reduce(temp, 0, (t, acc) -> t + acc, acc-> (acc div size(temp) * 9 div 5) + 32 ) as average_f_temp\n    from data_center_iot_devices\n    sort by average_f_temp desc","commandVersion":0,"state":"finished","results":{"type":"table","data":[["sensor-ipad","67.185.72.1",13,[45,45,45,46,45,45,42,35,40,45,42,45],109],["sensor-inest","208.109.163.218",8,[40,40,40,40,40,43,42,40,40,45,42,45],105],["sensor-istick","204.116.105.67",5,[30,30,30,30,40,43,42,40,40,35,42,35],96],["sensor-igauge","68.28.91.22",10,[35,35,35,36,35,35,32,35,30,35,32,35],93]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"average_f_temp","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530184273,"submitTime":1501530184247,"finishTime":1501530184624,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":["key"],"yColumns":["average_f_temp"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e7d3950c-8ecd-4fff-8983-125cb71118fd"},{"version":"CommandV1","origId":3117922773650579,"guid":"1c057f56-6401-40c1-a615-dbfc1ba7d964","subtype":"command","commandType":"auto","position":92.0,"command":"%sql select key, ip, device_id, c02_levels,\n    reduce(c02_levels, 0, (t, acc) -> t + acc, acc-> acc div size(c02_levels)) as average_c02_levels\n    from data_center_iot_devices\n    sort by  average_c02_levels desc\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["sensor-istick","204.116.105.67",5,[1574,1570,1576],1573],["sensor-igauge","68.28.91.22",10,[1475,1476,1473],1474],["sensor-ipad","67.185.72.1",13,[1370,1371,1372],1371],["sensor-inest","208.109.163.218",8,[1346,1345,1343],1344]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"average_c02_levels","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530194162,"submitTime":1501530194137,"finishTime":1501530194473,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":["key"],"yColumns":["average_c02_levels"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"755fb5b3-6364-4b08-b37c-05083bbdb4ac"},{"version":"CommandV1","origId":3117922773650580,"guid":"bfd24c9b-61b1-4a24-8260-3606b7531288","subtype":"command","commandType":"auto","position":93.0,"command":"%sql select key, ip, device_id, c02_levels,\n     aggregate(c02_levels,\n               (1.0 as product, 0 as N),\n               (buffer, c02) -> (c02 * buffer.product, buffer.N+1),\n               buffer -> round(Power(buffer.product, 1.0 / buffer.N))) as c02_geomean\n     from data_center_iot_devices\n     sort by c02_geomean desc","commandVersion":0,"state":"finished","results":{"type":"table","data":[["sensor-istick","204.116.105.67",5,[1574,1570,1576],1573.0],["sensor-igauge","68.28.91.22",10,[1475,1476,1473],1475.0],["sensor-ipad","67.185.72.1",13,[1370,1371,1372],1371.0],["sensor-inest","208.109.163.218",8,[1346,1345,1343],1345.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"c02_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"c02_geomean","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530202597,"submitTime":1501530202572,"finishTime":1501530202948,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":["key"],"yColumns":["c02_geomean"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"106cacb5-9394-4697-a25a-761ff15255dc"},{"version":"CommandV1","origId":3117922773650581,"guid":"ae9af797-a32d-4eb5-aa03-6bd56aff0631","subtype":"command","commandType":"auto","position":94.0,"command":"schema2 = StructType() \\\n                    .add(\"device_id\", IntegerType()) \\\n                    .add(\"battery_level\", ArrayType(IntegerType())) \\\n                    .add(\"c02_level\", ArrayType(IntegerType())) \\\n                    .add(\"signal\", ArrayType(IntegerType())) \\\n                    .add(\"temp\", ArrayType(IntegerType())) \\\n                    .add(\"cca3\", ArrayType(StringType())) \\\n                    .add(\"device_type\", StringType()) \\\n                    .add(\"ip\", StringType()) \\\n                    .add(\"timestamp\", TimestampType())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530211740,"submitTime":1501530211714,"finishTime":1501530211781,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c3fd391c-5412-4bde-b5db-b7b44a37631d"},{"version":"CommandV1","origId":3117922773650582,"guid":"f1352054-17f2-47bc-b405-f8107be1f243","subtype":"command","commandType":"auto","position":95.0,"command":"dataDF2 = jsonToDataFrame(\"\"\"[\n  {\"device_id\": 0, \"device_type\": \"sensor-ipad\", \"ip\": \"68.161.225.1\", \"cca3\": [\"USA\", \"United States\"], \"temp\": [25,26, 27], \"signal\": [23,22,24], \"battery_level\": [8,9,7], \"c02_level\": [917, 921, 925], \"timestamp\" :1475600496 }, \n  {\"device_id\": 1, \"device_type\": \"sensor-igauge\", \"ip\": \"213.161.254.1\", \"cca3\": [\"NOR\", \"Norway\"], \"temp\": [30, 32,35], \"signal\": [18,18,19], \"battery_level\": [6, 6, 5], \"c02_level\": [1413, 1416, 1417], \"timestamp\" :1475600498 }, \n  {\"device_id\": 3, \"device_type\": \"sensor-inest\", \"ip\": \"66.39.173.154\", \"cca3\": [\"USA\", \"United States\"], \"temp\":[47, 47, 48], \"signal\": [12,12,13], \"battery_level\": [1, 1, 0],  \"c02_level\": [1447,1446, 1448], \"timestamp\" :1475600502 }, \n  {\"device_id\": 4, \"device_type\": \"sensor-ipad\", \"ip\": \"203.82.41.9\", \"cca3\":[\"PHL\", \"Philippines\"], \"temp\":[29, 29, 28], \"signal\":[11, 11, 11], \"battery_level\":[0, 0, 0], \"c02_level\": [983, 990, 982], \"timestamp\" :1475600504 },\n  {\"device_id\": 5, \"device_type\": \"sensor-istick\", \"ip\": \"204.116.105.67\", \"cca3\": [\"USA\", \"United States\"], \"temp\":[50,51,50], \"signal\": [16,16,17], \"battery_level\": [8,8, 8], \"c02_level\": [1574,1575,1576], \"timestamp\" :1475600506 }, \n  {\"device_id\": 6, \"device_type\": \"sensor-ipad\", \"ip\": \"220.173.179.1\", \"cca3\": [\"CHN\", \"China\"], \"temp\": [21,21,22], \"signal\": [18,18,19], \"battery_level\": [9,9,9], \"c02_level\": [1249,1249,1250], \"timestamp\" :1475600508 },\n  {\"device_id\": 7, \"device_type\": \"sensor-ipad\", \"ip\": \"118.23.68.227\", \"cca3\": [\"JPN\", \"Japan\"], \"temp\":[27,27,28], \"signal\": [15,15,29], \"battery_level\":[0,0,0], \"c02_level\": [1531,1532,1531], \"timestamp\" :1475600512 },\n  {\"device_id\": 8, \"device_type\": \"sensor-inest\", \"ip\": \"208.109.163.218\", \"cca3\": [\"USA\", \"United States\"], \"temp\":[40,40,41], \"signal\": [16,16,17], \"battery_level\":[ 9, 9, 10], \"c02_level\": [1208,1209,1208], \"timestamp\" :1475600514},\n  {\"device_id\": 9, \"device_type\": \"sensor-ipad\", \"ip\": \"88.213.191.34\", \"cca3\": [\"ITA\", \"Italy\"], \"temp\": [19,28,5], \"signal\": [11, 5, 24], \"battery_level\": [0,-1,0], \"c02_level\": [1171, 1240, 1400], \"timestamp\" :1475600516 },\n  {\"device_id\": 10, \"device_type\": \"sensor-igauge\", \"ip\": \"68.28.91.22\", \"cca3\": [\"USA\", \"United States\"], \"temp\": [32,33,32], \"signal\": [26,26,25], \"battery_level\": [7,7,8], \"c02_level\": [886,886,887], \"timestamp\" :1475600518 },\n  {\"device_id\": 11, \"device_type\": \"sensor-ipad\", \"ip\": \"59.144.114.250\", \"cca3\": [\"IND\", \"India\"], \"temp\": [46,45,44], \"signal\": [25,25,24], \"battery_level\": [4,5,5], \"c02_level\": [863,862,864], \"timestamp\" :1475600520 },\n  {\"device_id\": 12, \"device_type\": \"sensor-igauge\", \"ip\": \"193.156.90.200\", \"cca3\": [\"NOR\", \"Norway\"], \"temp\": [18,17,18], \"signal\": [26,25,26], \"battery_level\": [8,9,8], \"c02_level\": [1220,1221,1220], \"timestamp\" :1475600522 },\n  {\"device_id\": 13, \"device_type\": \"sensor-ipad\", \"ip\": \"67.185.72.1\", \"cca3\": [\"USA\", \"United States\"], \"temp\": [34,35,34], \"signal\": [20,21,20], \"battery_level\": [8,8,8], \"c02_level\": [1504,1504,1503], \"timestamp\" :1475600524 },\n  {\"device_id\": 14, \"device_type\": \"sensor-inest\", \"ip\": \"68.85.85.106\", \"cca3\": [\"USA\", \"United States\"], \"temp\": [39,40,38], \"signal\": [17, 17, 18], \"battery_level\": [8,8,7], \"c02_level\": [831,832,831], \"timestamp\" :1475600526 },\n  {\"device_id\": 15, \"device_type\": \"sensor-ipad\", \"ip\": \"161.188.212.254\", \"cca3\": [\"USA\", \"United States\"], \"temp\": [27,27,28], \"signal\": [26,26,25], \"battery_level\": [5,5,5], \"c02_level\": [1378,1376,1378], \"timestamp\" :1475600528 },\n  {\"device_id\": 16, \"device_type\": \"sensor-igauge\", \"ip\": \"221.3.128.242\", \"cca3\": [\"CHN\", \"China\"], \"temp\": [10,10,11], \"signal\": [24,24,23], \"battery_level\": [6,5,6], \"c02_level\": [1423, 1423, 1423], \"timestamp\" :1475600530 },\n  {\"device_id\": 17, \"device_type\": \"sensor-ipad\", \"ip\": \"64.124.180.215\", \"cca3\": [\"USA\", \"United States\"], \"temp\": [38,38,39], \"signal\": [17,17,17], \"battery_level\": [9,9,9], \"c02_level\": [1304,1304,1304], \"timestamp\" :1475600532 },\n  {\"device_id\": 18, \"device_type\": \"sensor-igauge\", \"ip\": \"66.153.162.66\", \"cca3\": [\"USA\", \"United States\"], \"temp\": [26, 0, 99], \"signal\": [10, 1, 5], \"battery_level\": [0, 0, 0], \"c02_level\": [902,902, 1300], \"timestamp\" :1475600534 },\n  {\"device_id\": 19, \"device_type\": \"sensor-ipad\", \"ip\": \"193.200.142.254\", \"cca3\": [\"AUT\", \"Austria\"], \"temp\": [32,32,33], \"signal\": [27,27,28], \"battery_level\": [5,5,5], \"c02_level\": [1282, 1282, 1281], \"timestamp\" :1475600536 }\n  ]\"\"\", schema2)\n\ndisplay(dataDF2)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,[8,9,7],[917,921,925],[23,22,24],[25,26,27],["USA","United States"],"sensor-ipad","68.161.225.1","2016-10-04T17:01:36.000+0000"],[1,[6,6,5],[1413,1416,1417],[18,18,19],[30,32,35],["NOR","Norway"],"sensor-igauge","213.161.254.1","2016-10-04T17:01:38.000+0000"],[3,[1,1,0],[1447,1446,1448],[12,12,13],[47,47,48],["USA","United States"],"sensor-inest","66.39.173.154","2016-10-04T17:01:42.000+0000"],[4,[0,0,0],[983,990,982],[11,11,11],[29,29,28],["PHL","Philippines"],"sensor-ipad","203.82.41.9","2016-10-04T17:01:44.000+0000"],[5,[8,8,8],[1574,1575,1576],[16,16,17],[50,51,50],["USA","United States"],"sensor-istick","204.116.105.67","2016-10-04T17:01:46.000+0000"],[6,[9,9,9],[1249,1249,1250],[18,18,19],[21,21,22],["CHN","China"],"sensor-ipad","220.173.179.1","2016-10-04T17:01:48.000+0000"],[7,[0,0,0],[1531,1532,1531],[15,15,29],[27,27,28],["JPN","Japan"],"sensor-ipad","118.23.68.227","2016-10-04T17:01:52.000+0000"],[8,[9,9,10],[1208,1209,1208],[16,16,17],[40,40,41],["USA","United States"],"sensor-inest","208.109.163.218","2016-10-04T17:01:54.000+0000"],[9,[0,-1,0],[1171,1240,1400],[11,5,24],[19,28,5],["ITA","Italy"],"sensor-ipad","88.213.191.34","2016-10-04T17:01:56.000+0000"],[10,[7,7,8],[886,886,887],[26,26,25],[32,33,32],["USA","United States"],"sensor-igauge","68.28.91.22","2016-10-04T17:01:58.000+0000"],[11,[4,5,5],[863,862,864],[25,25,24],[46,45,44],["IND","India"],"sensor-ipad","59.144.114.250","2016-10-04T17:02:00.000+0000"],[12,[8,9,8],[1220,1221,1220],[26,25,26],[18,17,18],["NOR","Norway"],"sensor-igauge","193.156.90.200","2016-10-04T17:02:02.000+0000"],[13,[8,8,8],[1504,1504,1503],[20,21,20],[34,35,34],["USA","United States"],"sensor-ipad","67.185.72.1","2016-10-04T17:02:04.000+0000"],[14,[8,8,7],[831,832,831],[17,17,18],[39,40,38],["USA","United States"],"sensor-inest","68.85.85.106","2016-10-04T17:02:06.000+0000"],[15,[5,5,5],[1378,1376,1378],[26,26,25],[27,27,28],["USA","United States"],"sensor-ipad","161.188.212.254","2016-10-04T17:02:08.000+0000"],[16,[6,5,6],[1423,1423,1423],[24,24,23],[10,10,11],["CHN","China"],"sensor-igauge","221.3.128.242","2016-10-04T17:02:10.000+0000"],[17,[9,9,9],[1304,1304,1304],[17,17,17],[38,38,39],["USA","United States"],"sensor-ipad","64.124.180.215","2016-10-04T17:02:12.000+0000"],[18,[0,0,0],[902,902,1300],[10,1,5],[26,0,99],["USA","United States"],"sensor-igauge","66.153.162.66","2016-10-04T17:02:14.000+0000"],[19,[5,5,5],[1282,1282,1281],[27,27,28],[32,32,33],["AUT","Austria"],"sensor-ipad","193.200.142.254","2016-10-04T17:02:16.000+0000"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"device_id","type":"\"integer\"","metadata":"{}"},{"name":"battery_level","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"c02_level","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"signal","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"cca3","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"device_type","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"timestamp","type":"\"timestamp\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530223334,"submitTime":1501530223304,"finishTime":1501530223695,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6d9bed31-dc12-4f9e-b27a-84bf64c9dd2e"},{"version":"CommandV1","origId":3117922773650583,"guid":"2127e0b2-7229-45f4-a570-ea2101266102","subtype":"command","commandType":"auto","position":96.0,"command":"dataDF2.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- device_id: integer (nullable = true)\n |-- battery_level: array (nullable = true)\n |    |-- element: integer (containsNull = true)\n |-- c02_level: array (nullable = true)\n |    |-- element: integer (containsNull = true)\n |-- signal: array (nullable = true)\n |    |-- element: integer (containsNull = true)\n |-- temp: array (nullable = true)\n |    |-- element: integer (containsNull = true)\n |-- cca3: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- device_type: string (nullable = true)\n |-- ip: string (nullable = true)\n |-- timestamp: timestamp (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530233071,"submitTime":1501530233045,"finishTime":1501530233095,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"886f0ece-227e-4ca1-afb3-fe2e47aec836"},{"version":"CommandV1","origId":3117922773650584,"guid":"44ed0739-ce61-42e8-aab1-817368bbefcf","subtype":"command","commandType":"auto","position":97.0,"command":"dataDF2.createOrReplaceTempView(\"iot_nested_data\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530240137,"submitTime":1501530240111,"finishTime":1501530240177,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8f7de4ee-0a67-498b-93ef-dff6471bb744"},{"version":"CommandV1","origId":3117922773650585,"guid":"bbf1c346-7770-461e-84d2-3f2736aa0471","subtype":"command","commandType":"auto","position":98.0,"command":"%sql select cca3, device_type, battery_level,\n     transform (battery_level, bl -> bl > 0) as boolean_battery_level\n     from iot_nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["USA","United States"],"sensor-ipad",[8,9,7],[true,true,true]],[["NOR","Norway"],"sensor-igauge",[6,6,5],[true,true,true]],[["USA","United States"],"sensor-inest",[1,1,0],[true,true,false]],[["PHL","Philippines"],"sensor-ipad",[0,0,0],[false,false,false]],[["USA","United States"],"sensor-istick",[8,8,8],[true,true,true]],[["CHN","China"],"sensor-ipad",[9,9,9],[true,true,true]],[["JPN","Japan"],"sensor-ipad",[0,0,0],[false,false,false]],[["USA","United States"],"sensor-inest",[9,9,10],[true,true,true]],[["ITA","Italy"],"sensor-ipad",[0,-1,0],[false,false,false]],[["USA","United States"],"sensor-igauge",[7,7,8],[true,true,true]],[["IND","India"],"sensor-ipad",[4,5,5],[true,true,true]],[["NOR","Norway"],"sensor-igauge",[8,9,8],[true,true,true]],[["USA","United States"],"sensor-ipad",[8,8,8],[true,true,true]],[["USA","United States"],"sensor-inest",[8,8,7],[true,true,true]],[["USA","United States"],"sensor-ipad",[5,5,5],[true,true,true]],[["CHN","China"],"sensor-igauge",[6,5,6],[true,true,true]],[["USA","United States"],"sensor-ipad",[9,9,9],[true,true,true]],[["USA","United States"],"sensor-igauge",[0,0,0],[false,false,false]],[["AUT","Austria"],"sensor-ipad",[5,5,5],[true,true,true]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"device_type","type":"\"string\"","metadata":"{}"},{"name":"battery_level","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"boolean_battery_level","type":"{\"type\":\"array\",\"elementType\":\"boolean\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530247055,"submitTime":1501530247028,"finishTime":1501530247277,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"12bc16a2-45c0-487e-9ee6-46c6e1578db4"},{"version":"CommandV1","origId":3117922773650586,"guid":"83feb212-ae54-4172-bb55-ce7ffec114fb","subtype":"command","commandType":"auto","position":99.0,"command":"%sql select cca3,\n     transform (cca3, c -> lcase(c)) as lower_cca3,\n     transform (cca3, c -> ucase(c)) as upper_cca3\n     from iot_nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["USA","United States"],["usa","united states"],["USA","UNITED STATES"]],[["NOR","Norway"],["nor","norway"],["NOR","NORWAY"]],[["USA","United States"],["usa","united states"],["USA","UNITED STATES"]],[["PHL","Philippines"],["phl","philippines"],["PHL","PHILIPPINES"]],[["USA","United States"],["usa","united states"],["USA","UNITED STATES"]],[["CHN","China"],["chn","china"],["CHN","CHINA"]],[["JPN","Japan"],["jpn","japan"],["JPN","JAPAN"]],[["USA","United States"],["usa","united states"],["USA","UNITED STATES"]],[["ITA","Italy"],["ita","italy"],["ITA","ITALY"]],[["USA","United States"],["usa","united states"],["USA","UNITED STATES"]],[["IND","India"],["ind","india"],["IND","INDIA"]],[["NOR","Norway"],["nor","norway"],["NOR","NORWAY"]],[["USA","United States"],["usa","united states"],["USA","UNITED STATES"]],[["USA","United States"],["usa","united states"],["USA","UNITED STATES"]],[["USA","United States"],["usa","united states"],["USA","UNITED STATES"]],[["CHN","China"],["chn","china"],["CHN","CHINA"]],[["USA","United States"],["usa","united states"],["USA","UNITED STATES"]],[["USA","United States"],["usa","united states"],["USA","UNITED STATES"]],[["AUT","Austria"],["aut","austria"],["AUT","AUSTRIA"]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"lower_cca3","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"upper_cca3","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530256178,"submitTime":1501530256151,"finishTime":1501530256401,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"82074818-9967-45f9-a28d-9aed3fc80a3d"},{"version":"CommandV1","origId":3117922773650587,"guid":"42eaf9af-d32c-4ccc-83ec-66a6f2516d95","subtype":"command","commandType":"auto","position":100.0,"command":"%sql select cca3, device_type, battery_level,\n     filter (battery_level, bl -> bl < 5) as low_levels\n     from iot_nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["USA","United States"],"sensor-ipad",[8,9,7],[]],[["NOR","Norway"],"sensor-igauge",[6,6,5],[]],[["USA","United States"],"sensor-inest",[1,1,0],[1,1,0]],[["PHL","Philippines"],"sensor-ipad",[0,0,0],[0,0,0]],[["USA","United States"],"sensor-istick",[8,8,8],[]],[["CHN","China"],"sensor-ipad",[9,9,9],[]],[["JPN","Japan"],"sensor-ipad",[0,0,0],[0,0,0]],[["USA","United States"],"sensor-inest",[9,9,10],[]],[["ITA","Italy"],"sensor-ipad",[0,-1,0],[0,-1,0]],[["USA","United States"],"sensor-igauge",[7,7,8],[]],[["IND","India"],"sensor-ipad",[4,5,5],[4]],[["NOR","Norway"],"sensor-igauge",[8,9,8],[]],[["USA","United States"],"sensor-ipad",[8,8,8],[]],[["USA","United States"],"sensor-inest",[8,8,7],[]],[["USA","United States"],"sensor-ipad",[5,5,5],[]],[["CHN","China"],"sensor-igauge",[6,5,6],[]],[["USA","United States"],"sensor-ipad",[9,9,9],[]],[["USA","United States"],"sensor-igauge",[0,0,0],[0,0,0]],[["AUT","Austria"],"sensor-ipad",[5,5,5],[]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"device_type","type":"\"string\"","metadata":"{}"},{"name":"battery_level","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"low_levels","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530264513,"submitTime":1501530264486,"finishTime":1501530264737,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"044572f5-61d9-46af-914f-4eca93deffd7"},{"version":"CommandV1","origId":3117922773650588,"guid":"947b21e3-9b3d-4b5a-907a-213a94989767","subtype":"command","commandType":"auto","position":101.0,"command":"%sql select cca3, device_type, battery_level,\n     reduce(battery_level, 0, (t, acc) -> t + acc,  acc -> acc div size(battery_level) ) as average_battery_level\n     from iot_nested_data\n     sort by average_battery_level desc","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["CHN","China"],"sensor-ipad",[9,9,9],9],[["USA","United States"],"sensor-inest",[9,9,10],9],[["USA","United States"],"sensor-ipad",[9,9,9],9],[["USA","United States"],"sensor-ipad",[8,9,7],8],[["USA","United States"],"sensor-istick",[8,8,8],8],[["NOR","Norway"],"sensor-igauge",[8,9,8],8],[["USA","United States"],"sensor-ipad",[8,8,8],8],[["USA","United States"],"sensor-igauge",[7,7,8],7],[["USA","United States"],"sensor-inest",[8,8,7],7],[["NOR","Norway"],"sensor-igauge",[6,6,5],5],[["USA","United States"],"sensor-ipad",[5,5,5],5],[["CHN","China"],"sensor-igauge",[6,5,6],5],[["AUT","Austria"],"sensor-ipad",[5,5,5],5],[["IND","India"],"sensor-ipad",[4,5,5],4],[["USA","United States"],"sensor-inest",[1,1,0],0],[["PHL","Philippines"],"sensor-ipad",[0,0,0],0],[["JPN","Japan"],"sensor-ipad",[0,0,0],0],[["ITA","Italy"],"sensor-ipad",[0,-1,0],0],[["USA","United States"],"sensor-igauge",[0,0,0],0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"device_type","type":"\"string\"","metadata":"{}"},{"name":"battery_level","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"average_battery_level","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530281082,"submitTime":1501530281055,"finishTime":1501530281343,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"80b36f9f-bdff-43a1-a039-b494844de69d"},{"version":"CommandV1","origId":3117922773650589,"guid":"dcc24881-636d-4e5b-9889-ee0153cc44c5","subtype":"command","commandType":"auto","position":102.0,"command":"%sql select cca3, device_type, temp,\n     reduce(temp, 0, (t, acc) -> t + acc,  acc -> acc div size(temp) ) as average_temp\n     from iot_nested_data\n     sort by average_temp desc","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["USA","United States"],"sensor-istick",[50,51,50],50],[["USA","United States"],"sensor-inest",[47,47,48],47],[["IND","India"],"sensor-ipad",[46,45,44],45],[["USA","United States"],"sensor-igauge",[26,0,99],41],[["USA","United States"],"sensor-inest",[40,40,41],40],[["USA","United States"],"sensor-inest",[39,40,38],39],[["USA","United States"],"sensor-ipad",[38,38,39],38],[["USA","United States"],"sensor-ipad",[34,35,34],34],[["NOR","Norway"],"sensor-igauge",[30,32,35],32],[["USA","United States"],"sensor-igauge",[32,33,32],32],[["AUT","Austria"],"sensor-ipad",[32,32,33],32],[["PHL","Philippines"],"sensor-ipad",[29,29,28],28],[["JPN","Japan"],"sensor-ipad",[27,27,28],27],[["USA","United States"],"sensor-ipad",[27,27,28],27],[["USA","United States"],"sensor-ipad",[25,26,27],26],[["CHN","China"],"sensor-ipad",[21,21,22],21],[["ITA","Italy"],"sensor-ipad",[19,28,5],17],[["NOR","Norway"],"sensor-igauge",[18,17,18],17],[["CHN","China"],"sensor-igauge",[10,10,11],10]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"device_type","type":"\"string\"","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"average_temp","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530295886,"submitTime":1501530295857,"finishTime":1501530296136,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":["device_type"],"yColumns":["average_temp"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"30efd82a-ad64-48af-a246-eb47de42a667"},{"version":"CommandV1","origId":3117922773650590,"guid":"4ed80601-00e1-457f-a6d4-504a87d6c2fa","subtype":"command","commandType":"auto","position":103.0,"command":"%sql select cca3, device_type, c02_level,\n     reduce(c02_level, 0, (t, acc) -> t + acc,  acc -> acc div size(c02_level) ) as average_c02_level\n     from iot_nested_data\n     sort by average_c02_level desc","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["USA","United States"],"sensor-istick",[1574,1575,1576],1575],[["JPN","Japan"],"sensor-ipad",[1531,1532,1531],1531],[["USA","United States"],"sensor-ipad",[1504,1504,1503],1503],[["USA","United States"],"sensor-inest",[1447,1446,1448],1447],[["CHN","China"],"sensor-igauge",[1423,1423,1423],1423],[["NOR","Norway"],"sensor-igauge",[1413,1416,1417],1415],[["USA","United States"],"sensor-ipad",[1378,1376,1378],1377],[["USA","United States"],"sensor-ipad",[1304,1304,1304],1304],[["AUT","Austria"],"sensor-ipad",[1282,1282,1281],1281],[["ITA","Italy"],"sensor-ipad",[1171,1240,1400],1270],[["CHN","China"],"sensor-ipad",[1249,1249,1250],1249],[["NOR","Norway"],"sensor-igauge",[1220,1221,1220],1220],[["USA","United States"],"sensor-inest",[1208,1209,1208],1208],[["USA","United States"],"sensor-igauge",[902,902,1300],1034],[["PHL","Philippines"],"sensor-ipad",[983,990,982],985],[["USA","United States"],"sensor-ipad",[917,921,925],921],[["USA","United States"],"sensor-igauge",[886,886,887],886],[["IND","India"],"sensor-ipad",[863,862,864],863],[["USA","United States"],"sensor-inest",[831,832,831],831]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"device_type","type":"\"string\"","metadata":"{}"},{"name":"c02_level","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"average_c02_level","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530304892,"submitTime":1501530304864,"finishTime":1501530305129,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8b043656-a54a-4ff3-bad9-58081e8c548d"},{"version":"CommandV1","origId":3117922773650591,"guid":"09826a4f-bb53-483b-9e03-39be0bb971c2","subtype":"command","commandType":"auto","position":104.0,"command":"%sql select cca3, device_type, signal, temp, c02_level,\n     reduce(signal, 0, (s, sacc) -> s + sacc,  sacc -> sacc div size(signal) ) as average_signal,\n     reduce(temp, 0, (t, tacc) -> t + tacc,  tacc -> tacc div size(temp) ) as average_temp,\n     reduce(c02_level, 0, (c, cacc) -> c + cacc,  cacc -> cacc div size(c02_level) ) as average_c02_level\n     from iot_nested_data\n     sort by average_signal desc","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["AUT","Austria"],"sensor-ipad",[27,27,28],[32,32,33],[1282,1282,1281],27,32,1281],[["USA","United States"],"sensor-igauge",[26,26,25],[32,33,32],[886,886,887],25,32,886],[["NOR","Norway"],"sensor-igauge",[26,25,26],[18,17,18],[1220,1221,1220],25,17,1220],[["USA","United States"],"sensor-ipad",[26,26,25],[27,27,28],[1378,1376,1378],25,27,1377],[["IND","India"],"sensor-ipad",[25,25,24],[46,45,44],[863,862,864],24,45,863],[["USA","United States"],"sensor-ipad",[23,22,24],[25,26,27],[917,921,925],23,26,921],[["CHN","China"],"sensor-igauge",[24,24,23],[10,10,11],[1423,1423,1423],23,10,1423],[["USA","United States"],"sensor-ipad",[20,21,20],[34,35,34],[1504,1504,1503],20,34,1503],[["JPN","Japan"],"sensor-ipad",[15,15,29],[27,27,28],[1531,1532,1531],19,27,1531],[["NOR","Norway"],"sensor-igauge",[18,18,19],[30,32,35],[1413,1416,1417],18,32,1415],[["CHN","China"],"sensor-ipad",[18,18,19],[21,21,22],[1249,1249,1250],18,21,1249],[["USA","United States"],"sensor-inest",[17,17,18],[39,40,38],[831,832,831],17,39,831],[["USA","United States"],"sensor-ipad",[17,17,17],[38,38,39],[1304,1304,1304],17,38,1304],[["USA","United States"],"sensor-istick",[16,16,17],[50,51,50],[1574,1575,1576],16,50,1575],[["USA","United States"],"sensor-inest",[16,16,17],[40,40,41],[1208,1209,1208],16,40,1208],[["ITA","Italy"],"sensor-ipad",[11,5,24],[19,28,5],[1171,1240,1400],13,17,1270],[["USA","United States"],"sensor-inest",[12,12,13],[47,47,48],[1447,1446,1448],12,47,1447],[["PHL","Philippines"],"sensor-ipad",[11,11,11],[29,29,28],[983,990,982],11,28,985],[["USA","United States"],"sensor-igauge",[10,1,5],[26,0,99],[902,902,1300],5,41,1034]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cca3","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"device_type","type":"\"string\"","metadata":"{}"},{"name":"signal","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"temp","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"c02_level","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"average_signal","type":"\"long\"","metadata":"{}"},{"name":"average_temp","type":"\"long\"","metadata":"{}"},{"name":"average_c02_level","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530342746,"submitTime":1501530342717,"finishTime":1501530343050,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"08ddcd35-e545-4671-8105-501ead55ff60"},{"version":"CommandV1","origId":3117922773650592,"guid":"78679b8a-de25-4c15-bd46-729ae24c0147","subtype":"command","commandType":"auto","position":105.0,"command":"%scala\nimport org.apache.spark.sql.expressions.MutableAggregationBuffer\nimport org.apache.spark.sql.expressions.UserDefinedAggregateFunction\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.types._\n\nclass GeometricMean extends UserDefinedAggregateFunction {\n  // This is the input fields for your aggregate function.\n  override def inputSchema: org.apache.spark.sql.types.StructType =\n    StructType(StructField(\"value\", DoubleType) :: Nil)\n\n  // This is the internal fields you keep for computing your aggregate.\n  override def bufferSchema: StructType = StructType(\n    StructField(\"count\", LongType) ::\n    StructField(\"product\", DoubleType) :: Nil\n  )\n\n  // This is the output type of your aggregatation function.\n  override def dataType: DataType = DoubleType\n\n  override def deterministic: Boolean = true\n\n  // This is the initial value for your buffer schema.\n  override def initialize(buffer: MutableAggregationBuffer): Unit = {\n    buffer(0) = 0L\n    buffer(1) = 1.0\n  }\n\n  // This is how to update your buffer schema given an input.\n  override def update(buffer: MutableAggregationBuffer, input: Row): Unit = {\n    buffer(0) = buffer.getAs[Long](0) + 1\n    buffer(1) = buffer.getAs[Double](1) * input.getAs[Double](0)\n  }\n\n  // This is how to merge two objects with the bufferSchema type.\n  override def merge(buffer1: MutableAggregationBuffer, buffer2: Row): Unit = {\n    buffer1(0) = buffer1.getAs[Long](0) + buffer2.getAs[Long](0)\n    buffer1(1) = buffer1.getAs[Double](1) * buffer2.getAs[Double](1)\n  }\n\n  // This is where you output the final value, given the final value of your bufferSchema.\n  override def evaluate(buffer: Row): Any = {\n    math.pow(buffer.getDouble(1), 1.toDouble / buffer.getLong(0))\n  }\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.expressions.MutableAggregationBuffer\nimport org.apache.spark.sql.expressions.UserDefinedAggregateFunction\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.types._\ndefined class GeometricMean\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-50-ec6443f76f51&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">6</span>\n<span class=\"ansiyellow\">    class GeometricMean extends UserDefinedAggregateFunction {</span>\n<span class=\"ansigrey\">                              ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1501530535642,"submitTime":1501530535627,"finishTime":1501530536114,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a729f81b-81a7-44d9-8b6a-24a4e01c5adf"},{"version":"CommandV1","origId":3117922773650593,"guid":"2e949b57-0e81-4072-98ba-3249af245bd8","subtype":"command","commandType":"auto","position":106.0,"command":"%scala\nsqlContext.udf.register(\"gm\", new GeometricMean)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res18: org.apache.spark.sql.expressions.UserDefinedAggregateFunction = $iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$GeometricMean@2f14a1c6\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-51-8c8f488353be&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    sqlContext.udf.register(&quot;gm&quot;, new GeometricMean)</span>\n<span class=\"ansigrey\">                                                  ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1501530549838,"submitTime":1501530549807,"finishTime":1501530550296,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aa418b9a-e300-4e05-b226-80d2b3d6d967"},{"version":"CommandV1","origId":3117922773650594,"guid":"a56899a2-6498-4756-a4c5-bc2486cdfa1a","subtype":"command","commandType":"auto","position":107.0,"command":"%scala\n// Create a DataFrame and Spark SQL Table to query.\nimport org.apache.spark.sql.functions._\n\nval ids = sqlContext.range(1, 20)\nids.registerTempTable(\"ids\")\nval df = sqlContext.sql(\"select id, id % 3 as group_id from ids\")\ndf.registerTempTable(\"simple\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">&lt;console&gt;:50: warning: method registerTempTable in class Dataset is deprecated: Use createOrReplaceTempView(viewName) instead.\n              ids.registerTempTable(&quot;ids&quot;)\n                  ^\n&lt;console&gt;:54: warning: method registerTempTable in class Dataset is deprecated: Use createOrReplaceTempView(viewName) instead.\n              df.registerTempTable(&quot;simple&quot;)\n                 ^\nimport org.apache.spark.sql.functions._\nids: org.apache.spark.sql.DataFrame = [id: bigint]\ndf: org.apache.spark.sql.DataFrame = [id: bigint, group_id: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530561885,"submitTime":1501530561854,"finishTime":1501530562344,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d3844f30-9ace-4cff-84b0-8daf900fefcd"},{"version":"CommandV1","origId":3117922773650595,"guid":"12fc2e07-5093-481f-b75a-64b9651a28ce","subtype":"command","commandType":"auto","position":108.0,"command":"%sql\n-- Use a group_by statement and call the UDAF.\nselect group_id, gm(id) from simple group by group_id","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,8.981385496571725],[1,7.301716979342118],[2,7.706253151292568]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"group_id","type":"\"long\"","metadata":"{}"},{"name":"geometricmean(CAST(id AS DOUBLE))","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530581994,"submitTime":1501530581962,"finishTime":1501530582949,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6d091fd4-588f-42d6-8eff-ef1a653d49e0"},{"version":"CommandV1","origId":3117922773650596,"guid":"e85d8923-d8c3-4864-94af-48e0ca2e994a","subtype":"command","commandType":"auto","position":109.0,"command":"%scala\n// Or use Dataframe syntax to call the aggregate function.\n\n// Create an instance of UDAF GeometricMean.\nval gm = new GeometricMean\n\n// Show the geometric mean of values of column \"id\".\ndf.groupBy(\"group_id\").agg(gm(col(\"id\")).as(\"GeometricMean\")).show()\n\n// Invoke the UDAF by its assigned name.\ndf.groupBy(\"group_id\").agg(expr(\"gm(id) as GeometricMean\")).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------+-----------------+\n|group_id|    GeometricMean|\n+--------+-----------------+\n|       0|8.981385496571725|\n|       1|7.301716979342118|\n|       2|7.706253151292568|\n+--------+-----------------+\n\n+--------+-----------------+\n|group_id|    GeometricMean|\n+--------+-----------------+\n|       0|8.981385496571725|\n|       1|7.301716979342118|\n|       2|7.706253151292568|\n+--------+-----------------+\n\ngm: GeometricMean = $iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$GeometricMean@32c7378d\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530594883,"submitTime":1501530594852,"finishTime":1501530596515,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"abad3122-d868-4288-b23b-ecc8592209cf"},{"version":"CommandV1","origId":3117922773650597,"guid":"a580c8b8-b4f0-4194-aa33-fab03cf671d2","subtype":"command","commandType":"auto","position":110.0,"command":"def squared(s):\n  return s * s\nsqlContext.udf.register(\"squaredWithPython\", squared)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530610585,"submitTime":1501530610554,"finishTime":1501530610709,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"54c9ed70-d2a1-4e58-9e9f-88711cae0dfa"},{"version":"CommandV1","origId":3117922773650598,"guid":"2a7dd7e6-83b1-4880-bcac-1e5eac3b2326","subtype":"command","commandType":"auto","position":111.0,"command":"from pyspark.sql.types import LongType\ndef squared_typed(s):\n  return s * s\nsqlContext.udf.register(\"squaredWithPython\", squared, LongType())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530617087,"submitTime":1501530617054,"finishTime":1501530617159,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e54e155d-c79f-4bf1-a0b1-a4c5a5147a87"},{"version":"CommandV1","origId":3117922773650599,"guid":"1058e7ab-f0f9-4a64-beae-099b223a46dd","subtype":"command","commandType":"auto","position":112.0,"command":"sqlContext.range(1, 20).registerTempTable(\"test\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530623643,"submitTime":1501530623611,"finishTime":1501530623766,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"00a345f7-e0e4-4af7-9de3-576abd3f3e9a"},{"version":"CommandV1","origId":3117922773650600,"guid":"173c8631-ab72-43a1-bd58-e527b0d429b8","subtype":"command","commandType":"auto","position":113.0,"command":"%sql select id, squaredWithPython(id) as id_squared from test","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,1],[2,4],[3,9],[4,16],[5,25],[6,36],[7,49],[8,64],[9,81],[10,100],[11,121],[12,144],[13,169],[14,196],[15,225],[16,256],[17,289],[18,324],[19,361]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"id_squared","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530627261,"submitTime":1501530627228,"finishTime":1501530627599,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"598527ab-fd4a-4c38-afca-48ccf8d30248"},{"version":"CommandV1","origId":3117922773650601,"guid":"0887741b-f80f-4ffc-a8f5-2924979be647","subtype":"command","commandType":"auto","position":114.0,"command":"%sql select * FROM test","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530633648,"submitTime":1501530633616,"finishTime":1501530633703,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cf5e3b06-ce17-48a6-a83f-c24b666dc3cc"},{"version":"CommandV1","origId":3117922773650602,"guid":"0b3afcaa-67a6-4928-88e8-ada19284fbda","subtype":"command","commandType":"auto","position":115.0,"command":"from pyspark.sql.functions import udf\nsquared_udf = udf(squared, LongType())\ndf = sqlContext.table(\"test\")\ndisplay(df.select(\"id\", squared_udf(\"id\").alias(\"id_squared\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,1],[2,4],[3,9],[4,16],[5,25],[6,36],[7,49],[8,64],[9,81],[10,100],[11,121],[12,144],[13,169],[14,196],[15,225],[16,256],[17,289],[18,324],[19,361]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"id_squared","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530641358,"submitTime":1501530641324,"finishTime":1501530641642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8be1fd4e-d746-4828-b03d-87237a111e3d"},{"version":"CommandV1","origId":3117922773650603,"guid":"5b538057-bfb0-4c50-afa3-44b32d59c12b","subtype":"command","commandType":"auto","position":116.0,"command":"%scala\nval squared = (s: Int) => {\n  s * s\n}\nsqlContext.udf.register(\"square\", squared)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">squared: Int =&gt; Int = &lt;function1&gt;\nres21: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(&lt;function1&gt;,IntegerType,Some(List(IntegerType)))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530659897,"submitTime":1501530659864,"finishTime":1501530660314,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d3ce3d50-05d0-4075-a056-b7b5c283560d"},{"version":"CommandV1","origId":3117922773650604,"guid":"590407c0-eb7f-4cf3-bea2-5451d31987a9","subtype":"command","commandType":"auto","position":117.0,"command":"%scala\nsqlContext.range(1, 20).registerTempTable(\"test\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">&lt;console&gt;:51: warning: method registerTempTable in class Dataset is deprecated: Use createOrReplaceTempView(viewName) instead.\n              sqlContext.range(1, 20).registerTempTable(&quot;test&quot;)\n                                      ^\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530668842,"submitTime":1501530668808,"finishTime":1501530668968,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a2277d26-9278-412e-9f5b-329c2d207dab"},{"version":"CommandV1","origId":3117922773650605,"guid":"7acf98ba-6097-493f-ba27-75232f88175c","subtype":"command","commandType":"auto","position":118.0,"command":"%sql select id, square(id) as id_squared from test","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,1],[2,4],[3,9],[4,16],[5,25],[6,36],[7,49],[8,64],[9,81],[10,100],[11,121],[12,144],[13,169],[14,196],[15,225],[16,256],[17,289],[18,324],[19,361]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"id_squared","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501530673705,"submitTime":1501530673671,"finishTime":1501530673840,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fc8baabe-d499-47bc-a645-b4e45854dcb7"}],"dashboards":[],"guid":"ea7355ee-8109-48b1-b751-85df178d159a","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
