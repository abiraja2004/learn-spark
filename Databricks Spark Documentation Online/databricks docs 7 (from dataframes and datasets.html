<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>databricks docs 7 (from dataframes and datasets - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"serverlessDefaultSparkVersion":"2.2.x-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","enableTableHandler":false,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableFindAndReplace":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 RC1 (Scala 2.10)","packageLabel":"spark-image-b4aa93c32938e1947a3e5565e7f963af5c05e5bf2fcd0c69fa0cdc5a7f3f35d5","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-f43ddf8ad9acfd71338f5a51345f077173d236016ad7e39ffd6f698403acd4ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"3.1.x-scala2.11","displayName":"3.1 beta (Scala 2.11)","packageLabel":"spark-image-156e7fe2ab001d34ed6296c64799b21e48ec12170bcdfa5503f3253ac90d7bf9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"3.1.x-scala2.10","displayName":"3.1 beta (Scala 2.10)","packageLabel":"spark-image-d100fd3fc8250b24cdbeb07135d560388ac5ebef1e0fa5b19966ebb6a481dea2","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 RC1 (Scala 2.11)","packageLabel":"spark-image-6db1dbb7890e46eddcc56d5c944ea7a4fd6ea4080c61326ea1a4b4320a035950","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableClearStateAndRunAll":true,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":6,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"r4.16xlarge":16,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":8,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.75,"r4.8xlarge":8,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.375,"p2.16xlarge":24,"i3.8xlarge":12,"i3.16xlarge":24,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1.5,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":3,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"c4.8xlarge":4,"i3.xlarge":1.5,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.50","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"preferStartTerminatedCluster":true,"enableNonPollingTableCall":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"2162bae813344ed1541d63a989142c9938e96057","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewJobList":true,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3117922773650607,"name":"databricks docs 7 (from dataframes and datasets","language":"python","commands":[{"version":"CommandV1","origId":3117922773650608,"guid":"121c0889-750d-4c3e-9899-12ac3d6371c2","subtype":"command","commandType":"auto","position":1.0,"command":"%scala\nimport org.apache.spark.sql.types._                         // include the Spark Types to define our schema\nimport org.apache.spark.sql.functions._                     // include the Spark helper functions\n\nval jsonSchema = new StructType()\n        .add(\"battery_level\", LongType)\n        .add(\"c02_level\", LongType)\n        .add(\"cca3\",StringType)\n        .add(\"cn\", StringType)\n        .add(\"device_id\", LongType)\n        .add(\"device_type\", StringType)\n        .add(\"signal\", LongType)\n        .add(\"ip\", StringType)\n        .add(\"temp\", LongType)\n        .add(\"timestamp\", TimestampType)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\njsonSchema: org.apache.spark.sql.types.StructType = StructType(StructField(battery_level,LongType,true), StructField(c02_level,LongType,true), StructField(cca3,StringType,true), StructField(cn,StringType,true), StructField(device_id,LongType,true), StructField(device_type,StringType,true), StructField(signal,LongType,true), StructField(ip,StringType,true), StructField(temp,LongType,true), StructField(timestamp,TimestampType,true))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-1-4cc1fda1393f&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    import org.apache.spark.sql.types._                         // include the Spark Types to define our schema</span>\n<span class=\"ansigrey\">                                                                 ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1501531701900,"submitTime":1501531701868,"finishTime":1501531703831,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e928db72-d888-485a-a47c-00ed7ed564b4"},{"version":"CommandV1","origId":3117922773650610,"guid":"0cb3f826-c304-46ae-997a-a79f24c72456","subtype":"command","commandType":"auto","position":2.0,"command":"%scala\n// define a case class\ncase class DeviceData (id: Int, device: String)\n// create some sample data\nval eventsDS = Seq (\n (0, \"\"\"{\"device_id\": 0, \"device_type\": \"sensor-ipad\", \"ip\": \"68.161.225.1\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 25, \"signal\": 23, \"battery_level\": 8, \"c02_level\": 917, \"timestamp\" :1475600496 }\"\"\"),\n (1, \"\"\"{\"device_id\": 1, \"device_type\": \"sensor-igauge\", \"ip\": \"213.161.254.1\", \"cca3\": \"NOR\", \"cn\": \"Norway\", \"temp\": 30, \"signal\": 18, \"battery_level\": 6, \"c02_level\": 1413, \"timestamp\" :1475600498 }\"\"\"),\n (2, \"\"\"{\"device_id\": 2, \"device_type\": \"sensor-ipad\", \"ip\": \"88.36.5.1\", \"cca3\": \"ITA\", \"cn\": \"Italy\", \"temp\": 18, \"signal\": 25, \"battery_level\": 5, \"c02_level\": 1372, \"timestamp\" :1475600500 }\"\"\"),\n (3, \"\"\"{\"device_id\": 3, \"device_type\": \"sensor-inest\", \"ip\": \"66.39.173.154\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 47, \"signal\": 12, \"battery_level\": 1, \"c02_level\": 1447, \"timestamp\" :1475600502 }\"\"\"),\n(4, \"\"\"{\"device_id\": 4, \"device_type\": \"sensor-ipad\", \"ip\": \"203.82.41.9\", \"cca3\": \"PHL\", \"cn\": \"Philippines\", \"temp\": 29, \"signal\": 11, \"battery_level\": 0, \"c02_level\": 983, \"timestamp\" :1475600504 }\"\"\"),\n(5, \"\"\"{\"device_id\": 5, \"device_type\": \"sensor-istick\", \"ip\": \"204.116.105.67\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 50, \"signal\": 16, \"battery_level\": 8, \"c02_level\": 1574, \"timestamp\" :1475600506 }\"\"\"),\n(6, \"\"\"{\"device_id\": 6, \"device_type\": \"sensor-ipad\", \"ip\": \"220.173.179.1\", \"cca3\": \"CHN\", \"cn\": \"China\", \"temp\": 21, \"signal\": 18, \"battery_level\": 9, \"c02_level\": 1249, \"timestamp\" :1475600508 }\"\"\"),\n(7, \"\"\"{\"device_id\": 7, \"device_type\": \"sensor-ipad\", \"ip\": \"118.23.68.227\", \"cca3\": \"JPN\", \"cn\": \"Japan\", \"temp\": 27, \"signal\": 15, \"battery_level\": 0, \"c02_level\": 1531, \"timestamp\" :1475600512 }\"\"\"),\n(8 ,\"\"\" {\"device_id\": 8, \"device_type\": \"sensor-inest\", \"ip\": \"208.109.163.218\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 40, \"signal\": 16, \"battery_level\": 9, \"c02_level\": 1208, \"timestamp\" :1475600514 }\"\"\"),\n(9,\"\"\"{\"device_id\": 9, \"device_type\": \"sensor-ipad\", \"ip\": \"88.213.191.34\", \"cca3\": \"ITA\", \"cn\": \"Italy\", \"temp\": 19, \"signal\": 11, \"battery_level\": 0, \"c02_level\": 1171, \"timestamp\" :1475600516 }\"\"\"),\n(10,\"\"\"{\"device_id\": 10, \"device_type\": \"sensor-igauge\", \"ip\": \"68.28.91.22\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 32, \"signal\": 26, \"battery_level\": 7, \"c02_level\": 886, \"timestamp\" :1475600518 }\"\"\"),\n(11,\"\"\"{\"device_id\": 11, \"device_type\": \"sensor-ipad\", \"ip\": \"59.144.114.250\", \"cca3\": \"IND\", \"cn\": \"India\", \"temp\": 46, \"signal\": 25, \"battery_level\": 4, \"c02_level\": 863, \"timestamp\" :1475600520 }\"\"\"),\n(12, \"\"\"{\"device_id\": 12, \"device_type\": \"sensor-igauge\", \"ip\": \"193.156.90.200\", \"cca3\": \"NOR\", \"cn\": \"Norway\", \"temp\": 18, \"signal\": 26, \"battery_level\": 8, \"c02_level\": 1220, \"timestamp\" :1475600522 }\"\"\"),\n(13, \"\"\"{\"device_id\": 13, \"device_type\": \"sensor-ipad\", \"ip\": \"67.185.72.1\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 34, \"signal\": 20, \"battery_level\": 8, \"c02_level\": 1504, \"timestamp\" :1475600524 }\"\"\"),\n(14, \"\"\"{\"device_id\": 14, \"device_type\": \"sensor-inest\", \"ip\": \"68.85.85.106\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 39, \"signal\": 17, \"battery_level\": 8, \"c02_level\": 831, \"timestamp\" :1475600526 }\"\"\"),\n(15, \"\"\"{\"device_id\": 15, \"device_type\": \"sensor-ipad\", \"ip\": \"161.188.212.254\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 27, \"signal\": 26, \"battery_level\": 5, \"c02_level\": 1378, \"timestamp\" :1475600528 }\"\"\"),\n(16, \"\"\"{\"device_id\": 16, \"device_type\": \"sensor-igauge\", \"ip\": \"221.3.128.242\", \"cca3\": \"CHN\", \"cn\": \"China\", \"temp\": 10, \"signal\": 24, \"battery_level\": 6, \"c02_level\": 1423, \"timestamp\" :1475600530 }\"\"\"),\n(17, \"\"\"{\"device_id\": 17, \"device_type\": \"sensor-ipad\", \"ip\": \"64.124.180.215\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 38, \"signal\": 17, \"battery_level\": 9, \"c02_level\": 1304, \"timestamp\" :1475600532 }\"\"\"),\n(18, \"\"\"{\"device_id\": 18, \"device_type\": \"sensor-igauge\", \"ip\": \"66.153.162.66\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 26, \"signal\": 10, \"battery_level\": 0, \"c02_level\": 902, \"timestamp\" :1475600534 }\"\"\"),\n(19, \"\"\"{\"device_id\": 19, \"device_type\": \"sensor-ipad\", \"ip\": \"193.200.142.254\", \"cca3\": \"AUT\", \"cn\": \"Austria\", \"temp\": 32, \"signal\": 27, \"battery_level\": 5, \"c02_level\": 1282, \"timestamp\" :1475600536 }\"\"\")).toDF(\"id\", \"device\").as[DeviceData]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class DeviceData\neventsDS: org.apache.spark.sql.Dataset[DeviceData] = [id: int, device: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501531715702,"submitTime":1501531715686,"finishTime":1501531717469,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"878fdbb7-46b9-4ef3-a10e-737a0c35f793"},{"version":"CommandV1","origId":3117922773650611,"guid":"abb4c88d-6e5b-4dc1-a8a7-1907018c5aaa","subtype":"command","commandType":"auto","position":3.0,"command":"%scala\ndisplay(eventsDS)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"{\"device_id\": 0, \"device_type\": \"sensor-ipad\", \"ip\": \"68.161.225.1\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 25, \"signal\": 23, \"battery_level\": 8, \"c02_level\": 917, \"timestamp\" :1475600496 }"],[1,"{\"device_id\": 1, \"device_type\": \"sensor-igauge\", \"ip\": \"213.161.254.1\", \"cca3\": \"NOR\", \"cn\": \"Norway\", \"temp\": 30, \"signal\": 18, \"battery_level\": 6, \"c02_level\": 1413, \"timestamp\" :1475600498 }"],[2,"{\"device_id\": 2, \"device_type\": \"sensor-ipad\", \"ip\": \"88.36.5.1\", \"cca3\": \"ITA\", \"cn\": \"Italy\", \"temp\": 18, \"signal\": 25, \"battery_level\": 5, \"c02_level\": 1372, \"timestamp\" :1475600500 }"],[3,"{\"device_id\": 3, \"device_type\": \"sensor-inest\", \"ip\": \"66.39.173.154\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 47, \"signal\": 12, \"battery_level\": 1, \"c02_level\": 1447, \"timestamp\" :1475600502 }"],[4,"{\"device_id\": 4, \"device_type\": \"sensor-ipad\", \"ip\": \"203.82.41.9\", \"cca3\": \"PHL\", \"cn\": \"Philippines\", \"temp\": 29, \"signal\": 11, \"battery_level\": 0, \"c02_level\": 983, \"timestamp\" :1475600504 }"],[5,"{\"device_id\": 5, \"device_type\": \"sensor-istick\", \"ip\": \"204.116.105.67\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 50, \"signal\": 16, \"battery_level\": 8, \"c02_level\": 1574, \"timestamp\" :1475600506 }"],[6,"{\"device_id\": 6, \"device_type\": \"sensor-ipad\", \"ip\": \"220.173.179.1\", \"cca3\": \"CHN\", \"cn\": \"China\", \"temp\": 21, \"signal\": 18, \"battery_level\": 9, \"c02_level\": 1249, \"timestamp\" :1475600508 }"],[7,"{\"device_id\": 7, \"device_type\": \"sensor-ipad\", \"ip\": \"118.23.68.227\", \"cca3\": \"JPN\", \"cn\": \"Japan\", \"temp\": 27, \"signal\": 15, \"battery_level\": 0, \"c02_level\": 1531, \"timestamp\" :1475600512 }"],[8," {\"device_id\": 8, \"device_type\": \"sensor-inest\", \"ip\": \"208.109.163.218\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 40, \"signal\": 16, \"battery_level\": 9, \"c02_level\": 1208, \"timestamp\" :1475600514 }"],[9,"{\"device_id\": 9, \"device_type\": \"sensor-ipad\", \"ip\": \"88.213.191.34\", \"cca3\": \"ITA\", \"cn\": \"Italy\", \"temp\": 19, \"signal\": 11, \"battery_level\": 0, \"c02_level\": 1171, \"timestamp\" :1475600516 }"],[10,"{\"device_id\": 10, \"device_type\": \"sensor-igauge\", \"ip\": \"68.28.91.22\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 32, \"signal\": 26, \"battery_level\": 7, \"c02_level\": 886, \"timestamp\" :1475600518 }"],[11,"{\"device_id\": 11, \"device_type\": \"sensor-ipad\", \"ip\": \"59.144.114.250\", \"cca3\": \"IND\", \"cn\": \"India\", \"temp\": 46, \"signal\": 25, \"battery_level\": 4, \"c02_level\": 863, \"timestamp\" :1475600520 }"],[12,"{\"device_id\": 12, \"device_type\": \"sensor-igauge\", \"ip\": \"193.156.90.200\", \"cca3\": \"NOR\", \"cn\": \"Norway\", \"temp\": 18, \"signal\": 26, \"battery_level\": 8, \"c02_level\": 1220, \"timestamp\" :1475600522 }"],[13,"{\"device_id\": 13, \"device_type\": \"sensor-ipad\", \"ip\": \"67.185.72.1\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 34, \"signal\": 20, \"battery_level\": 8, \"c02_level\": 1504, \"timestamp\" :1475600524 }"],[14,"{\"device_id\": 14, \"device_type\": \"sensor-inest\", \"ip\": \"68.85.85.106\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 39, \"signal\": 17, \"battery_level\": 8, \"c02_level\": 831, \"timestamp\" :1475600526 }"],[15,"{\"device_id\": 15, \"device_type\": \"sensor-ipad\", \"ip\": \"161.188.212.254\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 27, \"signal\": 26, \"battery_level\": 5, \"c02_level\": 1378, \"timestamp\" :1475600528 }"],[16,"{\"device_id\": 16, \"device_type\": \"sensor-igauge\", \"ip\": \"221.3.128.242\", \"cca3\": \"CHN\", \"cn\": \"China\", \"temp\": 10, \"signal\": 24, \"battery_level\": 6, \"c02_level\": 1423, \"timestamp\" :1475600530 }"],[17,"{\"device_id\": 17, \"device_type\": \"sensor-ipad\", \"ip\": \"64.124.180.215\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 38, \"signal\": 17, \"battery_level\": 9, \"c02_level\": 1304, \"timestamp\" :1475600532 }"],[18,"{\"device_id\": 18, \"device_type\": \"sensor-igauge\", \"ip\": \"66.153.162.66\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 26, \"signal\": 10, \"battery_level\": 0, \"c02_level\": 902, \"timestamp\" :1475600534 }"],[19,"{\"device_id\": 19, \"device_type\": \"sensor-ipad\", \"ip\": \"193.200.142.254\", \"cca3\": \"AUT\", \"cn\": \"Austria\", \"temp\": 32, \"signal\": 27, \"battery_level\": 5, \"c02_level\": 1282, \"timestamp\" :1475600536 }"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"integer\"","metadata":"{}"},{"name":"device","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;eventsDS&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-2-02345e55ddc4&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>display<span class=\"ansiyellow\">(</span>eventsDS<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;eventsDS&apos; is not defined</div>","workflows":[],"startTime":1501531729766,"submitTime":1501531729752,"finishTime":1501531729976,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cf2baaea-108d-4786-88f3-b3e38df66ac5"},{"version":"CommandV1","origId":3117922773650612,"guid":"3e8be2ca-0593-4924-a77f-5a410e2722cb","subtype":"command","commandType":"auto","position":4.0,"command":"%scala\neventsDS.printSchema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- id: integer (nullable = false)\n |-- device: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;eventsDS&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-3-b7a9ade0800e&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>eventsDS<span class=\"ansiyellow\">.</span>printSchema<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;eventsDS&apos; is not defined</div>","workflows":[],"startTime":1501531746368,"submitTime":1501531746353,"finishTime":1501531746458,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8473786c-b8b2-487d-97cb-85ee2463bde7"},{"version":"CommandV1","origId":3117922773650613,"guid":"03342f1d-c774-4373-a7aa-2068e434dddd","subtype":"command","commandType":"auto","position":5.0,"command":"%scala\nval eventsFromJSONDF = Seq (\n (0, \"\"\"{\"device_id\": 0, \"device_type\": \"sensor-ipad\", \"ip\": \"68.161.225.1\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 25, \"signal\": 23, \"battery_level\": 8, \"c02_level\": 917, \"timestamp\" :1475600496 }\"\"\"),\n (1, \"\"\"{\"device_id\": 1, \"device_type\": \"sensor-igauge\", \"ip\": \"213.161.254.1\", \"cca3\": \"NOR\", \"cn\": \"Norway\", \"temp\": 30, \"signal\": 18, \"battery_level\": 6, \"c02_level\": 1413, \"timestamp\" :1475600498 }\"\"\"),\n (2, \"\"\"{\"device_id\": 2, \"device_type\": \"sensor-ipad\", \"ip\": \"88.36.5.1\", \"cca3\": \"ITA\", \"cn\": \"Italy\", \"temp\": 18, \"signal\": 25, \"battery_level\": 5, \"c02_level\": 1372, \"timestamp\" :1475600500 }\"\"\"),\n (3, \"\"\"{\"device_id\": 3, \"device_type\": \"sensor-inest\", \"ip\": \"66.39.173.154\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 47, \"signal\": 12, \"battery_level\": 1, \"c02_level\": 1447, \"timestamp\" :1475600502 }\"\"\"),\n(4, \"\"\"{\"device_id\": 4, \"device_type\": \"sensor-ipad\", \"ip\": \"203.82.41.9\", \"cca3\": \"PHL\", \"cn\": \"Philippines\", \"temp\": 29, \"signal\": 11, \"battery_level\": 0, \"c02_level\": 983, \"timestamp\" :1475600504 }\"\"\"),\n(5, \"\"\"{\"device_id\": 5, \"device_type\": \"sensor-istick\", \"ip\": \"204.116.105.67\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 50, \"signal\": 16, \"battery_level\": 8, \"c02_level\": 1574, \"timestamp\" :1475600506 }\"\"\"),\n(6, \"\"\"{\"device_id\": 6, \"device_type\": \"sensor-ipad\", \"ip\": \"220.173.179.1\", \"cca3\": \"CHN\", \"cn\": \"China\", \"temp\": 21, \"signal\": 18, \"battery_level\": 9, \"c02_level\": 1249, \"timestamp\" :1475600508 }\"\"\"),\n(7, \"\"\"{\"device_id\": 7, \"device_type\": \"sensor-ipad\", \"ip\": \"118.23.68.227\", \"cca3\": \"JPN\", \"cn\": \"Japan\", \"temp\": 27, \"signal\": 15, \"battery_level\": 0, \"c02_level\": 1531, \"timestamp\" :1475600512 }\"\"\"),\n(8 ,\"\"\" {\"device_id\": 8, \"device_type\": \"sensor-inest\", \"ip\": \"208.109.163.218\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 40, \"signal\": 16, \"battery_level\": 9, \"c02_level\": 1208, \"timestamp\" :1475600514 }\"\"\"),\n(9,\"\"\"{\"device_id\": 9, \"device_type\": \"sensor-ipad\", \"ip\": \"88.213.191.34\", \"cca3\": \"ITA\", \"cn\": \"Italy\", \"temp\": 19, \"signal\": 11, \"battery_level\": 0, \"c02_level\": 1171, \"timestamp\" :1475600516 }\"\"\")).toDF(\"id\", \"json\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">eventsFromJSONDF: org.apache.spark.sql.DataFrame = [id: int, json: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501531758747,"submitTime":1501531758731,"finishTime":1501531758936,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"676ebdb0-dc42-43d0-81dc-00499af8da7c"},{"version":"CommandV1","origId":3117922773650614,"guid":"f1d05ca5-10b7-4ff7-8133-691f5974d115","subtype":"command","commandType":"auto","position":6.0,"command":"%scala\ndisplay(eventsFromJSONDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"{\"device_id\": 0, \"device_type\": \"sensor-ipad\", \"ip\": \"68.161.225.1\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 25, \"signal\": 23, \"battery_level\": 8, \"c02_level\": 917, \"timestamp\" :1475600496 }"],[1,"{\"device_id\": 1, \"device_type\": \"sensor-igauge\", \"ip\": \"213.161.254.1\", \"cca3\": \"NOR\", \"cn\": \"Norway\", \"temp\": 30, \"signal\": 18, \"battery_level\": 6, \"c02_level\": 1413, \"timestamp\" :1475600498 }"],[2,"{\"device_id\": 2, \"device_type\": \"sensor-ipad\", \"ip\": \"88.36.5.1\", \"cca3\": \"ITA\", \"cn\": \"Italy\", \"temp\": 18, \"signal\": 25, \"battery_level\": 5, \"c02_level\": 1372, \"timestamp\" :1475600500 }"],[3,"{\"device_id\": 3, \"device_type\": \"sensor-inest\", \"ip\": \"66.39.173.154\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 47, \"signal\": 12, \"battery_level\": 1, \"c02_level\": 1447, \"timestamp\" :1475600502 }"],[4,"{\"device_id\": 4, \"device_type\": \"sensor-ipad\", \"ip\": \"203.82.41.9\", \"cca3\": \"PHL\", \"cn\": \"Philippines\", \"temp\": 29, \"signal\": 11, \"battery_level\": 0, \"c02_level\": 983, \"timestamp\" :1475600504 }"],[5,"{\"device_id\": 5, \"device_type\": \"sensor-istick\", \"ip\": \"204.116.105.67\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 50, \"signal\": 16, \"battery_level\": 8, \"c02_level\": 1574, \"timestamp\" :1475600506 }"],[6,"{\"device_id\": 6, \"device_type\": \"sensor-ipad\", \"ip\": \"220.173.179.1\", \"cca3\": \"CHN\", \"cn\": \"China\", \"temp\": 21, \"signal\": 18, \"battery_level\": 9, \"c02_level\": 1249, \"timestamp\" :1475600508 }"],[7,"{\"device_id\": 7, \"device_type\": \"sensor-ipad\", \"ip\": \"118.23.68.227\", \"cca3\": \"JPN\", \"cn\": \"Japan\", \"temp\": 27, \"signal\": 15, \"battery_level\": 0, \"c02_level\": 1531, \"timestamp\" :1475600512 }"],[8," {\"device_id\": 8, \"device_type\": \"sensor-inest\", \"ip\": \"208.109.163.218\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 40, \"signal\": 16, \"battery_level\": 9, \"c02_level\": 1208, \"timestamp\" :1475600514 }"],[9,"{\"device_id\": 9, \"device_type\": \"sensor-ipad\", \"ip\": \"88.213.191.34\", \"cca3\": \"ITA\", \"cn\": \"Italy\", \"temp\": 19, \"signal\": 11, \"battery_level\": 0, \"c02_level\": 1171, \"timestamp\" :1475600516 }"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"integer\"","metadata":"{}"},{"name":"json","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501531765385,"submitTime":1501531765371,"finishTime":1501531765520,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0b700466-e03f-43c6-ad44-e6a799916c5b"},{"version":"CommandV1","origId":3117922773650615,"guid":"dbaa551c-690c-4914-8854-6a421f083f5a","subtype":"command","commandType":"auto","position":7.0,"command":"%scala\nval jsDF = eventsFromJSONDF.select($\"id\", get_json_object($\"json\", \"$.device_type\").alias(\"device_type\"),\n                                          get_json_object($\"json\", \"$.ip\").alias(\"ip\"),\n                                         get_json_object($\"json\", \"$.cca3\").alias(\"cca3\"))\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">jsDF: org.apache.spark.sql.DataFrame = [id: int, device_type: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501531786780,"submitTime":1501531786765,"finishTime":1501531786936,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"64194b21-ab60-4a27-a18c-7edbaedc7b33"},{"version":"CommandV1","origId":3117922773650616,"guid":"d36c63f1-3d45-4549-af6c-24e4edd87857","subtype":"command","commandType":"auto","position":8.0,"command":"%scala\ndisplay(jsDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"sensor-ipad","68.161.225.1","USA"],[1,"sensor-igauge","213.161.254.1","NOR"],[2,"sensor-ipad","88.36.5.1","ITA"],[3,"sensor-inest","66.39.173.154","USA"],[4,"sensor-ipad","203.82.41.9","PHL"],[5,"sensor-istick","204.116.105.67","USA"],[6,"sensor-ipad","220.173.179.1","CHN"],[7,"sensor-ipad","118.23.68.227","JPN"],[8,"sensor-inest","208.109.163.218","USA"],[9,"sensor-ipad","88.213.191.34","ITA"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"integer\"","metadata":"{}"},{"name":"device_type","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"cca3","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501531795135,"submitTime":1501531795121,"finishTime":1501531795370,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"be37e232-a438-4e88-b5e0-21a0a6e7476f"},{"version":"CommandV1","origId":3117922773650617,"guid":"6d6455e6-75c5-4b72-b204-4b61313dcfea","subtype":"command","commandType":"auto","position":9.0,"command":"%scala\nval devicesDF = eventsDS.select(from_json($\"device\", jsonSchema) as \"devices\")\n.select($\"devices.*\")\n.filter($\"devices.temp\" > 10 and $\"devices.signal\" > 15)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">devicesDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [battery_level: bigint, c02_level: bigint ... 8 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501531804852,"submitTime":1501531804838,"finishTime":1501531805039,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"afdc9476-c58f-4e8f-8b23-e91462c8da1f"},{"version":"CommandV1","origId":3117922773650621,"guid":"d5946e5d-b6bf-4838-af37-115509503243","subtype":"command","commandType":"auto","position":9.5,"command":"%scala\ndisplay(devicesDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[8,917,"USA","United States",0,"sensor-ipad",23,"68.161.225.1",25,"2016-10-04T17:01:36.000+0000"],[6,1413,"NOR","Norway",1,"sensor-igauge",18,"213.161.254.1",30,"2016-10-04T17:01:38.000+0000"],[5,1372,"ITA","Italy",2,"sensor-ipad",25,"88.36.5.1",18,"2016-10-04T17:01:40.000+0000"],[8,1574,"USA","United States",5,"sensor-istick",16,"204.116.105.67",50,"2016-10-04T17:01:46.000+0000"],[9,1249,"CHN","China",6,"sensor-ipad",18,"220.173.179.1",21,"2016-10-04T17:01:48.000+0000"],[9,1208,"USA","United States",8,"sensor-inest",16,"208.109.163.218",40,"2016-10-04T17:01:54.000+0000"],[7,886,"USA","United States",10,"sensor-igauge",26,"68.28.91.22",32,"2016-10-04T17:01:58.000+0000"],[4,863,"IND","India",11,"sensor-ipad",25,"59.144.114.250",46,"2016-10-04T17:02:00.000+0000"],[8,1220,"NOR","Norway",12,"sensor-igauge",26,"193.156.90.200",18,"2016-10-04T17:02:02.000+0000"],[8,1504,"USA","United States",13,"sensor-ipad",20,"67.185.72.1",34,"2016-10-04T17:02:04.000+0000"],[8,831,"USA","United States",14,"sensor-inest",17,"68.85.85.106",39,"2016-10-04T17:02:06.000+0000"],[5,1378,"USA","United States",15,"sensor-ipad",26,"161.188.212.254",27,"2016-10-04T17:02:08.000+0000"],[9,1304,"USA","United States",17,"sensor-ipad",17,"64.124.180.215",38,"2016-10-04T17:02:12.000+0000"],[5,1282,"AUT","Austria",19,"sensor-ipad",27,"193.200.142.254",32,"2016-10-04T17:02:16.000+0000"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"battery_level","type":"\"long\"","metadata":"{}"},{"name":"c02_level","type":"\"long\"","metadata":"{}"},{"name":"cca3","type":"\"string\"","metadata":"{}"},{"name":"cn","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"long\"","metadata":"{}"},{"name":"device_type","type":"\"string\"","metadata":"{}"},{"name":"signal","type":"\"long\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"temp","type":"\"long\"","metadata":"{}"},{"name":"timestamp","type":"\"timestamp\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501531847105,"submitTime":1501531847091,"finishTime":1501531847509,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":["signal"],"yColumns":["temp"],"pivotColumns":["cn"],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":false},{"key":"stacked","value":true},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"66e50f36-1dc5-41f3-810c-b23a754ba55f"},{"version":"CommandV1","origId":3117922773650618,"guid":"43657bd1-187d-4b73-8a5b-284248f23c33","subtype":"command","commandType":"auto","position":10.0,"command":"%scala\nval devicesUSDF = devicesDF.select($\"*\").where($\"cca3\" === \"USA\").orderBy($\"signal\".desc, $\"temp\".desc)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">devicesUSDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [battery_level: bigint, c02_level: bigint ... 8 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501531815031,"submitTime":1501531815017,"finishTime":1501531815161,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"653be7aa-dd55-465e-9a0f-bcb1c3941f0a"},{"version":"CommandV1","origId":3117922773650619,"guid":"30286eed-8e4b-4d6c-8abb-f65a1b1e2e63","subtype":"command","commandType":"auto","position":11.0,"command":"%scala\ndisplay(devicesUSDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[7,886,"USA","United States",10,"sensor-igauge",26,"68.28.91.22",32,"2016-10-04T17:01:58.000+0000"],[5,1378,"USA","United States",15,"sensor-ipad",26,"161.188.212.254",27,"2016-10-04T17:02:08.000+0000"],[8,917,"USA","United States",0,"sensor-ipad",23,"68.161.225.1",25,"2016-10-04T17:01:36.000+0000"],[8,1504,"USA","United States",13,"sensor-ipad",20,"67.185.72.1",34,"2016-10-04T17:02:04.000+0000"],[8,831,"USA","United States",14,"sensor-inest",17,"68.85.85.106",39,"2016-10-04T17:02:06.000+0000"],[9,1304,"USA","United States",17,"sensor-ipad",17,"64.124.180.215",38,"2016-10-04T17:02:12.000+0000"],[8,1574,"USA","United States",5,"sensor-istick",16,"204.116.105.67",50,"2016-10-04T17:01:46.000+0000"],[9,1208,"USA","United States",8,"sensor-inest",16,"208.109.163.218",40,"2016-10-04T17:01:54.000+0000"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"battery_level","type":"\"long\"","metadata":"{}"},{"name":"c02_level","type":"\"long\"","metadata":"{}"},{"name":"cca3","type":"\"string\"","metadata":"{}"},{"name":"cn","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"long\"","metadata":"{}"},{"name":"device_type","type":"\"string\"","metadata":"{}"},{"name":"signal","type":"\"long\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"temp","type":"\"long\"","metadata":"{}"},{"name":"timestamp","type":"\"timestamp\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501531953624,"submitTime":1501531953610,"finishTime":1501531953925,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"1004.76666","height":"306.76666","xColumns":["device_id"],"yColumns":["temp"],"pivotColumns":["device_type"],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"pieChart":[{"key":"donut","value":true}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e5085180-8265-4717-bd00-a516025b25ee"},{"version":"CommandV1","origId":3117922773650622,"guid":"c3d420d5-379d-4e76-997c-d5dd8a67d194","subtype":"command","commandType":"auto","position":12.0,"command":"%scala\nval stringJsonDF = eventsDS.select(to_json(struct($\"*\"))).toDF(\"devices\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">stringJsonDF: org.apache.spark.sql.DataFrame = [devices: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532020657,"submitTime":1501532020642,"finishTime":1501532020781,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b4d8f08a-cf13-4c3f-b1b2-69a937f0ba75"},{"version":"CommandV1","origId":3117922773650623,"guid":"2d00e4ca-91af-423b-b775-8fb16d922fcf","subtype":"command","commandType":"auto","position":13.0,"command":"%scala\ndisplay(stringJsonDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["{\"id\":0,\"device\":\"{\\\"device_id\\\": 0, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"68.161.225.1\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 25, \\\"signal\\\": 23, \\\"battery_level\\\": 8, \\\"c02_level\\\": 917, \\\"timestamp\\\" :1475600496 }\"}"],["{\"id\":1,\"device\":\"{\\\"device_id\\\": 1, \\\"device_type\\\": \\\"sensor-igauge\\\", \\\"ip\\\": \\\"213.161.254.1\\\", \\\"cca3\\\": \\\"NOR\\\", \\\"cn\\\": \\\"Norway\\\", \\\"temp\\\": 30, \\\"signal\\\": 18, \\\"battery_level\\\": 6, \\\"c02_level\\\": 1413, \\\"timestamp\\\" :1475600498 }\"}"],["{\"id\":2,\"device\":\"{\\\"device_id\\\": 2, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"88.36.5.1\\\", \\\"cca3\\\": \\\"ITA\\\", \\\"cn\\\": \\\"Italy\\\", \\\"temp\\\": 18, \\\"signal\\\": 25, \\\"battery_level\\\": 5, \\\"c02_level\\\": 1372, \\\"timestamp\\\" :1475600500 }\"}"],["{\"id\":3,\"device\":\"{\\\"device_id\\\": 3, \\\"device_type\\\": \\\"sensor-inest\\\", \\\"ip\\\": \\\"66.39.173.154\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 47, \\\"signal\\\": 12, \\\"battery_level\\\": 1, \\\"c02_level\\\": 1447, \\\"timestamp\\\" :1475600502 }\"}"],["{\"id\":4,\"device\":\"{\\\"device_id\\\": 4, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"203.82.41.9\\\", \\\"cca3\\\": \\\"PHL\\\", \\\"cn\\\": \\\"Philippines\\\", \\\"temp\\\": 29, \\\"signal\\\": 11, \\\"battery_level\\\": 0, \\\"c02_level\\\": 983, \\\"timestamp\\\" :1475600504 }\"}"],["{\"id\":5,\"device\":\"{\\\"device_id\\\": 5, \\\"device_type\\\": \\\"sensor-istick\\\", \\\"ip\\\": \\\"204.116.105.67\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 50, \\\"signal\\\": 16, \\\"battery_level\\\": 8, \\\"c02_level\\\": 1574, \\\"timestamp\\\" :1475600506 }\"}"],["{\"id\":6,\"device\":\"{\\\"device_id\\\": 6, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"220.173.179.1\\\", \\\"cca3\\\": \\\"CHN\\\", \\\"cn\\\": \\\"China\\\", \\\"temp\\\": 21, \\\"signal\\\": 18, \\\"battery_level\\\": 9, \\\"c02_level\\\": 1249, \\\"timestamp\\\" :1475600508 }\"}"],["{\"id\":7,\"device\":\"{\\\"device_id\\\": 7, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"118.23.68.227\\\", \\\"cca3\\\": \\\"JPN\\\", \\\"cn\\\": \\\"Japan\\\", \\\"temp\\\": 27, \\\"signal\\\": 15, \\\"battery_level\\\": 0, \\\"c02_level\\\": 1531, \\\"timestamp\\\" :1475600512 }\"}"],["{\"id\":8,\"device\":\" {\\\"device_id\\\": 8, \\\"device_type\\\": \\\"sensor-inest\\\", \\\"ip\\\": \\\"208.109.163.218\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 40, \\\"signal\\\": 16, \\\"battery_level\\\": 9, \\\"c02_level\\\": 1208, \\\"timestamp\\\" :1475600514 }\"}"],["{\"id\":9,\"device\":\"{\\\"device_id\\\": 9, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"88.213.191.34\\\", \\\"cca3\\\": \\\"ITA\\\", \\\"cn\\\": \\\"Italy\\\", \\\"temp\\\": 19, \\\"signal\\\": 11, \\\"battery_level\\\": 0, \\\"c02_level\\\": 1171, \\\"timestamp\\\" :1475600516 }\"}"],["{\"id\":10,\"device\":\"{\\\"device_id\\\": 10, \\\"device_type\\\": \\\"sensor-igauge\\\", \\\"ip\\\": \\\"68.28.91.22\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 32, \\\"signal\\\": 26, \\\"battery_level\\\": 7, \\\"c02_level\\\": 886, \\\"timestamp\\\" :1475600518 }\"}"],["{\"id\":11,\"device\":\"{\\\"device_id\\\": 11, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"59.144.114.250\\\", \\\"cca3\\\": \\\"IND\\\", \\\"cn\\\": \\\"India\\\", \\\"temp\\\": 46, \\\"signal\\\": 25, \\\"battery_level\\\": 4, \\\"c02_level\\\": 863, \\\"timestamp\\\" :1475600520 }\"}"],["{\"id\":12,\"device\":\"{\\\"device_id\\\": 12, \\\"device_type\\\": \\\"sensor-igauge\\\", \\\"ip\\\": \\\"193.156.90.200\\\", \\\"cca3\\\": \\\"NOR\\\", \\\"cn\\\": \\\"Norway\\\", \\\"temp\\\": 18, \\\"signal\\\": 26, \\\"battery_level\\\": 8, \\\"c02_level\\\": 1220, \\\"timestamp\\\" :1475600522 }\"}"],["{\"id\":13,\"device\":\"{\\\"device_id\\\": 13, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"67.185.72.1\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 34, \\\"signal\\\": 20, \\\"battery_level\\\": 8, \\\"c02_level\\\": 1504, \\\"timestamp\\\" :1475600524 }\"}"],["{\"id\":14,\"device\":\"{\\\"device_id\\\": 14, \\\"device_type\\\": \\\"sensor-inest\\\", \\\"ip\\\": \\\"68.85.85.106\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 39, \\\"signal\\\": 17, \\\"battery_level\\\": 8, \\\"c02_level\\\": 831, \\\"timestamp\\\" :1475600526 }\"}"],["{\"id\":15,\"device\":\"{\\\"device_id\\\": 15, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"161.188.212.254\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 27, \\\"signal\\\": 26, \\\"battery_level\\\": 5, \\\"c02_level\\\": 1378, \\\"timestamp\\\" :1475600528 }\"}"],["{\"id\":16,\"device\":\"{\\\"device_id\\\": 16, \\\"device_type\\\": \\\"sensor-igauge\\\", \\\"ip\\\": \\\"221.3.128.242\\\", \\\"cca3\\\": \\\"CHN\\\", \\\"cn\\\": \\\"China\\\", \\\"temp\\\": 10, \\\"signal\\\": 24, \\\"battery_level\\\": 6, \\\"c02_level\\\": 1423, \\\"timestamp\\\" :1475600530 }\"}"],["{\"id\":17,\"device\":\"{\\\"device_id\\\": 17, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"64.124.180.215\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 38, \\\"signal\\\": 17, \\\"battery_level\\\": 9, \\\"c02_level\\\": 1304, \\\"timestamp\\\" :1475600532 }\"}"],["{\"id\":18,\"device\":\"{\\\"device_id\\\": 18, \\\"device_type\\\": \\\"sensor-igauge\\\", \\\"ip\\\": \\\"66.153.162.66\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 26, \\\"signal\\\": 10, \\\"battery_level\\\": 0, \\\"c02_level\\\": 902, \\\"timestamp\\\" :1475600534 }\"}"],["{\"id\":19,\"device\":\"{\\\"device_id\\\": 19, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"193.200.142.254\\\", \\\"cca3\\\": \\\"AUT\\\", \\\"cn\\\": \\\"Austria\\\", \\\"temp\\\": 32, \\\"signal\\\": 27, \\\"battery_level\\\": 5, \\\"c02_level\\\": 1282, \\\"timestamp\\\" :1475600536 }\"}"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"devices","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532026568,"submitTime":1501532026553,"finishTime":1501532026688,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b8d66f44-aa9c-45eb-a19c-65e3a20d33e6"},{"version":"CommandV1","origId":3117922773650624,"guid":"16686324-1edf-4be7-84fe-1059a7dda640","subtype":"command","commandType":"auto","position":14.0,"command":"%scala\nval stringsDF = eventsDS.selectExpr(\"CAST(id AS INT)\", \"CAST(device AS STRING)\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">stringsDF: org.apache.spark.sql.DataFrame = [id: int, device: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Required attribute 'value' not found;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.kafka010.KafkaWriter$$anonfun$6.apply(KafkaWriter.scala:73)\n\tat org.apache.spark.sql.kafka010.KafkaWriter$$anonfun$6.apply(KafkaWriter.scala:73)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.sql.kafka010.KafkaWriter$.validateQuery(KafkaWriter.scala:72)\n\tat org.apache.spark.sql.kafka010.KafkaWriter$.write(KafkaWriter.scala:88)\n\tat org.apache.spark.sql.kafka010.KafkaSourceProvider.createRelation(KafkaSourceProvider.scala:175)\n\tat org.apache.spark.sql.execution.datasources.DataSource.write(DataSource.scala:488)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$save$1.apply$mcV$sp(DataFrameWriter.scala:217)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$save$1.apply(DataFrameWriter.scala:209)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$save$1.apply(DataFrameWriter.scala:209)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:209)</div>","workflows":[],"startTime":1501532059032,"submitTime":1501532059017,"finishTime":1501532059118,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2124c9cd-c90f-40dc-8fbe-9ba2a81e611c"},{"version":"CommandV1","origId":3117922773650625,"guid":"6a389d1d-1ce7-443b-ade3-d81cb5fc3f88","subtype":"command","commandType":"auto","position":15.0,"command":"%scala\nstringsDF.printSchema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- id: integer (nullable = false)\n |-- device: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532069218,"submitTime":1501532069203,"finishTime":1501532069293,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fe9b67b4-7276-4a8e-8307-4f117ba0d50f"},{"version":"CommandV1","origId":3117922773650626,"guid":"fac94b40-4318-4f32-9e30-39b08ee3cc07","subtype":"command","commandType":"auto","position":16.0,"command":"%scala\ndisplay(stringsDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"{\"device_id\": 0, \"device_type\": \"sensor-ipad\", \"ip\": \"68.161.225.1\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 25, \"signal\": 23, \"battery_level\": 8, \"c02_level\": 917, \"timestamp\" :1475600496 }"],[1,"{\"device_id\": 1, \"device_type\": \"sensor-igauge\", \"ip\": \"213.161.254.1\", \"cca3\": \"NOR\", \"cn\": \"Norway\", \"temp\": 30, \"signal\": 18, \"battery_level\": 6, \"c02_level\": 1413, \"timestamp\" :1475600498 }"],[2,"{\"device_id\": 2, \"device_type\": \"sensor-ipad\", \"ip\": \"88.36.5.1\", \"cca3\": \"ITA\", \"cn\": \"Italy\", \"temp\": 18, \"signal\": 25, \"battery_level\": 5, \"c02_level\": 1372, \"timestamp\" :1475600500 }"],[3,"{\"device_id\": 3, \"device_type\": \"sensor-inest\", \"ip\": \"66.39.173.154\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 47, \"signal\": 12, \"battery_level\": 1, \"c02_level\": 1447, \"timestamp\" :1475600502 }"],[4,"{\"device_id\": 4, \"device_type\": \"sensor-ipad\", \"ip\": \"203.82.41.9\", \"cca3\": \"PHL\", \"cn\": \"Philippines\", \"temp\": 29, \"signal\": 11, \"battery_level\": 0, \"c02_level\": 983, \"timestamp\" :1475600504 }"],[5,"{\"device_id\": 5, \"device_type\": \"sensor-istick\", \"ip\": \"204.116.105.67\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 50, \"signal\": 16, \"battery_level\": 8, \"c02_level\": 1574, \"timestamp\" :1475600506 }"],[6,"{\"device_id\": 6, \"device_type\": \"sensor-ipad\", \"ip\": \"220.173.179.1\", \"cca3\": \"CHN\", \"cn\": \"China\", \"temp\": 21, \"signal\": 18, \"battery_level\": 9, \"c02_level\": 1249, \"timestamp\" :1475600508 }"],[7,"{\"device_id\": 7, \"device_type\": \"sensor-ipad\", \"ip\": \"118.23.68.227\", \"cca3\": \"JPN\", \"cn\": \"Japan\", \"temp\": 27, \"signal\": 15, \"battery_level\": 0, \"c02_level\": 1531, \"timestamp\" :1475600512 }"],[8," {\"device_id\": 8, \"device_type\": \"sensor-inest\", \"ip\": \"208.109.163.218\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 40, \"signal\": 16, \"battery_level\": 9, \"c02_level\": 1208, \"timestamp\" :1475600514 }"],[9,"{\"device_id\": 9, \"device_type\": \"sensor-ipad\", \"ip\": \"88.213.191.34\", \"cca3\": \"ITA\", \"cn\": \"Italy\", \"temp\": 19, \"signal\": 11, \"battery_level\": 0, \"c02_level\": 1171, \"timestamp\" :1475600516 }"],[10,"{\"device_id\": 10, \"device_type\": \"sensor-igauge\", \"ip\": \"68.28.91.22\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 32, \"signal\": 26, \"battery_level\": 7, \"c02_level\": 886, \"timestamp\" :1475600518 }"],[11,"{\"device_id\": 11, \"device_type\": \"sensor-ipad\", \"ip\": \"59.144.114.250\", \"cca3\": \"IND\", \"cn\": \"India\", \"temp\": 46, \"signal\": 25, \"battery_level\": 4, \"c02_level\": 863, \"timestamp\" :1475600520 }"],[12,"{\"device_id\": 12, \"device_type\": \"sensor-igauge\", \"ip\": \"193.156.90.200\", \"cca3\": \"NOR\", \"cn\": \"Norway\", \"temp\": 18, \"signal\": 26, \"battery_level\": 8, \"c02_level\": 1220, \"timestamp\" :1475600522 }"],[13,"{\"device_id\": 13, \"device_type\": \"sensor-ipad\", \"ip\": \"67.185.72.1\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 34, \"signal\": 20, \"battery_level\": 8, \"c02_level\": 1504, \"timestamp\" :1475600524 }"],[14,"{\"device_id\": 14, \"device_type\": \"sensor-inest\", \"ip\": \"68.85.85.106\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 39, \"signal\": 17, \"battery_level\": 8, \"c02_level\": 831, \"timestamp\" :1475600526 }"],[15,"{\"device_id\": 15, \"device_type\": \"sensor-ipad\", \"ip\": \"161.188.212.254\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 27, \"signal\": 26, \"battery_level\": 5, \"c02_level\": 1378, \"timestamp\" :1475600528 }"],[16,"{\"device_id\": 16, \"device_type\": \"sensor-igauge\", \"ip\": \"221.3.128.242\", \"cca3\": \"CHN\", \"cn\": \"China\", \"temp\": 10, \"signal\": 24, \"battery_level\": 6, \"c02_level\": 1423, \"timestamp\" :1475600530 }"],[17,"{\"device_id\": 17, \"device_type\": \"sensor-ipad\", \"ip\": \"64.124.180.215\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 38, \"signal\": 17, \"battery_level\": 9, \"c02_level\": 1304, \"timestamp\" :1475600532 }"],[18,"{\"device_id\": 18, \"device_type\": \"sensor-igauge\", \"ip\": \"66.153.162.66\", \"cca3\": \"USA\", \"cn\": \"United States\", \"temp\": 26, \"signal\": 10, \"battery_level\": 0, \"c02_level\": 902, \"timestamp\" :1475600534 }"],[19,"{\"device_id\": 19, \"device_type\": \"sensor-ipad\", \"ip\": \"193.200.142.254\", \"cca3\": \"AUT\", \"cn\": \"Austria\", \"temp\": 32, \"signal\": 27, \"battery_level\": 5, \"c02_level\": 1282, \"timestamp\" :1475600536 }"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"integer\"","metadata":"{}"},{"name":"device","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532076088,"submitTime":1501532076073,"finishTime":1501532076177,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e9a7f9a6-3019-46bd-9efc-b2bf98a132e2"},{"version":"CommandV1","origId":3117922773650627,"guid":"521a8f27-2c3c-4d0f-8044-4b905969a19a","subtype":"command","commandType":"auto","position":17.0,"command":"%scala\ndisplay(devicesDF.selectExpr(\"c02_level\", \"round(c02_level/temp) as ratio_c02_temperature\").orderBy($\"ratio_c02_temperature\" desc))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1372,76.0],[1220,68.0],[1249,59.0],[1378,51.0],[1413,47.0],[1504,44.0],[1282,40.0],[917,37.0],[1304,34.0],[1574,31.0],[1208,30.0],[886,28.0],[831,21.0],[863,19.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c02_level","type":"\"long\"","metadata":"{}"},{"name":"ratio_c02_temperature","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532086398,"submitTime":1501532086382,"finishTime":1501532086655,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a99213e3-8a83-4d6c-a6a9-babeae4c4941"},{"version":"CommandV1","origId":3117922773650628,"guid":"ed81663e-eff8-4802-9706-b1fdbc6860f1","subtype":"command","commandType":"auto","position":18.0,"command":"%scala\ndevicesDF.createOrReplaceTempView(\"devicesDFT\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532093597,"submitTime":1501532093582,"finishTime":1501532093687,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a10933c-b9b6-4c0e-bd5e-35e06871ab16"},{"version":"CommandV1","origId":3117922773650629,"guid":"f7015170-0099-40d0-8429-58aa26aa83af","subtype":"command","commandType":"auto","position":19.0,"command":"%sql select c02_level, \n        round(c02_level/temp) as ratio_c02_temperature \n        from devicesDFT\n        order by ratio_c02_temperature desc\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1372,76.0],[1220,68.0],[1249,59.0],[1378,51.0],[1413,47.0],[1504,44.0],[1282,40.0],[917,37.0],[1304,34.0],[1574,31.0],[1208,30.0],[886,28.0],[831,21.0],[863,19.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"c02_level","type":"\"long\"","metadata":"{}"},{"name":"ratio_c02_temperature","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532102045,"submitTime":1501532102020,"finishTime":1501532102199,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f7a67879-5a38-45bf-927f-74ee58231f79"},{"version":"CommandV1","origId":3117922773650630,"guid":"bc8a175b-fa5d-4906-b668-a20b849d9d33","subtype":"command","commandType":"auto","position":20.0,"command":"%scala\nstringJsonDF\n  .write\n  .mode(\"overwrite\")\n  .format(\"parquet\")\n  .save(\"/tmp/jules\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532110843,"submitTime":1501532110827,"finishTime":1501532114752,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8e16c41a-3245-4c00-aeb6-425e0dc6d8d3"},{"version":"CommandV1","origId":3117922773650631,"guid":"96e5a631-37f5-4ed9-a417-269aedaf5f61","subtype":"command","commandType":"auto","position":21.0,"command":"%fs ls /tmp/jules","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/tmp/jules/_SUCCESS","_SUCCESS",0],["dbfs:/tmp/jules/_committed_5244698189400861715","_committed_5244698189400861715",760],["dbfs:/tmp/jules/_started_5244698189400861715","_started_5244698189400861715",0],["dbfs:/tmp/jules/part-00000-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet","part-00000-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet",1567],["dbfs:/tmp/jules/part-00001-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet","part-00001-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet",1598],["dbfs:/tmp/jules/part-00002-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet","part-00002-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet",1576],["dbfs:/tmp/jules/part-00003-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet","part-00003-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet",1602],["dbfs:/tmp/jules/part-00004-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet","part-00004-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet",1574],["dbfs:/tmp/jules/part-00005-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet","part-00005-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet",1618],["dbfs:/tmp/jules/part-00006-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet","part-00006-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet",1589],["dbfs:/tmp/jules/part-00007-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet","part-00007-tid-5244698189400861715-4652e213-7f8c-45a9-a4b3-50874a8f13cd-0-c000.gz.parquet",1624]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532118275,"submitTime":1501532118258,"finishTime":1501532118867,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"234bc9af-aecf-4ee4-ad54-2871d36eecc9"},{"version":"CommandV1","origId":3117922773650632,"guid":"344f0aac-2d98-457e-b12e-9a9e4775fbc6","subtype":"command","commandType":"auto","position":22.0,"command":"%scala\nval parquetDF = spark.read.parquet(\"/tmp/jules\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">parquetDF: org.apache.spark.sql.DataFrame = [devices: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532132004,"submitTime":1501532131982,"finishTime":1501532132771,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c201c68a-7161-497b-9572-44245decbfd6"},{"version":"CommandV1","origId":3117922773650633,"guid":"d07dfe45-3dc6-4a93-99dc-83531dfdd6c8","subtype":"command","commandType":"auto","position":23.0,"command":"%scala\nparquetDF.printSchema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- devices: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532139525,"submitTime":1501532139510,"finishTime":1501532139624,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c9abbe69-7b50-4774-a355-f62d5d237ed0"},{"version":"CommandV1","origId":3117922773650634,"guid":"9772e013-8f1b-4061-ae29-e32a2f2f86e1","subtype":"command","commandType":"auto","position":24.0,"command":"%scala\ndisplay(parquetDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["{\"id\":17,\"device\":\"{\\\"device_id\\\": 17, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"64.124.180.215\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 38, \\\"signal\\\": 17, \\\"battery_level\\\": 9, \\\"c02_level\\\": 1304, \\\"timestamp\\\" :1475600532 }\"}"],["{\"id\":18,\"device\":\"{\\\"device_id\\\": 18, \\\"device_type\\\": \\\"sensor-igauge\\\", \\\"ip\\\": \\\"66.153.162.66\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 26, \\\"signal\\\": 10, \\\"battery_level\\\": 0, \\\"c02_level\\\": 902, \\\"timestamp\\\" :1475600534 }\"}"],["{\"id\":19,\"device\":\"{\\\"device_id\\\": 19, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"193.200.142.254\\\", \\\"cca3\\\": \\\"AUT\\\", \\\"cn\\\": \\\"Austria\\\", \\\"temp\\\": 32, \\\"signal\\\": 27, \\\"battery_level\\\": 5, \\\"c02_level\\\": 1282, \\\"timestamp\\\" :1475600536 }\"}"],["{\"id\":12,\"device\":\"{\\\"device_id\\\": 12, \\\"device_type\\\": \\\"sensor-igauge\\\", \\\"ip\\\": \\\"193.156.90.200\\\", \\\"cca3\\\": \\\"NOR\\\", \\\"cn\\\": \\\"Norway\\\", \\\"temp\\\": 18, \\\"signal\\\": 26, \\\"battery_level\\\": 8, \\\"c02_level\\\": 1220, \\\"timestamp\\\" :1475600522 }\"}"],["{\"id\":13,\"device\":\"{\\\"device_id\\\": 13, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"67.185.72.1\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 34, \\\"signal\\\": 20, \\\"battery_level\\\": 8, \\\"c02_level\\\": 1504, \\\"timestamp\\\" :1475600524 }\"}"],["{\"id\":14,\"device\":\"{\\\"device_id\\\": 14, \\\"device_type\\\": \\\"sensor-inest\\\", \\\"ip\\\": \\\"68.85.85.106\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 39, \\\"signal\\\": 17, \\\"battery_level\\\": 8, \\\"c02_level\\\": 831, \\\"timestamp\\\" :1475600526 }\"}"],["{\"id\":7,\"device\":\"{\\\"device_id\\\": 7, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"118.23.68.227\\\", \\\"cca3\\\": \\\"JPN\\\", \\\"cn\\\": \\\"Japan\\\", \\\"temp\\\": 27, \\\"signal\\\": 15, \\\"battery_level\\\": 0, \\\"c02_level\\\": 1531, \\\"timestamp\\\" :1475600512 }\"}"],["{\"id\":8,\"device\":\" {\\\"device_id\\\": 8, \\\"device_type\\\": \\\"sensor-inest\\\", \\\"ip\\\": \\\"208.109.163.218\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 40, \\\"signal\\\": 16, \\\"battery_level\\\": 9, \\\"c02_level\\\": 1208, \\\"timestamp\\\" :1475600514 }\"}"],["{\"id\":9,\"device\":\"{\\\"device_id\\\": 9, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"88.213.191.34\\\", \\\"cca3\\\": \\\"ITA\\\", \\\"cn\\\": \\\"Italy\\\", \\\"temp\\\": 19, \\\"signal\\\": 11, \\\"battery_level\\\": 0, \\\"c02_level\\\": 1171, \\\"timestamp\\\" :1475600516 }\"}"],["{\"id\":2,\"device\":\"{\\\"device_id\\\": 2, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"88.36.5.1\\\", \\\"cca3\\\": \\\"ITA\\\", \\\"cn\\\": \\\"Italy\\\", \\\"temp\\\": 18, \\\"signal\\\": 25, \\\"battery_level\\\": 5, \\\"c02_level\\\": 1372, \\\"timestamp\\\" :1475600500 }\"}"],["{\"id\":3,\"device\":\"{\\\"device_id\\\": 3, \\\"device_type\\\": \\\"sensor-inest\\\", \\\"ip\\\": \\\"66.39.173.154\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 47, \\\"signal\\\": 12, \\\"battery_level\\\": 1, \\\"c02_level\\\": 1447, \\\"timestamp\\\" :1475600502 }\"}"],["{\"id\":4,\"device\":\"{\\\"device_id\\\": 4, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"203.82.41.9\\\", \\\"cca3\\\": \\\"PHL\\\", \\\"cn\\\": \\\"Philippines\\\", \\\"temp\\\": 29, \\\"signal\\\": 11, \\\"battery_level\\\": 0, \\\"c02_level\\\": 983, \\\"timestamp\\\" :1475600504 }\"}"],["{\"id\":15,\"device\":\"{\\\"device_id\\\": 15, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"161.188.212.254\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 27, \\\"signal\\\": 26, \\\"battery_level\\\": 5, \\\"c02_level\\\": 1378, \\\"timestamp\\\" :1475600528 }\"}"],["{\"id\":16,\"device\":\"{\\\"device_id\\\": 16, \\\"device_type\\\": \\\"sensor-igauge\\\", \\\"ip\\\": \\\"221.3.128.242\\\", \\\"cca3\\\": \\\"CHN\\\", \\\"cn\\\": \\\"China\\\", \\\"temp\\\": 10, \\\"signal\\\": 24, \\\"battery_level\\\": 6, \\\"c02_level\\\": 1423, \\\"timestamp\\\" :1475600530 }\"}"],["{\"id\":5,\"device\":\"{\\\"device_id\\\": 5, \\\"device_type\\\": \\\"sensor-istick\\\", \\\"ip\\\": \\\"204.116.105.67\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 50, \\\"signal\\\": 16, \\\"battery_level\\\": 8, \\\"c02_level\\\": 1574, \\\"timestamp\\\" :1475600506 }\"}"],["{\"id\":6,\"device\":\"{\\\"device_id\\\": 6, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"220.173.179.1\\\", \\\"cca3\\\": \\\"CHN\\\", \\\"cn\\\": \\\"China\\\", \\\"temp\\\": 21, \\\"signal\\\": 18, \\\"battery_level\\\": 9, \\\"c02_level\\\": 1249, \\\"timestamp\\\" :1475600508 }\"}"],["{\"id\":10,\"device\":\"{\\\"device_id\\\": 10, \\\"device_type\\\": \\\"sensor-igauge\\\", \\\"ip\\\": \\\"68.28.91.22\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 32, \\\"signal\\\": 26, \\\"battery_level\\\": 7, \\\"c02_level\\\": 886, \\\"timestamp\\\" :1475600518 }\"}"],["{\"id\":11,\"device\":\"{\\\"device_id\\\": 11, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"59.144.114.250\\\", \\\"cca3\\\": \\\"IND\\\", \\\"cn\\\": \\\"India\\\", \\\"temp\\\": 46, \\\"signal\\\": 25, \\\"battery_level\\\": 4, \\\"c02_level\\\": 863, \\\"timestamp\\\" :1475600520 }\"}"],["{\"id\":0,\"device\":\"{\\\"device_id\\\": 0, \\\"device_type\\\": \\\"sensor-ipad\\\", \\\"ip\\\": \\\"68.161.225.1\\\", \\\"cca3\\\": \\\"USA\\\", \\\"cn\\\": \\\"United States\\\", \\\"temp\\\": 25, \\\"signal\\\": 23, \\\"battery_level\\\": 8, \\\"c02_level\\\": 917, \\\"timestamp\\\" :1475600496 }\"}"],["{\"id\":1,\"device\":\"{\\\"device_id\\\": 1, \\\"device_type\\\": \\\"sensor-igauge\\\", \\\"ip\\\": \\\"213.161.254.1\\\", \\\"cca3\\\": \\\"NOR\\\", \\\"cn\\\": \\\"Norway\\\", \\\"temp\\\": 30, \\\"signal\\\": 18, \\\"battery_level\\\": 6, \\\"c02_level\\\": 1413, \\\"timestamp\\\" :1475600498 }\"}"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"devices","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532146207,"submitTime":1501532146190,"finishTime":1501532147197,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"50a3d291-af81-4210-a709-e6e7515627f5"},{"version":"CommandV1","origId":3117922773650635,"guid":"b0abb7f7-b2a5-484a-8bdf-e1624ca1688c","subtype":"command","commandType":"auto","position":25.0,"command":"%scala\nimport org.apache.spark.sql.types._\n\nval schema = new StructType()\n  .add(\"dc_id\", StringType)                               // data center where data was posted to Kafka cluster\n  .add(\"source\",                                          // info about the source of alarm\n    MapType(                                              // define this as a Map(Key->value)\n      StringType,\n      new StructType()\n      .add(\"description\", StringType)\n      .add(\"ip\", StringType)\n      .add(\"id\", LongType)\n      .add(\"temp\", LongType)\n      .add(\"c02_level\", LongType)\n      .add(\"geo\", \n         new StructType()\n          .add(\"lat\", DoubleType)\n          .add(\"long\", DoubleType)\n        )\n      )\n    )","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.types._\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(dc_id,StringType,true), StructField(source,MapType(StringType,StructType(StructField(description,StringType,true), StructField(ip,StringType,true), StructField(id,LongType,true), StructField(temp,LongType,true), StructField(c02_level,LongType,true), StructField(geo,StructType(StructField(lat,DoubleType,true), StructField(long,DoubleType,true)),true)),true),true))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532158536,"submitTime":1501532158520,"finishTime":1501532158628,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a01f7f3f-d483-4443-bb57-906d12ed7aa9"},{"version":"CommandV1","origId":3117922773650636,"guid":"891787c8-0b8c-49b7-bb59-8313ead6f95d","subtype":"command","commandType":"auto","position":26.0,"command":"%scala\nval dataDS = Seq(\"\"\"\n{\n\"dc_id\": \"dc-101\",\n\"source\": {\n    \"sensor-igauge\": {\n      \"id\": 10,\n      \"ip\": \"68.28.91.22\",\n      \"description\": \"Sensor attached to the container ceilings\",\n      \"temp\":35,\n      \"c02_level\": 1475,\n      \"geo\": {\"lat\":38.00, \"long\":97.00}                        \n    },\n    \"sensor-ipad\": {\n      \"id\": 13,\n      \"ip\": \"67.185.72.1\",\n      \"description\": \"Sensor ipad attached to carbon cylinders\",\n      \"temp\": 34,\n      \"c02_level\": 1370,\n      \"geo\": {\"lat\":47.41, \"long\":-122.00}\n    },\n    \"sensor-inest\": {\n      \"id\": 8,\n      \"ip\": \"208.109.163.218\",\n      \"description\": \"Sensor attached to the factory ceilings\",\n      \"temp\": 40,\n      \"c02_level\": 1346,\n      \"geo\": {\"lat\":33.61, \"long\":-111.89}\n    },\n    \"sensor-istick\": {\n      \"id\": 5,\n      \"ip\": \"204.116.105.67\",\n      \"description\": \"Sensor embedded in exhaust pipes in the ceilings\",\n      \"temp\": 40,\n      \"c02_level\": 1574,\n      \"geo\": {\"lat\":35.93, \"long\":-85.46}\n    }\n  }\n}\"\"\").toDS()\n// should only be one item\ndataDS.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">dataDS: org.apache.spark.sql.Dataset[String] = [value: string]\nres17: Long = 1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532169003,"submitTime":1501532168986,"finishTime":1501532169545,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"08bff15e-f601-4a35-af54-350bb17586e0"},{"version":"CommandV1","origId":3117922773650637,"guid":"3f2ad322-6f85-4146-aa4f-4665b40f3b8e","subtype":"command","commandType":"auto","position":27.0,"command":"%scala\ndisplay(dataDS)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["\n{\n\"dc_id\": \"dc-101\",\n\"source\": {\n    \"sensor-igauge\": {\n      \"id\": 10,\n      \"ip\": \"68.28.91.22\",\n      \"description\": \"Sensor attached to the container ceilings\",\n      \"temp\":35,\n      \"c02_level\": 1475,\n      \"geo\": {\"lat\":38.00, \"long\":97.00}                        \n    },\n    \"sensor-ipad\": {\n      \"id\": 13,\n      \"ip\": \"67.185.72.1\",\n      \"description\": \"Sensor ipad attached to carbon cylinders\",\n      \"temp\": 34,\n      \"c02_level\": 1370,\n      \"geo\": {\"lat\":47.41, \"long\":-122.00}\n    },\n    \"sensor-inest\": {\n      \"id\": 8,\n      \"ip\": \"208.109.163.218\",\n      \"description\": \"Sensor attached to the factory ceilings\",\n      \"temp\": 40,\n      \"c02_level\": 1346,\n      \"geo\": {\"lat\":33.61, \"long\":-111.89}\n    },\n    \"sensor-istick\": {\n      \"id\": 5,\n      \"ip\": \"204.116.105.67\",\n      \"description\": \"Sensor embedded in exhaust pipes in the ceilings\",\n      \"temp\": 40,\n      \"c02_level\": 1574,\n      \"geo\": {\"lat\":35.93, \"long\":-85.46}\n    }\n  }\n}"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"value","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532176309,"submitTime":1501532176292,"finishTime":1501532176396,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a4327a4a-a388-4306-859b-0d98e1899321"},{"version":"CommandV1","origId":3117922773650638,"guid":"3af602dc-e766-40a7-a2c2-3f1c9be93480","subtype":"command","commandType":"auto","position":28.0,"command":"%scala\nval df = spark                  // spark session \n.read                           // get DataFrameReader\n.schema(schema)                 // use the defined schema above and read format as JSON\n.json(dataDS.rdd)               // RDD[String]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [dc_id: string, source: map&lt;string,struct&lt;description:string,ip:string,id:bigint,temp:bigint,c02_level:bigint,geo:struct&lt;lat:double,long:double&gt;&gt;&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532186862,"submitTime":1501532186845,"finishTime":1501532186988,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8e5a744b-9897-4ea0-805d-ad7ede3dfcf0"},{"version":"CommandV1","origId":3117922773650639,"guid":"bba9e613-7509-4c48-a00c-d8f8b7dcdfb9","subtype":"command","commandType":"auto","position":29.0,"command":"%scala\ndf.printSchema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- dc_id: string (nullable = true)\n |-- source: map (nullable = true)\n |    |-- key: string\n |    |-- value: struct (valueContainsNull = true)\n |    |    |-- description: string (nullable = true)\n |    |    |-- ip: string (nullable = true)\n |    |    |-- id: long (nullable = true)\n |    |    |-- temp: long (nullable = true)\n |    |    |-- c02_level: long (nullable = true)\n |    |    |-- geo: struct (nullable = true)\n |    |    |    |-- lat: double (nullable = true)\n |    |    |    |-- long: double (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532193352,"submitTime":1501532193335,"finishTime":1501532193430,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e7bedaa8-1830-49b7-aaa7-456f8afb1d93"},{"version":"CommandV1","origId":3117922773650640,"guid":"db6b6b14-786f-4da9-a570-d35210cbbe7b","subtype":"command","commandType":"auto","position":30.0,"command":"%scala\ndisplay(df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101",{"sensor-igauge":{"schema":[{"nullable":true,"name":"description","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"ip","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"temp","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"c02_level","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"geo","comment":null,"metadata":{"map":{}},"dataType":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}]}],"values":["Sensor attached to the container ceilings","68.28.91.22",10,35,1475,{"schema":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":[38.0,97.0]}]},"sensor-ipad":{"schema":[{"nullable":true,"name":"description","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"ip","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"temp","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"c02_level","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"geo","comment":null,"metadata":{"map":{}},"dataType":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}]}],"values":["Sensor ipad attached to carbon cylinders","67.185.72.1",13,34,1370,{"schema":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":[47.41,-122.0]}]},"sensor-inest":{"schema":[{"nullable":true,"name":"description","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"ip","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"temp","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"c02_level","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"geo","comment":null,"metadata":{"map":{}},"dataType":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}]}],"values":["Sensor attached to the factory ceilings","208.109.163.218",8,40,1346,{"schema":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":[33.61,-111.89]}]},"sensor-istick":{"schema":[{"nullable":true,"name":"description","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"ip","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"temp","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"c02_level","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"geo","comment":null,"metadata":{"map":{}},"dataType":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}]}],"values":["Sensor embedded in exhaust pipes in the ceilings","204.116.105.67",5,40,1574,{"schema":[{"nullable":true,"name":"lat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"long","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":[35.93,-85.46]}]}}]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"source","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"description\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"ip\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"id\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"temp\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"c02_level\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"geo\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"lat\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"long\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}}]},\"valueContainsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532200741,"submitTime":1501532200724,"finishTime":1501532200979,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4deeaf7f-1ea7-4692-9605-8a8611e34a1d"},{"version":"CommandV1","origId":3117922773650641,"guid":"4a23be16-8661-447f-b247-239fd5ffbf5f","subtype":"command","commandType":"auto","position":31.0,"command":"%scala\nval explodedDF = df.select($\"dc_id\", explode($\"source\"))\ndisplay(explodedDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101","sensor-igauge",["Sensor attached to the container ceilings","68.28.91.22",10,35,1475,[38.0,97.0]]],["dc-101","sensor-ipad",["Sensor ipad attached to carbon cylinders","67.185.72.1",13,34,1370,[47.41,-122.0]]],["dc-101","sensor-inest",["Sensor attached to the factory ceilings","208.109.163.218",8,40,1346,[33.61,-111.89]]],["dc-101","sensor-istick",["Sensor embedded in exhaust pipes in the ceilings","204.116.105.67",5,40,1574,[35.93,-85.46]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dc_id","type":"\"string\"","metadata":"{}"},{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"value","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"description\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"ip\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"id\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"temp\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"c02_level\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"geo\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"lat\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"long\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532209763,"submitTime":1501532209746,"finishTime":1501532209970,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dfb1946c-0a18-45fc-b0b7-d1e63ea3594f"},{"version":"CommandV1","origId":3117922773650642,"guid":"61ac6b85-efda-4800-9206-ed815cec9a95","subtype":"command","commandType":"auto","position":32.0,"command":"%scala\nexplodedDF.printSchema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- dc_id: string (nullable = true)\n |-- key: string (nullable = false)\n |-- value: struct (nullable = true)\n |    |-- description: string (nullable = true)\n |    |-- ip: string (nullable = true)\n |    |-- id: long (nullable = true)\n |    |-- temp: long (nullable = true)\n |    |-- c02_level: long (nullable = true)\n |    |-- geo: struct (nullable = true)\n |    |    |-- lat: double (nullable = true)\n |    |    |-- long: double (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532217850,"submitTime":1501532217832,"finishTime":1501532217929,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d25ba578-38cd-4973-9ffb-7c1ea7974ea5"},{"version":"CommandV1","origId":3117922773650643,"guid":"6250e779-a827-491c-b4c9-272f7e5c175c","subtype":"command","commandType":"auto","position":33.0,"command":"%scala\ncase class DeviceAlert(dcId: String, deviceType:String, ip:String, deviceId:Long, temp:Long, c02_level: Long, lat: Double, lon: Double)\n//access all values using getItem() method on value, by providing the \"key,\" which is attribute in our JSON object.\nval notifydevicesDS = explodedDF.select( $\"dc_id\" as \"dcId\",\n                        $\"key\" as \"deviceType\",\n                        'value.getItem(\"ip\") as 'ip,\n                        'value.getItem(\"id\") as 'deviceId,\n                        'value.getItem(\"c02_level\") as 'c02_level,\n                        'value.getItem(\"temp\") as 'temp,\n                        'value.getItem(\"geo\").getItem(\"lat\") as 'lat,                //note embedded level requires yet another level of fetching.\n                        'value.getItem(\"geo\").getItem(\"long\") as 'lon)\n                        .as[DeviceAlert]  // return as a Dataset","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class DeviceAlert\nnotifydevicesDS: org.apache.spark.sql.Dataset[DeviceAlert] = [dcId: string, deviceType: string ... 6 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532227821,"submitTime":1501532227803,"finishTime":1501532228164,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"08f7b4a9-dbeb-423f-880a-76e61fe34521"},{"version":"CommandV1","origId":3117922773650644,"guid":"2deab4dc-baae-4f12-a4a0-5a9c32d6fca9","subtype":"command","commandType":"auto","position":34.0,"command":"%scala\nnotifydevicesDS.printSchema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- dcId: string (nullable = true)\n |-- deviceType: string (nullable = false)\n |-- ip: string (nullable = true)\n |-- deviceId: long (nullable = true)\n |-- c02_level: long (nullable = true)\n |-- temp: long (nullable = true)\n |-- lat: double (nullable = true)\n |-- lon: double (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-4-1eba3af99425&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    5scala</span>\n<span class=\"ansigrey\">         ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1501532239243,"submitTime":1501532239226,"finishTime":1501532239324,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"72144bbb-044d-4ea0-887d-038cb7a6bf1e"},{"version":"CommandV1","origId":3117922773650645,"guid":"28b89546-7598-413d-bacb-2d9810c5ba76","subtype":"command","commandType":"auto","position":35.0,"command":"%scala\ndisplay(notifydevicesDS)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dc-101","sensor-igauge","68.28.91.22",10,1475,35,38.0,97.0],["dc-101","sensor-ipad","67.185.72.1",13,1370,34,47.41,-122.0],["dc-101","sensor-inest","208.109.163.218",8,1346,40,33.61,-111.89],["dc-101","sensor-istick","204.116.105.67",5,1574,40,35.93,-85.46]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dcId","type":"\"string\"","metadata":"{}"},{"name":"deviceType","type":"\"string\"","metadata":"{}"},{"name":"ip","type":"\"string\"","metadata":"{}"},{"name":"deviceId","type":"\"long\"","metadata":"{}"},{"name":"c02_level","type":"\"long\"","metadata":"{}"},{"name":"temp","type":"\"long\"","metadata":"{}"},{"name":"lat","type":"\"double\"","metadata":"{}"},{"name":"lon","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532246883,"submitTime":1501532246865,"finishTime":1501532247044,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"859.76666","height":"219.76666","xColumns":["ip"],"yColumns":["lon"],"pivotColumns":["deviceType"],"pivotAggregation":"sum","customPlotOptions":{"pieChart":[{"key":"donut","value":true}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"516badcb-f66e-449f-9157-f7d98c20f53a"},{"version":"CommandV1","origId":3117922773650646,"guid":"e6c89a95-bef3-49e4-b889-e94e7bdba6d1","subtype":"command","commandType":"auto","position":36.0,"command":"%scala\n// define a Scala Notification Object\nobject DeviceNOCAlerts {\n\n  def sendTwilio(message: String): Unit = {\n    //TODO: fill as necessary\n    println(\"Twilio:\" + message)\n  }\n\n  def sendSNMP(message: String): Unit = {\n    //TODO: fill as necessary\n    println(\"SNMP:\" + message)\n  }\n  \n  def sendKafka(message: String): Unit = {\n    //TODO: fill as necessary\n     println(\"KAFKA:\" + message)\n  }\n}\ndef logAlerts(log: java.io.PrintStream = Console.out, deviceAlert: DeviceAlert, alert: String, notify: String =\"twilio\"): Unit = {\nval message = \"[***ALERT***: %s; data_center: %s, device_name: %s, temperature: %d; device_id: %d ; ip: %s ; c02: %d]\" format(alert, deviceAlert.dcId, deviceAlert.deviceType,deviceAlert.temp, deviceAlert.deviceId, deviceAlert.ip, deviceAlert.c02_level)                                                                                                                                                                                                                                                            \n  //default log to Stderr/Stdout\n  log.println(message)\n  // use an appropriate notification method\n  val notifyFunc = notify match {\n      case \"twilio\" => DeviceNOCAlerts.sendTwilio _\n      case \"snmp\" => DeviceNOCAlerts.sendSNMP _\n      case \"kafka\" => DeviceNOCAlerts.sendKafka _\n  }\n  //send the appropriate alert\n  notifyFunc(message)\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined module DeviceNOCAlerts\nlogAlerts: (log: java.io.PrintStream, deviceAlert: DeviceAlert, alert: String, notify: String)Unit\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532371009,"submitTime":1501532370997,"finishTime":1501532371285,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"30c2f233-f3ca-4c00-a096-5324a59d9c89"},{"version":"CommandV1","origId":3117922773650647,"guid":"ca78bf0e-1d77-4560-bfa4-8e9c16bd459f","subtype":"command","commandType":"auto","position":37.0,"command":"%scala\nnotifydevicesDS.foreach(d => logAlerts(Console.err, d, \"ACTION NEED! HIGH TEPERATURE AND C02 LEVLES\", \"kafka\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532386696,"submitTime":1501532386678,"finishTime":1501532387113,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a3b17f3f-7c68-42eb-b193-3b39eaa5238f"},{"version":"CommandV1","origId":3117922773650648,"guid":"ad54a7a7-17ad-45f2-9392-38f4c4bb519b","subtype":"command","commandType":"auto","position":38.0,"command":"%scala\nimport org.apache.spark.sql.types._\n\n// a bit longish, nested, and convuloted JSON schema :)\nval nestSchema2 = new StructType()\n      .add(\"devices\", \n        new StructType()\n          .add(\"thermostats\", MapType(StringType,\n            new StructType()\n              .add(\"device_id\", StringType)\n              .add(\"locale\", StringType)\n              .add(\"software_version\", StringType)\n              .add(\"structure_id\", StringType)\n              .add(\"where_name\", StringType)\n              .add(\"last_connection\", StringType)\n              .add(\"is_online\", BooleanType)\n              .add(\"can_cool\", BooleanType)\n              .add(\"can_heat\", BooleanType)\n              .add(\"is_using_emergency_heat\", BooleanType)\n              .add(\"has_fan\", BooleanType)\n              .add(\"fan_timer_active\", BooleanType)\n              .add(\"fan_timer_timeout\", StringType)\n              .add(\"temperature_scale\", StringType)\n              .add(\"target_temperature_f\", DoubleType)\n              .add(\"target_temperature_high_f\", DoubleType)\n              .add(\"target_temperature_low_f\", DoubleType)\n              .add(\"eco_temperature_high_f\", DoubleType)\n              .add(\"eco_temperature_low_f\", DoubleType)\n              .add(\"away_temperature_high_f\", DoubleType)\n              .add(\"away_temperature_low_f\", DoubleType)\n              .add(\"hvac_mode\", StringType)\n              .add(\"humidity\", LongType)\n              .add(\"hvac_state\", StringType)\n              .add(\"is_locked\", StringType)\n              .add(\"locked_temp_min_f\", DoubleType)\n              .add(\"locked_temp_max_f\", DoubleType)))\n           .add(\"smoke_co_alarms\", MapType(StringType,\n             new StructType()\n             .add(\"device_id\", StringType)\n             .add(\"locale\", StringType)\n             .add(\"software_version\", StringType)\n             .add(\"structure_id\", StringType)\n             .add(\"where_name\", StringType)\n             .add(\"last_connection\", StringType)\n             .add(\"is_online\", BooleanType)\n             .add(\"battery_health\", StringType)\n             .add(\"co_alarm_state\", StringType)\n             .add(\"smoke_alarm_state\", StringType)\n             .add(\"is_manual_test_active\", BooleanType)\n             .add(\"last_manual_test_time\", StringType)\n             .add(\"ui_color_state\", StringType)))\n           .add(\"cameras\", MapType(StringType, \n               new StructType()\n                .add(\"device_id\", StringType)\n                .add(\"software_version\", StringType)\n                .add(\"structure_id\", StringType)\n                .add(\"where_name\", StringType)\n                .add(\"is_online\", BooleanType)\n                .add(\"is_streaming\", BooleanType)\n                .add(\"is_audio_input_enabled\", BooleanType)\n                .add(\"last_is_online_change\", StringType)\n                .add(\"is_video_history_enabled\", BooleanType)\n                .add(\"web_url\", StringType)\n                .add(\"app_url\", StringType)\n                .add(\"is_public_share_enabled\", BooleanType)\n                .add(\"activity_zones\",\n                  new StructType()\n                    .add(\"name\", StringType)\n                    .add(\"id\", LongType))\n                .add(\"last_event\", StringType))))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.types._\nnestSchema2: org.apache.spark.sql.types.StructType = StructType(StructField(devices,StructType(StructField(thermostats,MapType(StringType,StructType(StructField(device_id,StringType,true), StructField(locale,StringType,true), StructField(software_version,StringType,true), StructField(structure_id,StringType,true), StructField(where_name,StringType,true), StructField(last_connection,StringType,true), StructField(is_online,BooleanType,true), StructField(can_cool,BooleanType,true), StructField(can_heat,BooleanType,true), StructField(is_using_emergency_heat,BooleanType,true), StructField(has_fan,BooleanType,true), StructField(fan_timer_active,BooleanType,true), StructField(fan_timer_timeout,StringType,true), StructField(temperature_scale,StringType,true), StructField(target_temperature_f,DoubleType,true), StructField(target_temperature_high_f,DoubleType,true), StructField(target_temperature_low_f,DoubleType,true), StructField(eco_temperature_high_f,DoubleType,true), StructField(eco_temperature_low_f,DoubleType,true), StructField(away_temperature_high_f,DoubleType,true), StructField(away_temperature_low_f,DoubleType,true), StructField(hvac_mode,StringType,true), StructField(humidity,LongType,true), StructField(hvac_state,StringType,true), StructField(is_locked,StringType,true), StructField(locked_temp_min_f,DoubleType,true), StructField(locked_temp_max_f,DoubleType,true)),true),true), StructField(smoke_co_alarms,MapType(StringType,StructType(StructField(device_id,StringType,true), StructField(locale,StringType,true), StructField(software_version,StringType,true), StructField(structure_id,StringType,true), StructField(where_name,StringType,true), StructField(last_connection,StringType,true), StructField(is_online,BooleanType,true), StructField(battery_health,StringType,true), StructField(co_alarm_state,StringType,true), StructField(smoke_alarm_state,StringType,true), StructField(is_manual_test_active,BooleanType,true), StructField(last_manual_test_time,StringType,true), StructField(ui_color_state,StringType,true)),true),true), StructField(cameras,MapType(StringType,StructType(StructField(device_id,StringType,true), StructField(software_version,StringType,true), StructField(structure_id,StringType,true), StructField(where_name,StringType,true), StructField(is_online,BooleanType,true), StructField(is_streaming,BooleanType,true), StructField(is_audio_input_enabled,BooleanType,true), StructField(last_is_online_change,StringType,true), StructField(is_video_history_enabled,BooleanType,true), StructField(web_url,StringType,true), StructField(app_url,StringType,true), StructField(is_public_share_enabled,BooleanType,true), StructField(activity_zones,StructType(StructField(name,StringType,true), StructField(id,LongType,true)),true), StructField(last_event,StringType,true)),true),true)),true))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Undefined function: 'to_json'. This function is neither a registered temporary function nor a permanent function registered in the database 'default'.; line 1 pos 0","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.catalyst.catalog.SessionCatalog.failFunctionLookup(SessionCatalog.scala:999)\n\tat org.apache.spark.sql.hive.HiveSessionCatalog.lookupFunction0(HiveSessionCatalog.scala:202)\n\tat org.apache.spark.sql.hive.HiveSessionCatalog.lookupFunction(HiveSessionCatalog.scala:174)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions$$anonfun$apply$13$$anonfun$applyOrElse$5$$anonfun$applyOrElse$38.apply(Analyzer.scala:892)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions$$anonfun$apply$13$$anonfun$applyOrElse$5$$anonfun$applyOrElse$38.apply(Analyzer.scala:892)\n\tat org.apache.spark.sql.catalyst.analysis.package$.withPosition(package.scala:48)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions$$anonfun$apply$13$$anonfun$applyOrElse$5.applyOrElse(Analyzer.scala:891)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions$$anonfun$apply$13$$anonfun$applyOrElse$5.applyOrElse(Analyzer.scala:879)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$2.apply(TreeNode.scala:268)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$2.apply(TreeNode.scala:268)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:267)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformDown$1.apply(TreeNode.scala:273)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformDown$1.apply(TreeNode.scala:273)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:273)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$transformExpressionsDown$1.apply(QueryPlan.scala:245)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$transformExpressionsDown$1.apply(QueryPlan.scala:245)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpression$1(QueryPlan.scala:266)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:276)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1$1.apply(QueryPlan.scala:280)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:280)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$6.apply(QueryPlan.scala:285)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.mapExpressions(QueryPlan.scala:285)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionsDown(QueryPlan.scala:245)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressions(QueryPlan.scala:236)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions$$anonfun$apply$13.applyOrElse(Analyzer.scala:879)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions$$anonfun$apply$13.applyOrElse(Analyzer.scala:877)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:60)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions$.apply(Analyzer.scala:877)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions$.apply(Analyzer.scala:876)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:85)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:82)\n\tat scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:111)\n\tat scala.collection.immutable.List.foldLeft(List.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:82)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:74)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:74)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:60)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:77)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:75)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply$mcV$sp(QueryExecution.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$withPlan(Dataset.scala:2826)\n\tat org.apache.spark.sql.Dataset.select(Dataset.scala:1136)\n\tat org.apache.spark.sql.Dataset.selectExpr(Dataset.scala:1171)</div>","workflows":[],"startTime":1501532414769,"submitTime":1501532414748,"finishTime":1501532414936,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"165d134e-d770-4ccf-8c1f-84ca4a78ed3d"},{"version":"CommandV1","origId":3117922773650649,"guid":"535168da-8f84-4c79-afde-8a6400986f9b","subtype":"command","commandType":"auto","position":39.0,"command":"%scala\nval nestDataDS2 = Seq(\"\"\"{\n    \"devices\": {\n       \"thermostats\": {\n          \"peyiJNo0IldT2YlIVtYaGQ\": {\n            \"device_id\": \"peyiJNo0IldT2YlIVtYaGQ\",\n            \"locale\": \"en-US\",\n            \"software_version\": \"4.0\",\n            \"structure_id\": \"VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\",\n            \"where_name\": \"Hallway Upstairs\",\n            \"last_connection\": \"2016-10-31T23:59:59.000Z\",\n            \"is_online\": true,\n            \"can_cool\": true,\n            \"can_heat\": true,\n            \"is_using_emergency_heat\": true,\n            \"has_fan\": true,\n            \"fan_timer_active\": true,\n            \"fan_timer_timeout\": \"2016-10-31T23:59:59.000Z\",\n            \"temperature_scale\": \"F\",\n            \"target_temperature_f\": 72,\n            \"target_temperature_high_f\": 80,\n            \"target_temperature_low_f\": 65,\n            \"eco_temperature_high_f\": 80,\n            \"eco_temperature_low_f\": 65,\n            \"away_temperature_high_f\": 80,\n            \"away_temperature_low_f\": 65,\n            \"hvac_mode\": \"heat\",\n            \"humidity\": 40,\n            \"hvac_state\": \"heating\",\n            \"is_locked\": true,\n            \"locked_temp_min_f\": 65,\n            \"locked_temp_max_f\": 80\n            }\n          },\n          \"smoke_co_alarms\": {\n            \"RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs\": {\n              \"device_id\": \"RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs\",\n              \"locale\": \"en-US\",\n              \"software_version\": \"1.01\",\n              \"structure_id\": \"VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\",\n              \"where_name\": \"Jane's Room\",\n              \"last_connection\": \"2016-10-31T23:59:59.000Z\",\n              \"is_online\": true,\n              \"battery_health\": \"ok\",\n              \"co_alarm_state\": \"ok\",\n              \"smoke_alarm_state\": \"ok\",\n              \"is_manual_test_active\": true,\n              \"last_manual_test_time\": \"2016-10-31T23:59:59.000Z\",\n              \"ui_color_state\": \"gray\"\n              }\n            },\n         \"cameras\": {\n          \"awJo6rH0IldT2YlIVtYaGQ\": {\n            \"device_id\": \"awJo6rH\",\n            \"software_version\": \"4.0\",\n            \"structure_id\": \"VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\",\n            \"where_name\": \"Foyer\",\n            \"is_online\": true,\n            \"is_streaming\": true,\n            \"is_audio_input_enabled\": true,\n            \"last_is_online_change\": \"2016-12-29T18:42:00.000Z\",\n            \"is_video_history_enabled\": true,\n            \"web_url\": \"https://home.nest.com/cameras/device_id?auth=access_token\",\n            \"app_url\": \"nestmobile://cameras/device_id?auth=access_token\",\n            \"is_public_share_enabled\": true,\n            \"activity_zones\": { \"name\": \"Walkway\", \"id\": 244083 },\n            \"last_event\": \"2016-10-31T23:59:59.000Z\"\n            }\n          }\n        }\n       }\"\"\").toDS","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">nestDataDS2: org.apache.spark.sql.Dataset[String] = [value: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532428444,"submitTime":1501532428424,"finishTime":1501532428695,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"10c4a8f7-d203-42fa-8c6b-3b82c7597cdd"},{"version":"CommandV1","origId":3117922773650650,"guid":"520b4a64-24f1-4fe4-a3d1-6cb676001049","subtype":"command","commandType":"auto","position":40.0,"command":"%scala\nval nestDF2 = spark                            // spark session \n            .read                             //  get DataFrameReader\n            .schema(nestSchema2)             //  use the defined schema above and read format as JSON\n            .json(nestDataDS2.rdd)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">nestDF2: org.apache.spark.sql.DataFrame = [devices: struct&lt;thermostats: map&lt;string,struct&lt;device_id:string,locale:string,software_version:string,structure_id:string,where_name:string,last_connection:string,is_online:boolean,can_cool:boolean,can_heat:boolean,is_using_emergency_heat:boolean,has_fan:boolean,fan_timer_active:boolean,fan_timer_timeout:string,temperature_scale:string,target_temperature_f:double,target_temperature_high_f:double,target_temperature_low_f:double,eco_temperature_high_f:double,eco_temperature_low_f:double,away_temperature_high_f:double,away_temperature_low_f:double,hvac_mode:string,humidity:bigint,hvac_state:string,... 3 more fields&gt;&gt;, smoke_co_alarms: map&lt;string,struct&lt;device_id:string,locale:string,software_version:string,structure_id:string,where_name:string,last_connection:string,is_online:boolean,battery_health:string,co_alarm_state:string,smoke_alarm_state:string,is_manual_test_active:boolean,last_manual_test_time:string,ui_color_state:string&gt;&gt; ... 1 more field&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532437366,"submitTime":1501532437347,"finishTime":1501532437527,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5d27bb82-92c3-44dc-a905-d89b18f19e2d"},{"version":"CommandV1","origId":3117922773650651,"guid":"34b80639-04f8-45a0-bcb0-5f2c611959fa","subtype":"command","commandType":"auto","position":41.0,"command":"%scala\ndisplay(nestDF2)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[{"peyiJNo0IldT2YlIVtYaGQ":{"schema":[{"nullable":true,"name":"device_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"locale","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"software_version","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"structure_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"where_name","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"last_connection","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_online","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"can_cool","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"can_heat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_using_emergency_heat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"has_fan","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"fan_timer_active","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"fan_timer_timeout","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"temperature_scale","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"target_temperature_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"target_temperature_high_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"target_temperature_low_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"eco_temperature_high_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"eco_temperature_low_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"away_temperature_high_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"away_temperature_low_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"hvac_mode","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"humidity","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"hvac_state","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_locked","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"locked_temp_min_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"locked_temp_max_f","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":["peyiJNo0IldT2YlIVtYaGQ","en-US","4.0","VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw","Hallway Upstairs","2016-10-31T23:59:59.000Z",true,true,true,true,true,true,"2016-10-31T23:59:59.000Z","F",72.0,80.0,65.0,80.0,65.0,80.0,65.0,"heat",40,"heating","true",65.0,80.0]}},{"RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs":{"schema":[{"nullable":true,"name":"device_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"locale","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"software_version","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"structure_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"where_name","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"last_connection","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_online","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"battery_health","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"co_alarm_state","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"smoke_alarm_state","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_manual_test_active","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"last_manual_test_time","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"ui_color_state","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":["RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs","en-US","1.01","VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw","Jane's Room","2016-10-31T23:59:59.000Z",true,"ok","ok","ok",true,"2016-10-31T23:59:59.000Z","gray"]}},{"awJo6rH0IldT2YlIVtYaGQ":{"schema":[{"nullable":true,"name":"device_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"software_version","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"structure_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"where_name","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_online","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_streaming","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_audio_input_enabled","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"last_is_online_change","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_video_history_enabled","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"web_url","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"app_url","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_public_share_enabled","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"activity_zones","comment":null,"metadata":{"map":{}},"dataType":[{"nullable":true,"name":"name","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}}]},{"nullable":true,"name":"last_event","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":["awJo6rH","4.0","VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw","Foyer",true,true,true,"2016-12-29T18:42:00.000Z",true,"https://home.nest.com/cameras/device_id?auth=access_token","nestmobile://cameras/device_id?auth=access_token",true,{"schema":[{"nullable":true,"name":"name","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":["Walkway",244083]},"2016-10-31T23:59:59.000Z"]}}]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"devices","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"thermostats\",\"type\":{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"device_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locale\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"software_version\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"structure_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"where_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_connection\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_online\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"can_cool\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"can_heat\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_using_emergency_heat\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"has_fan\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"fan_timer_active\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"fan_timer_timeout\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"temperature_scale\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"target_temperature_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"target_temperature_high_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"target_temperature_low_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"eco_temperature_high_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"eco_temperature_low_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"away_temperature_high_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"away_temperature_low_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"hvac_mode\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"humidity\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"hvac_state\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_locked\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locked_temp_min_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locked_temp_max_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}}]},\"valueContainsNull\":true},\"nullable\":true,\"metadata\":{}},{\"name\":\"smoke_co_alarms\",\"type\":{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"device_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locale\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"software_version\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"structure_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"where_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_connection\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_online\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"battery_health\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"co_alarm_state\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"smoke_alarm_state\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_manual_test_active\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_manual_test_time\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"ui_color_state\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"valueContainsNull\":true},\"nullable\":true,\"metadata\":{}},{\"name\":\"cameras\",\"type\":{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"device_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"software_version\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"structure_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"where_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_online\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_streaming\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_audio_input_enabled\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_is_online_change\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_video_history_enabled\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"web_url\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"app_url\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_public_share_enabled\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"activity_zones\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"id\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}},{\"name\":\"last_event\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"valueContainsNull\":true},\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532444118,"submitTime":1501532444099,"finishTime":1501532444429,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f69d263c-461f-43a9-b05b-73f83be714eb"},{"version":"CommandV1","origId":3117922773650652,"guid":"a4d43a88-7cb1-415a-8742-30c26f01420f","subtype":"command","commandType":"auto","position":42.0,"command":"%scala\nval stringJsonDF = nestDF2.select(to_json(struct($\"*\"))).toDF(\"nestDevice\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">stringJsonDF: org.apache.spark.sql.DataFrame = [nestDevice: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532452744,"submitTime":1501532452723,"finishTime":1501532452851,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"69356951-75fe-4e37-b5f8-e1bb9f3ed8bb"},{"version":"CommandV1","origId":3117922773650653,"guid":"13dbd6d8-7b6a-4f4b-a89d-ebe972e28be1","subtype":"command","commandType":"auto","position":43.0,"command":"%scala\nstringJsonDF.printSchema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- nestDevice: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532459287,"submitTime":1501532459268,"finishTime":1501532459369,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e5e1716b-c369-43db-8aa1-a2928d7b4da7"},{"version":"CommandV1","origId":3117922773650654,"guid":"17ead22e-7c60-4f9a-b7f3-f3ac3f861676","subtype":"command","commandType":"auto","position":44.0,"command":"%scala\ndisplay(stringJsonDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["{\"devices\":{\"thermostats\":{\"peyiJNo0IldT2YlIVtYaGQ\":{\"device_id\":\"peyiJNo0IldT2YlIVtYaGQ\",\"locale\":\"en-US\",\"software_version\":\"4.0\",\"structure_id\":\"VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\",\"where_name\":\"Hallway Upstairs\",\"last_connection\":\"2016-10-31T23:59:59.000Z\",\"is_online\":true,\"can_cool\":true,\"can_heat\":true,\"is_using_emergency_heat\":true,\"has_fan\":true,\"fan_timer_active\":true,\"fan_timer_timeout\":\"2016-10-31T23:59:59.000Z\",\"temperature_scale\":\"F\",\"target_temperature_f\":72.0,\"target_temperature_high_f\":80.0,\"target_temperature_low_f\":65.0,\"eco_temperature_high_f\":80.0,\"eco_temperature_low_f\":65.0,\"away_temperature_high_f\":80.0,\"away_temperature_low_f\":65.0,\"hvac_mode\":\"heat\",\"humidity\":40,\"hvac_state\":\"heating\",\"is_locked\":\"true\",\"locked_temp_min_f\":65.0,\"locked_temp_max_f\":80.0}},\"smoke_co_alarms\":{\"RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs\":{\"device_id\":\"RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs\",\"locale\":\"en-US\",\"software_version\":\"1.01\",\"structure_id\":\"VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\",\"where_name\":\"Jane's Room\",\"last_connection\":\"2016-10-31T23:59:59.000Z\",\"is_online\":true,\"battery_health\":\"ok\",\"co_alarm_state\":\"ok\",\"smoke_alarm_state\":\"ok\",\"is_manual_test_active\":true,\"last_manual_test_time\":\"2016-10-31T23:59:59.000Z\",\"ui_color_state\":\"gray\"}},\"cameras\":{\"awJo6rH0IldT2YlIVtYaGQ\":{\"device_id\":\"awJo6rH\",\"software_version\":\"4.0\",\"structure_id\":\"VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\",\"where_name\":\"Foyer\",\"is_online\":true,\"is_streaming\":true,\"is_audio_input_enabled\":true,\"last_is_online_change\":\"2016-12-29T18:42:00.000Z\",\"is_video_history_enabled\":true,\"web_url\":\"https://home.nest.com/cameras/device_id?auth=access_token\",\"app_url\":\"nestmobile://cameras/device_id?auth=access_token\",\"is_public_share_enabled\":true,\"activity_zones\":{\"name\":\"Walkway\",\"id\":244083},\"last_event\":\"2016-10-31T23:59:59.000Z\"}}}}"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"nestDevice","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532465789,"submitTime":1501532465769,"finishTime":1501532465981,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d73dee6f-b2ec-42a7-b1ee-9fcbc730d8e2"},{"version":"CommandV1","origId":3117922773650655,"guid":"2e5f072d-df24-43c1-88e6-a3d6cc4a0e8b","subtype":"command","commandType":"auto","position":45.0,"command":"%scala\nval mapColumnsDF = nestDF2.select($\"devices\".getItem(\"smoke_co_alarms\").alias (\"smoke_alarms\"),\n                                  $\"devices\".getItem(\"cameras\").alias (\"cameras\"),\n                                  $\"devices\".getItem(\"thermostats\").alias (\"thermostats\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">mapColumnsDF: org.apache.spark.sql.DataFrame = [smoke_alarms: map&lt;string,struct&lt;device_id:string,locale:string,software_version:string,structure_id:string,where_name:string,last_connection:string,is_online:boolean,battery_health:string,co_alarm_state:string,smoke_alarm_state:string,is_manual_test_active:boolean,last_manual_test_time:string,ui_color_state:string&gt;&gt;, cameras: map&lt;string,struct&lt;device_id:string,software_version:string,structure_id:string,where_name:string,is_online:boolean,is_streaming:boolean,is_audio_input_enabled:boolean,last_is_online_change:string,is_video_history_enabled:boolean,web_url:string,app_url:string,is_public_share_enabled:boolean,activity_zones:struct&lt;name:string,id:bigint&gt;,last_event:string&gt;&gt; ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532476936,"submitTime":1501532476916,"finishTime":1501532477081,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f28890d4-6019-4cbb-87d9-1ff8d18e4466"},{"version":"CommandV1","origId":3117922773650656,"guid":"a554fa08-3a43-4c41-ab35-2d824d1e891e","subtype":"command","commandType":"auto","position":46.0,"command":"%scala\ndisplay(mapColumnsDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[{"RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs":{"schema":[{"nullable":true,"name":"device_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"locale","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"software_version","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"structure_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"where_name","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"last_connection","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_online","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"battery_health","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"co_alarm_state","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"smoke_alarm_state","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_manual_test_active","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"last_manual_test_time","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"ui_color_state","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":["RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs","en-US","1.01","VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw","Jane's Room","2016-10-31T23:59:59.000Z",true,"ok","ok","ok",true,"2016-10-31T23:59:59.000Z","gray"]}},{"awJo6rH0IldT2YlIVtYaGQ":{"schema":[{"nullable":true,"name":"device_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"software_version","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"structure_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"where_name","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_online","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_streaming","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_audio_input_enabled","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"last_is_online_change","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_video_history_enabled","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"web_url","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"app_url","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_public_share_enabled","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"activity_zones","comment":null,"metadata":{"map":{}},"dataType":[{"nullable":true,"name":"name","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}}]},{"nullable":true,"name":"last_event","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":["awJo6rH","4.0","VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw","Foyer",true,true,true,"2016-12-29T18:42:00.000Z",true,"https://home.nest.com/cameras/device_id?auth=access_token","nestmobile://cameras/device_id?auth=access_token",true,{"schema":[{"nullable":true,"name":"name","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"id","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":["Walkway",244083]},"2016-10-31T23:59:59.000Z"]}},{"peyiJNo0IldT2YlIVtYaGQ":{"schema":[{"nullable":true,"name":"device_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"locale","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"software_version","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"structure_id","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"where_name","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"last_connection","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_online","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"can_cool","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"can_heat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_using_emergency_heat","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"has_fan","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"fan_timer_active","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"fan_timer_timeout","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"temperature_scale","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"target_temperature_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"target_temperature_high_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"target_temperature_low_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"eco_temperature_high_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"eco_temperature_low_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"away_temperature_high_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"away_temperature_low_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"hvac_mode","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"humidity","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"hvac_state","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"is_locked","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"locked_temp_min_f","comment":null,"metadata":{"map":{}},"dataType":{}},{"nullable":true,"name":"locked_temp_max_f","comment":null,"metadata":{"map":{}},"dataType":{}}],"values":["peyiJNo0IldT2YlIVtYaGQ","en-US","4.0","VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw","Hallway Upstairs","2016-10-31T23:59:59.000Z",true,true,true,true,true,true,"2016-10-31T23:59:59.000Z","F",72.0,80.0,65.0,80.0,65.0,80.0,65.0,"heat",40,"heating","true",65.0,80.0]}}]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"smoke_alarms","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"device_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locale\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"software_version\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"structure_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"where_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_connection\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_online\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"battery_health\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"co_alarm_state\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"smoke_alarm_state\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_manual_test_active\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_manual_test_time\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"ui_color_state\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"valueContainsNull\":true}","metadata":"{}"},{"name":"cameras","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"device_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"software_version\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"structure_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"where_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_online\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_streaming\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_audio_input_enabled\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_is_online_change\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_video_history_enabled\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"web_url\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"app_url\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_public_share_enabled\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"activity_zones\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"id\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}},{\"name\":\"last_event\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"valueContainsNull\":true}","metadata":"{}"},{"name":"thermostats","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"device_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locale\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"software_version\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"structure_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"where_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_connection\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_online\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"can_cool\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"can_heat\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_using_emergency_heat\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"has_fan\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"fan_timer_active\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"fan_timer_timeout\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"temperature_scale\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"target_temperature_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"target_temperature_high_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"target_temperature_low_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"eco_temperature_high_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"eco_temperature_low_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"away_temperature_high_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"away_temperature_low_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"hvac_mode\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"humidity\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"hvac_state\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_locked\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locked_temp_min_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locked_temp_max_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}}]},\"valueContainsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532484167,"submitTime":1501532484146,"finishTime":1501532484518,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6e5de08a-955e-4632-a782-a94c2a588274"},{"version":"CommandV1","origId":3117922773650657,"guid":"bc3b6690-7a5c-49b1-9367-1698211d191f","subtype":"command","commandType":"auto","position":47.0,"command":"%scala\nval explodedThermostatsDF = mapColumnsDF.select(explode($\"thermostats\"))\nval explodedCamerasDF = mapColumnsDF.select(explode($\"cameras\"))\n//or you could use the original nestDF2 and use the devices.X notation\nval explodedSmokedAlarmsDF =  nestDF2.select(explode($\"devices.smoke_co_alarms\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">explodedThermostatsDF: org.apache.spark.sql.DataFrame = [key: string, value: struct&lt;device_id: string, locale: string ... 25 more fields&gt;]\nexplodedCamerasDF: org.apache.spark.sql.DataFrame = [key: string, value: struct&lt;device_id: string, software_version: string ... 12 more fields&gt;]\nexplodedSmokedAlarmsDF: org.apache.spark.sql.DataFrame = [key: string, value: struct&lt;device_id: string, locale: string ... 11 more fields&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532492063,"submitTime":1501532492043,"finishTime":1501532492196,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"babb9fd9-3376-4258-985d-4976c28d77b1"},{"version":"CommandV1","origId":3117922773650658,"guid":"8b7084de-2c3b-4b1c-8fc0-58d6a3cab1fb","subtype":"command","commandType":"auto","position":48.0,"command":"%scala\ndisplay(explodedThermostatsDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["peyiJNo0IldT2YlIVtYaGQ",["peyiJNo0IldT2YlIVtYaGQ","en-US","4.0","VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw","Hallway Upstairs","2016-10-31T23:59:59.000Z",true,true,true,true,true,true,"2016-10-31T23:59:59.000Z","F",72.0,80.0,65.0,80.0,65.0,80.0,65.0,"heat",40,"heating","true",65.0,80.0]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"key","type":"\"string\"","metadata":"{}"},{"name":"value","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"device_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locale\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"software_version\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"structure_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"where_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_connection\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_online\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"can_cool\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"can_heat\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_using_emergency_heat\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"has_fan\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"fan_timer_active\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"fan_timer_timeout\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"temperature_scale\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"target_temperature_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"target_temperature_high_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"target_temperature_low_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"eco_temperature_high_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"eco_temperature_low_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"away_temperature_high_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"away_temperature_low_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"hvac_mode\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"humidity\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"hvac_state\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"is_locked\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locked_temp_min_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locked_temp_max_f\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532498690,"submitTime":1501532498669,"finishTime":1501532498908,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b7d96590-635e-4b37-a3a1-fd25b9e4cd30"},{"version":"CommandV1","origId":3117922773650659,"guid":"0987d8fe-28ed-40c6-9bb1-b99bc7bf4778","subtype":"command","commandType":"auto","position":49.0,"command":"%scala\nval thermostateDF = explodedThermostatsDF.select($\"value\".getItem(\"device_id\").alias(\"device_id\"), \n                                                 $\"value\".getItem(\"locale\").alias(\"locale\"),\n                                                 $\"value\".getItem(\"where_name\").alias(\"location\"),\n                                                 $\"value\".getItem(\"last_connection\").alias(\"last_connected\"),\n                                                 $\"value\".getItem(\"humidity\").alias(\"humidity\"),\n                                                 $\"value\".getItem(\"target_temperature_f\").alias(\"target_temperature_f\"),\n                                                 $\"value\".getItem(\"hvac_mode\").alias(\"mode\"),\n                                                 $\"value\".getItem(\"software_version\").alias(\"version\"))\n\nval cameraDF = explodedCamerasDF.select($\"value\".getItem(\"device_id\").alias(\"device_id\"),\n                                        $\"value\".getItem(\"where_name\").alias(\"location\"),\n                                        $\"value\".getItem(\"software_version\").alias(\"version\"),\n                                        $\"value\".getItem(\"activity_zones\").getItem(\"name\").alias(\"name\"),\n                                        $\"value\".getItem(\"activity_zones\").getItem(\"id\").alias(\"id\"))\n                                         \nval smokedAlarmsDF = explodedSmokedAlarmsDF.select($\"value\".getItem(\"device_id\").alias(\"device_id\"),\n                                                   $\"value\".getItem(\"where_name\").alias(\"location\"),\n                                                   $\"value\".getItem(\"software_version\").alias(\"version\"),\n                                                   $\"value\".getItem(\"last_connection\").alias(\"last_connected\"),\n                                                   $\"value\".getItem(\"battery_health\").alias(\"battery_health\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">thermostateDF: org.apache.spark.sql.DataFrame = [device_id: string, locale: string ... 6 more fields]\ncameraDF: org.apache.spark.sql.DataFrame = [device_id: string, location: string ... 3 more fields]\nsmokedAlarmsDF: org.apache.spark.sql.DataFrame = [device_id: string, location: string ... 3 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532508042,"submitTime":1501532508020,"finishTime":1501532508295,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8f888af0-5e64-4cac-9b17-1316fda47973"},{"version":"CommandV1","origId":3117922773650660,"guid":"4157e489-098c-4108-a065-060d2c4de09b","subtype":"command","commandType":"auto","position":50.0,"command":"%scala\ndisplay(thermostateDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["peyiJNo0IldT2YlIVtYaGQ","en-US","Hallway Upstairs","2016-10-31T23:59:59.000Z",40,72.0,"heat","4.0"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"device_id","type":"\"string\"","metadata":"{}"},{"name":"locale","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"last_connected","type":"\"string\"","metadata":"{}"},{"name":"humidity","type":"\"long\"","metadata":"{}"},{"name":"target_temperature_f","type":"\"double\"","metadata":"{}"},{"name":"mode","type":"\"string\"","metadata":"{}"},{"name":"version","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532515309,"submitTime":1501532515288,"finishTime":1501532515542,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bb56cd70-4d5a-490b-9cd8-c3a6306c4027"},{"version":"CommandV1","origId":3117922773650661,"guid":"d238cdd9-80f9-4df7-998f-006eec3f01eb","subtype":"command","commandType":"auto","position":51.0,"command":"%scala\ndisplay(cameraDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["awJo6rH","Foyer","4.0","Walkway",244083]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"device_id","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"version","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532521829,"submitTime":1501532521807,"finishTime":1501532522027,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"03953777-40d4-4e95-8c89-5a86d1da3031"},{"version":"CommandV1","origId":3117922773650662,"guid":"04c27e40-fe53-4dd3-b5d7-4c8c308f70cc","subtype":"command","commandType":"auto","position":52.0,"command":"%scala\ndisplay(smokedAlarmsDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs","Jane's Room","1.01","2016-10-31T23:59:59.000Z","ok"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"device_id","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"version","type":"\"string\"","metadata":"{}"},{"name":"last_connected","type":"\"string\"","metadata":"{}"},{"name":"battery_health","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532528502,"submitTime":1501532528481,"finishTime":1501532528675,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"02f24dd8-fcea-4287-84c5-f2e547597aff"},{"version":"CommandV1","origId":3117922773650663,"guid":"19a136ba-a855-4d03-a12e-3385c17b27c4","subtype":"command","commandType":"auto","position":53.0,"command":"%scala\nval joineDFs = thermostateDF.join(cameraDF, \"version\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">joineDFs: org.apache.spark.sql.DataFrame = [version: string, device_id: string ... 10 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532534983,"submitTime":1501532534962,"finishTime":1501532535126,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fdd8cebe-9405-4f59-94b9-af9ddb3f9e30"},{"version":"CommandV1","origId":3117922773650664,"guid":"fc3ee955-eeeb-418b-abf4-ea2ec45ce63a","subtype":"command","commandType":"auto","position":54.0,"command":"%scala\ndisplay(joineDFs)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["4.0","peyiJNo0IldT2YlIVtYaGQ","en-US","Hallway Upstairs","2016-10-31T23:59:59.000Z",40,72.0,"heat","awJo6rH","Foyer","Walkway",244083]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"version","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"string\"","metadata":"{}"},{"name":"locale","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"last_connected","type":"\"string\"","metadata":"{}"},{"name":"humidity","type":"\"long\"","metadata":"{}"},{"name":"target_temperature_f","type":"\"double\"","metadata":"{}"},{"name":"mode","type":"\"string\"","metadata":"{}"},{"name":"device_id","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532541385,"submitTime":1501532541363,"finishTime":1501532542530,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"76aa8393-0a6e-4c30-8ebe-e5f96f66e6cf"},{"version":"CommandV1","origId":3117922773650665,"guid":"234b94f6-cd1a-4c76-a642-686a9ec3ab08","subtype":"command","commandType":"auto","position":55.0,"command":"# import pyspark class Row from module sql\nfrom pyspark.sql import *\n\n# Create Example Data - Departments and Employees\n\n# Create the Departments\ndepartment1 = Row(id='123456', name='Computer Science')\ndepartment2 = Row(id='789012', name='Mechanical Engineering')\ndepartment3 = Row(id='345678', name='Theater and Drama')\ndepartment4 = Row(id='901234', name='Indoor Recreation')\n\n# Create the Employees\nEmployee = Row(\"firstName\", \"lastName\", \"email\", \"salary\")\nemployee1 = Employee('michael', 'armbrust', 'no-reply@berkeley.edu', 100000)\nemployee2 = Employee('xiangrui', 'meng', 'no-reply@stanford.edu', 120000)\nemployee3 = Employee('matei', None, 'no-reply@waterloo.edu', 140000)\nemployee4 = Employee(None, 'wendell', 'no-reply@berkeley.edu', 160000)\n\n# Create the DepartmentWithEmployees instances from Departments and Employees\ndepartmentWithEmployees1 = Row(department=department1, employees=[employee1, employee2])\ndepartmentWithEmployees2 = Row(department=department2, employees=[employee3, employee4])\ndepartmentWithEmployees3 = Row(department=department3, employees=[employee1, employee4])\ndepartmentWithEmployees4 = Row(department=department4, employees=[employee2, employee3])\n\nprint department1\nprint employee2\nprint departmentWithEmployees1.employees[0].email","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Row(id=&apos;123456&apos;, name=&apos;Computer Science&apos;)\nRow(firstName=&apos;xiangrui&apos;, lastName=&apos;meng&apos;, email=&apos;no-reply@stanford.edu&apos;, salary=120000)\nno-reply@berkeley.edu\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532589485,"submitTime":1501532589462,"finishTime":1501532589559,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9e8866b6-e174-4dca-9cdd-76179643e6ab"},{"version":"CommandV1","origId":3117922773650666,"guid":"e6ad6243-60fc-4071-81cd-f18fab1663f5","subtype":"command","commandType":"auto","position":56.0,"command":"departmentsWithEmployeesSeq1 = [departmentWithEmployees1, departmentWithEmployees2]\ndf1 = sqlContext.createDataFrame(departmentsWithEmployeesSeq1)\n\ndisplay(df1)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]]],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000],[null,"wendell","no-reply@berkeley.edu",160000]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532597408,"submitTime":1501532597383,"finishTime":1501532598512,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3ff45f85-079e-483f-99e4-37de754a5952"},{"version":"CommandV1","origId":3117922773650667,"guid":"c0d7b639-7f9b-4146-8577-4e3b41966697","subtype":"command","commandType":"auto","position":57.0,"command":"departmentsWithEmployeesSeq2 = [departmentWithEmployees3, departmentWithEmployees4]\ndf2 = sqlContext.createDataFrame(departmentsWithEmployeesSeq2)\n\ndisplay(df2)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@berkeley.edu",160000]]],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532604384,"submitTime":1501532604361,"finishTime":1501532604702,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5c56c987-955f-4fbf-ba93-62f119c99f43"},{"version":"CommandV1","origId":3117922773650668,"guid":"6f4554d9-bf71-451d-939a-2f07bac22615","subtype":"command","commandType":"auto","position":58.0,"command":"unionDF = df1.unionAll(df2)\ndisplay(unionDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]]],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000],[null,"wendell","no-reply@berkeley.edu",160000]]],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@berkeley.edu",160000]]],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532611081,"submitTime":1501532611059,"finishTime":1501532611468,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"51634bc3-4ada-46ba-9abd-211fdd06752d"},{"version":"CommandV1","origId":3117922773650669,"guid":"8450385b-d7cb-47b0-bfcc-6fe59d13cccd","subtype":"command","commandType":"auto","position":59.0,"command":"# Remove the file if it exists\ndbutils.fs.rm(\"/tmp/databricks-df-example.parquet\", True)\nunionDF.write.parquet(\"/tmp/databricks-df-example.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532617694,"submitTime":1501532617672,"finishTime":1501532623422,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e060e22b-e9d5-4223-9d58-70186ba61bf2"},{"version":"CommandV1","origId":3117922773650670,"guid":"8b475ff4-d736-4e63-81ae-d2df7a95403b","subtype":"command","commandType":"auto","position":60.0,"command":"parquetDF = sqlContext.read.parquet(\"/tmp/databricks-df-example.parquet\")\ndisplay(parquetDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@berkeley.edu",160000]]],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000],[null,"wendell","no-reply@berkeley.edu",160000]]],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]]],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532624808,"submitTime":1501532624785,"finishTime":1501532626815,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4a0a2635-40c6-4ec3-ac3f-96ed43c9e95b"},{"version":"CommandV1","origId":3117922773650671,"guid":"dc554737-fc60-4168-811a-2ad5b057f767","subtype":"command","commandType":"auto","position":61.0,"command":"from pyspark.sql.functions import explode\n\ndf = parquetDF.select(explode(\"employees\").alias(\"e\"))\nexplodeDF = df.selectExpr(\"e.firstName\", \"e.lastName\", \"e.email\", \"e.salary\")\n\ndisplay(explodeDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@berkeley.edu",160000],["matei",null,"no-reply@waterloo.edu",140000],[null,"wendell","no-reply@berkeley.edu",160000],["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000],["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;explode&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-15-a386272dada9&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>sql <span class=\"ansigreen\">import</span> Row<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> eDF <span class=\"ansiyellow\">=</span> sqlContext<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>a<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span> intlist<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> mapfield<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">{</span><span class=\"ansiblue\">&quot;a&quot;</span><span class=\"ansiyellow\">:</span> <span class=\"ansiblue\">&quot;b&quot;</span><span class=\"ansiyellow\">}</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>eDF<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span>explode<span class=\"ansiyellow\">(</span>eDF<span class=\"ansiyellow\">.</span>intlist<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>alias<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;anInt&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>anInt<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>anInt<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>anInt<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;explode&apos; is not defined</div>","workflows":[],"startTime":1501532685161,"submitTime":1501532685150,"finishTime":1501532686538,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"229529b4-3c5e-41b3-a0e5-62fd1793a079"},{"version":"CommandV1","origId":3117922773650672,"guid":"b2b3f809-bd67-4234-b59e-abfb42f2450b","subtype":"command","commandType":"auto","position":62.0,"command":"filterDF = explodeDF.filter(explodeDF.firstName == \"xiangrui\").sort(explodeDF.lastName)\ndisplay(filterDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["xiangrui","meng","no-reply@stanford.edu",120000],["xiangrui","meng","no-reply@stanford.edu",120000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532696534,"submitTime":1501532696511,"finishTime":1501532697200,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3e8bf576-e6ea-47d6-9738-4092af25d7dd"},{"version":"CommandV1","origId":3117922773650673,"guid":"f7b0e208-1be6-4be7-9d75-c28cd9b25842","subtype":"command","commandType":"auto","position":63.0,"command":"from pyspark.sql.functions import col, asc\n\n# Use `|` instead of `or`\nfilterDF = explodeDF.filter((col(\"firstName\") == \"xiangrui\") | (col(\"firstName\") == \"michael\")).sort(asc(\"lastName\"))\ndisplay(filterDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["michael","armbrust","no-reply@berkeley.edu",100000],["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000],["xiangrui","meng","no-reply@stanford.edu",120000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;col&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-18-21b58f0d9103&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>filterDF <span class=\"ansiyellow\">=</span> explodeDF<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;firstName&quot;</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">==</span> <span class=\"ansiblue\">&quot;xiangrui&quot;</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">|</span> <span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;firstName&quot;</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">==</span> <span class=\"ansiblue\">&quot;michael&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>sort<span class=\"ansiyellow\">(</span>asc<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;lastName&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> display<span class=\"ansiyellow\">(</span>filterDF<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;col&apos; is not defined</div>","workflows":[],"startTime":1501532710616,"submitTime":1501532710592,"finishTime":1501532711429,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f0990baa-e6ba-4198-b7d7-9255d39c2add"},{"version":"CommandV1","origId":3117922773650674,"guid":"331069e3-05ab-4ec8-84a4-5177f35f2637","subtype":"command","commandType":"auto","position":64.0,"command":"whereDF = explodeDF.where((col(\"firstName\") == \"xiangrui\") | (col(\"firstName\") == \"michael\")).sort(asc(\"lastName\"))\ndisplay(whereDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["michael","armbrust","no-reply@berkeley.edu",100000],["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000],["xiangrui","meng","no-reply@stanford.edu",120000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532718418,"submitTime":1501532718365,"finishTime":1501532719017,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9503321e-5dac-45ad-87fc-b066d30abafd"},{"version":"CommandV1","origId":3117922773650675,"guid":"b07a6636-3db3-4e95-aea1-a34936e5bfa0","subtype":"command","commandType":"auto","position":65.0,"command":"nonNullDF = explodeDF.fillna(\"--\")\ndisplay(nonNullDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["michael","armbrust","no-reply@berkeley.edu",100000],["--","wendell","no-reply@berkeley.edu",160000],["matei","--","no-reply@waterloo.edu",140000],["--","wendell","no-reply@berkeley.edu",160000],["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000],["xiangrui","meng","no-reply@stanford.edu",120000],["matei","--","no-reply@waterloo.edu",140000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532723318,"submitTime":1501532723294,"finishTime":1501532724308,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4dd1c816-a781-4017-bfd6-5576addd1669"},{"version":"CommandV1","origId":3117922773650676,"guid":"c125abdc-6b03-4411-8d0c-889f47eea20f","subtype":"command","commandType":"auto","position":66.0,"command":"filterNonNullDF = explodeDF.filter(col(\"firstName\").isNull() | col(\"lastName\").isNull()).sort(\"email\")\ndisplay(filterNonNullDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null,"wendell","no-reply@berkeley.edu",160000],[null,"wendell","no-reply@berkeley.edu",160000],["matei",null,"no-reply@waterloo.edu",140000],["matei",null,"no-reply@waterloo.edu",140000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532728874,"submitTime":1501532728850,"finishTime":1501532731072,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"312146e1-9339-4a19-ac59-1a366f60520a"},{"version":"CommandV1","origId":3117922773650677,"guid":"21594c76-7e76-4959-afa8-9dc6caeb27c5","subtype":"command","commandType":"auto","position":67.0,"command":"from pyspark.sql.functions import countDistinct\n\ncountDistinctDF = explodeDF.select(\"firstName\", \"lastName\")\\\n  .groupBy(\"firstName\", \"lastName\")\\\n  .agg(countDistinct(\"firstName\"))\n\ndisplay(countDistinctDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null,"wendell",0],["matei",null,1],["xiangrui","meng",1],["michael","armbrust",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"count(DISTINCT firstName)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532735256,"submitTime":1501532735232,"finishTime":1501532736561,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a66006a4-1384-4442-a973-aa4d0d8e7084"},{"version":"CommandV1","origId":3117922773650678,"guid":"5f64b614-ef23-4641-9760-802b2a4f1fee","subtype":"command","commandType":"auto","position":68.0,"command":"countDistinctDF.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*HashAggregate(keys=[firstName#2117, lastName#2118], functions=[count(distinct firstName#2117)])\n+- *HashAggregate(keys=[firstName#2117, lastName#2118], functions=[partial_count(distinct firstName#2117)])\n   +- *HashAggregate(keys=[firstName#2117, lastName#2118, firstName#2117], functions=[])\n      +- Exchange hashpartitioning(firstName#2117, lastName#2118, firstName#2117, 200)\n         +- *HashAggregate(keys=[firstName#2117, lastName#2118, firstName#2117], functions=[])\n            +- *Project [e#2114.firstName AS firstName#2117, e#2114.lastName AS lastName#2118]\n               +- *Generate explode(employees#2052), false, false, [e#2114]\n                  +- *FileScan parquet [employees#2052] Batched: false, Format: Parquet, Location: InMemoryFileIndex[dbfs:/tmp/databricks-df-example.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;employees:array&lt;struct&lt;firstName:string,lastName:string,email:string,salary:bigint&gt;&gt;&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532740366,"submitTime":1501532740342,"finishTime":1501532740405,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e8092cac-4e95-45cb-a5a2-13d2af5533ed"},{"version":"CommandV1","origId":3117922773650679,"guid":"25a33401-cca4-44cc-9352-40251ebbf50d","subtype":"command","commandType":"auto","position":69.0,"command":"# register the DataFrame as a temp table so that we can query it using SQL\nexplodeDF.registerTempTable(\"databricks_df_example\")\n\n# Perform the same query as the DataFrame above and return ``explain``\ncountDistinctDF_sql = sqlContext.sql(\"SELECT firstName, lastName, count(distinct firstName) as distinct_first_names FROM databricks_df_example GROUP BY firstName, lastName\")\n\ncountDistinctDF_sql.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*HashAggregate(keys=[firstName#2117, lastName#2118], functions=[count(distinct firstName#2117)])\n+- *HashAggregate(keys=[firstName#2117, lastName#2118], functions=[partial_count(distinct firstName#2117)])\n   +- *HashAggregate(keys=[firstName#2117, lastName#2118, firstName#2117], functions=[])\n      +- Exchange hashpartitioning(firstName#2117, lastName#2118, firstName#2117, 200)\n         +- *HashAggregate(keys=[firstName#2117, lastName#2118, firstName#2117], functions=[])\n            +- *Project [e#2114.firstName AS firstName#2117, e#2114.lastName AS lastName#2118]\n               +- *Generate explode(employees#2052), false, false, [e#2114]\n                  +- *FileScan parquet [employees#2052] Batched: false, Format: Parquet, Location: InMemoryFileIndex[dbfs:/tmp/databricks-df-example.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;employees:array&lt;struct&lt;firstName:string,lastName:string,email:string,salary:bigint&gt;&gt;&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532746051,"submitTime":1501532746026,"finishTime":1501532746091,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"adc2f6b0-e45c-49fa-bf62-da41181c1b7a"},{"version":"CommandV1","origId":3117922773650680,"guid":"cbeb0256-74e6-4e85-b05b-698b26fc48ab","subtype":"command","commandType":"auto","position":70.0,"command":"salarySumDF = explodeDF.agg({\"salary\" : \"sum\"})\ndisplay(salarySumDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1040000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"sum(salary)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532751694,"submitTime":1501532751669,"finishTime":1501532752435,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f5a05ee9-b2d5-4415-901b-a703a4d9dae3"},{"version":"CommandV1","origId":3117922773650681,"guid":"04c34f95-3bbe-4178-b50a-e50cff2b6667","subtype":"command","commandType":"auto","position":71.0,"command":"type(explodeDF.salary)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">27</span><span class=\"ansired\">]: </span>pyspark.sql.column.Column\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532756504,"submitTime":1501532756480,"finishTime":1501532756575,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fea474f2-c786-4b82-86e1-bf2739fb31bd"},{"version":"CommandV1","origId":3117922773650682,"guid":"98ae2df7-fd50-4ea2-b51a-acaf88cc85a2","subtype":"command","commandType":"auto","position":72.0,"command":"explodeDF.describe(\"salary\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+------------------+\n|summary|            salary|\n+-------+------------------+\n|  count|                 8|\n|   mean|          130000.0|\n| stddev|23904.572186687874|\n|    min|            100000|\n|    max|            160000|\n+-------+------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532762415,"submitTime":1501532762391,"finishTime":1501532763041,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aab045c3-ac16-4303-8a57-9e2c739cec3d"},{"version":"CommandV1","origId":3117922773650683,"guid":"aedd9015-6d24-407e-98a0-9b4864ed9580","subtype":"command","commandType":"auto","position":73.0,"command":"import pandas as pd\nimport matplotlib.pyplot as plt\nplt.clf()\npdDF = nonNullDF.toPandas()\npdDF.plot(x='firstName', y='salary', kind='bar', rot=45)\ndisplay()","commandVersion":0,"state":"finished","results":{"type":"image","data":"data:image/png;base64,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kW222Wbc04Cp4iR0AACgMwIIAADQGQEEAADojAACAAB0RgABAAA641uwAABmcd111+Xmm28e9zTmtGTJkmy66abjnsasPvKRj+TVr351Tj755Oy3337jng4LjAACADDkuuuuy2abbZHly+8c91TmtHjxBrn66qsWbAipqnFPgQVKAAEAGHLzzTf3w8dHkyzECxVeleXL983NN9+8YAMIzEUAAQCY0xZJXKgQ5pOT0AEApthnP/vZ7LLLLtl4442zePHiLFu2LDvttFOOP/74+2suu+yyHHTQQdlqq63y+Mc/Puuvv36e9axn5dBDD81///d/r/R9XXDBBTnggAPyK7/yK3nMYx6TDTbYIFtuuWX+7M/+LHffffeD6t/1rndl0aJF+cpXvpKPfexj2X777bPRRhvl6U9/eq6++uosWrQou+yyy5z3t+WWW2a99dbLj370o1XbKIyUPSAAAFPqhBNOyIEHHpilS5dm9913z5IlS3LTTTfliiuuyMknn5zXv/71SZITTzwxZ555Znbcccf81m/9VlasWJFLL700Rx11VM4999x84xvfyIYbbviw93fEEUfk6quvzg477JCXvOQlWb58eb7+9a/nXe96V7785S/n/PPPf8C5I1WVqspf/dVf5fzzz89uu+2WnXfeObfffns222yzvPCFL8wFF1yQ733ve3nmM5/5gPu68MIL853vfCcve9nL8sQnPnF+NxyPiAACADClTjjhhKy33nq54oor8vjHP/4By2699db7f3/729+e44477kEnln/4wx/Oa17zmhx33HF5y1ve8rD3d/zxx+epT33qg8b/9E//NH/+53+eT37yk3nZy172gGWttXzpS1/KRRddlF/7tV97wLI3vOEN+dKXvpQTTjghRx555IP+bVWV173udQ87L7rlECwAgCm29tprZ6211nrQ+OMe97j7f99kk01m/Var/fffP49+9KNz3nnnrdR9zRY+kuSggw5Ka23OPq973eseFD6SZI899sjSpUtz8skn5957771//LbbbssnPvGJPOMZz8jOO++8UnOjOwIIAMCU2meffXLnnXfml3/5l3PIIYfkM5/5zKzXPrnvvvvywQ9+MC94wQvy+Mc/PmuvvXYWLVqUtdZaK7fffnuuv/76lbq/O++8M4cffni22267PPaxj81aa62VRYsWZcmSJamqWftUVZ7znOfM2m+ttdbKa1/72txyyy351Kc+df/4KaeckrvuusvejwXKIVgAAFPq4IMPzi/+4i/muOOOy7HHHptjjjkmSbLjjjvmfe97X5797GcnSfbaa6+ceeaZecYznpE99tgjT3rSk7LeeuslSY4++uhZTyAfdt999+WFL3xhLrnkkmy55ZZ5xStekV/8xV/MOuusk6R3wvlcfZ70pCfN2feAAw7IX/zFX+Tv/u7v8opXvCLJzw8t23///Vd6W9AdAQQAYIrtu+++2XfffXP77bfnwgsvzKc//emcdNJJedGLXpTvfve7+cEPfpAzzzwzv/3bv52zzz47ixb9/ACa1lqOOOKIlbqfz3zmM7nkkkvyh3/4h/nQhz70gGU//OEP8653vWvOdR/qooYbb7xxdt9995x55pm55pprcvPNN+c73/lO9t577wed18LCIIAAAJBHP/rRedGLXpQXvehF+dnPfpYPf/jD+cpXvpJ77rknSbLbbrs9IHwkyTe+8Y3cddddK9X/e9/7Xqoqe+6554OWXXDBBY9o7m94wxvy6U9/On/7t3+bH//4x04+X+CcAwIAMKXmeuM/c92MDTbY4P4Tx4drb7rpprzxjW9c6ft66lOfmtbag/p8//vfz9ve9raH3MvxcHbZZZc861nPykc+8pGcccYZ2WyzzfKbv/mbq92P0bIHBABgSu2555551KMele233/7+gPDVr341l1xySZ7znOdk1113TVXlec97Xv7xH/8xz3ve8/L85z8/P/rRj3LOOedk8803z8Ybbzxr79baA/7ebbfd8sxnPjNHHXVUrrjiimy99da59tpr8/nPfz4veclL8vGPf/wR/VsOPPDAHHLIIfZ+TAABBABgTleNewJzmJ95HXHEETnvvPPyrW99K+ecc04WL16cpzzlKXnf+96XAw888P6v5z3rrLPyjne8I2effXaOPfbYLFu2LAcccEAOO+ywbLHFFrPuvRge22CDDfKlL30pb3vb23LBBRfka1/7Wp7+9KfnT//0T/PmN785p59++iPaC7L//vvn0EMPzXrrrZf99ttvtfswejWcThmfqtomyaVJnt1au2zc85lGP/9vcGmSbcY9nSGXJXl24vGxRvBYg/Ga+X/w0ksvzTbbPPj/weuuuy6bbbZFli+/s/vJraTFizfI1VdflU033XTcU1kQLrjgguy8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","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532767938,"submitTime":1501532767913,"finishTime":1501532769306,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fba990e3-9e9f-4383-b2c6-c87f0a97a363"},{"version":"CommandV1","origId":3117922773650684,"guid":"2d002963-733e-4c83-a8a8-8c5e1431a505","subtype":"command","commandType":"auto","position":74.0,"command":"dbutils.fs.rm(\"/tmp/databricks-df-example.parquet\", True)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">30</span><span class=\"ansired\">]: </span>True\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532774256,"submitTime":1501532774231,"finishTime":1501532774729,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9d8e32f0-e91e-4786-a6bd-a125489e9b11"},{"version":"CommandV1","origId":3117922773650685,"guid":"cd6c75b8-42ca-4a8e-94ae-ee0a84ac70b8","subtype":"command","commandType":"auto","position":75.0,"command":"from pyspark.sql import functions as F\nfrom pyspark.sql.types import *\n\n# Build an example DataFrame dataset to work with.\ndbutils.fs.rm(\"/tmp/dataframe_sample.csv\", True)\ndbutils.fs.put(\"/tmp/dataframe_sample.csv\", \"\"\"id|end_date|start_date|location\n1|2015-10-14 00:00:00|2015-09-14 00:00:00|CA-SF\n2|2015-10-15 01:00:20|2015-08-14 00:00:00|CA-SD\n3|2015-10-16 02:30:00|2015-01-14 00:00:00|NY-NY\n4|2015-10-17 03:00:20|2015-02-14 00:00:00|NY-NY\n5|2015-10-18 04:30:00|2014-04-14 00:00:00|CA-SD\n\"\"\", True)\n\nformatPackage = \"csv\" if sc.version > '1.6' else \"com.databricks.spark.csv\"\ndf = sqlContext.read.format(formatPackage).options(header='true', delimiter = '|').load(\"/tmp/dataframe_sample.csv\")\ndf.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Wrote 272 bytes.\nroot\n |-- id: string (nullable = true)\n |-- end_date: string (nullable = true)\n |-- start_date: string (nullable = true)\n |-- location: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532781539,"submitTime":1501532781513,"finishTime":1501532782263,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"49374daa-752a-44a4-80ae-98add3fac6ec"},{"version":"CommandV1","origId":3117922773650686,"guid":"4e5c4625-a559-4bef-8e09-ca10567ce72d","subtype":"command","commandType":"auto","position":76.0,"command":"# Instead of registering a UDF, call the builtin functions to perform operations on the columns.\n# This will provide a performance improvement as the builtins compile and run in the platform's JVM.\n\n# Convert to a Date type\ndf = df.withColumn('date', F.to_date(df.end_date))\n\n# Parse out the date only\ndf = df.withColumn('date_only', F.regexp_replace(df.end_date,' (\\d+)[:](\\d+)[:](\\d+).*$', ''))\n\n# Split a string and index a field\ndf = df.withColumn('city', F.split(df.location, '-')[1])\n\n# Perform a date diff function\ndf = df.withColumn('date_diff', F.datediff(F.to_date(df.end_date), F.to_date(df.start_date)))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532792059,"submitTime":1501532792031,"finishTime":1501532792182,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a09329d0-23b9-405c-a301-bfc48ddb0cc1"},{"version":"CommandV1","origId":3117922773650687,"guid":"242b6a6a-9ae0-45e0-92f9-169cb03783a4","subtype":"command","commandType":"auto","position":77.0,"command":"df.registerTempTable(\"sample_df\")\ndisplay(sql(\"select * from sample_df\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1","2015-10-14 00:00:00","2015-09-14 00:00:00","CA-SF","2015-10-14","2015-10-14","SF",30],["2","2015-10-15 01:00:20","2015-08-14 00:00:00","CA-SD","2015-10-15","2015-10-15","SD",62],["3","2015-10-16 02:30:00","2015-01-14 00:00:00","NY-NY","2015-10-16","2015-10-16","NY",275],["4","2015-10-17 03:00:20","2015-02-14 00:00:00","NY-NY","2015-10-17","2015-10-17","NY",245],["5","2015-10-18 04:30:00","2014-04-14 00:00:00","CA-SD","2015-10-18","2015-10-18","SD",552]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"end_date","type":"\"string\"","metadata":"{}"},{"name":"start_date","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"date","type":"\"date\"","metadata":"{}"},{"name":"date_only","type":"\"string\"","metadata":"{}"},{"name":"city","type":"\"string\"","metadata":"{}"},{"name":"date_diff","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532798418,"submitTime":1501532798392,"finishTime":1501532798702,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc5d996b-925b-4529-8cab-65d4f575b374"},{"version":"CommandV1","origId":3117922773650688,"guid":"df815bb4-ea53-4b80-9c41-e2699da9df70","subtype":"command","commandType":"auto","position":78.0,"command":"rdd_json = df.toJSON()\nrdd_json.take(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">34</span><span class=\"ansired\">]: </span>\n[u&apos;{&quot;id&quot;:&quot;1&quot;,&quot;end_date&quot;:&quot;2015-10-14 00:00:00&quot;,&quot;start_date&quot;:&quot;2015-09-14 00:00:00&quot;,&quot;location&quot;:&quot;CA-SF&quot;,&quot;date&quot;:&quot;2015-10-14&quot;,&quot;date_only&quot;:&quot;2015-10-14&quot;,&quot;city&quot;:&quot;SF&quot;,&quot;date_diff&quot;:30}&apos;,\n u&apos;{&quot;id&quot;:&quot;2&quot;,&quot;end_date&quot;:&quot;2015-10-15 01:00:20&quot;,&quot;start_date&quot;:&quot;2015-08-14 00:00:00&quot;,&quot;location&quot;:&quot;CA-SD&quot;,&quot;date&quot;:&quot;2015-10-15&quot;,&quot;date_only&quot;:&quot;2015-10-15&quot;,&quot;city&quot;:&quot;SD&quot;,&quot;date_diff&quot;:62}&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532804142,"submitTime":1501532804116,"finishTime":1501532804365,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c194ae77-b661-44d9-bd56-7fff29021024"},{"version":"CommandV1","origId":3117922773650689,"guid":"9bcc5df1-e6ad-4752-9d16-13ec131b3267","subtype":"command","commandType":"auto","position":79.0,"command":"from pyspark.sql import functions as F\n\nadd_n = udf(lambda x, y: x + y, IntegerType())\n\n# We register a UDF that adds a column to the DataFrame, and we cast the id column to an Integer type.\ndf = df.withColumn('id_offset', add_n(F.lit(1000), df.id.cast(IntegerType())))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532810377,"submitTime":1501532810352,"finishTime":1501532810449,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1f74ffa4-f901-4011-9fe8-f1f522c42c26"},{"version":"CommandV1","origId":3117922773650690,"guid":"b71c3ce5-ed21-4269-a88c-6fc2671e5eed","subtype":"command","commandType":"auto","position":80.0,"command":"display(df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1","2015-10-14 00:00:00","2015-09-14 00:00:00","CA-SF","2015-10-14","2015-10-14","SF",30,1001],["2","2015-10-15 01:00:20","2015-08-14 00:00:00","CA-SD","2015-10-15","2015-10-15","SD",62,1002],["3","2015-10-16 02:30:00","2015-01-14 00:00:00","NY-NY","2015-10-16","2015-10-16","NY",275,1003],["4","2015-10-17 03:00:20","2015-02-14 00:00:00","NY-NY","2015-10-17","2015-10-17","NY",245,1004],["5","2015-10-18 04:30:00","2014-04-14 00:00:00","CA-SD","2015-10-18","2015-10-18","SD",552,1005]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"end_date","type":"\"string\"","metadata":"{}"},{"name":"start_date","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"date","type":"\"date\"","metadata":"{}"},{"name":"date_only","type":"\"string\"","metadata":"{}"},{"name":"city","type":"\"string\"","metadata":"{}"},{"name":"date_diff","type":"\"integer\"","metadata":"{}"},{"name":"id_offset","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532814590,"submitTime":1501532814565,"finishTime":1501532814876,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b93d1d3e-053b-4cdd-9c92-eeeb0848faca"},{"version":"CommandV1","origId":3117922773650691,"guid":"4d1074ed-8b2b-47a6-bac3-0747f3d9bffb","subtype":"command","commandType":"auto","position":81.0,"command":"# any constants used by UDF will automatically pass through to workers\nN = 90\nlast_n_days = udf(lambda x: x < N, BooleanType())\n\ndf_filtered = df.filter(last_n_days(df.date_diff))\ndisplay(df_filtered)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1","2015-10-14 00:00:00","2015-09-14 00:00:00","CA-SF","2015-10-14","2015-10-14","SF",30,1001],["2","2015-10-15 01:00:20","2015-08-14 00:00:00","CA-SD","2015-10-15","2015-10-15","SD",62,1002]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"end_date","type":"\"string\"","metadata":"{}"},{"name":"start_date","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"date","type":"\"date\"","metadata":"{}"},{"name":"date_only","type":"\"string\"","metadata":"{}"},{"name":"city","type":"\"string\"","metadata":"{}"},{"name":"date_diff","type":"\"integer\"","metadata":"{}"},{"name":"id_offset","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532821242,"submitTime":1501532821217,"finishTime":1501532821533,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7759d488-0308-432f-86b2-44d7e0e50c63"},{"version":"CommandV1","origId":3117922773650692,"guid":"f16297ef-5795-4e8b-9e06-fa73d61d39cf","subtype":"command","commandType":"auto","position":82.0,"command":"df_1 = table(\"sample_df\")\ndf_2 = sqlContext.sql(\"select * from sample_df\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532827018,"submitTime":1501532826992,"finishTime":1501532827090,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cdab1f22-6651-4752-a504-0ee4206107c9"},{"version":"CommandV1","origId":3117922773650693,"guid":"84d98d4f-39b5-4ec5-b63c-230ace059181","subtype":"command","commandType":"auto","position":83.0,"command":"sqlContext.clearCache()\nsqlContext.cacheTable(\"sample_df\")\nsqlContext.uncacheTable(\"sample_df\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532833057,"submitTime":1501532833030,"finishTime":1501532833179,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2428f422-5504-4fcf-987a-0ac49cfb0f86"},{"version":"CommandV1","origId":3117922773650694,"guid":"23f65de3-20f7-4cee-9d63-72c6ea7b8c38","subtype":"command","commandType":"auto","position":84.0,"command":"agg_df = df.groupBy(\"location\").agg(F.min(\"id\"), F.count(\"id\"), F.avg(\"date_diff\"))\ndisplay(agg_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["NY-NY","3",2,260.0],["CA-SF","1",1,30.0],["CA-SD","2",2,307.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"min(id)","type":"\"string\"","metadata":"{}"},{"name":"count(id)","type":"\"long\"","metadata":"{}"},{"name":"avg(date_diff)","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532838655,"submitTime":1501532838628,"finishTime":1501532839561,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"147cdb0d-28c7-4f14-a332-9d66d15e8e66"},{"version":"CommandV1","origId":3117922773650695,"guid":"c3107def-9f75-4389-9eb7-f69eaedac6a6","subtype":"command","commandType":"auto","position":85.0,"command":"df = df.withColumn('end_month', F.month('end_date'))\ndf = df.withColumn('end_year', F.year('end_date'))\ndf.write.partitionBy(\"end_year\", \"end_month\").parquet(\"/tmp/sample_table\")\ndisplay(dbutils.fs.ls(\"/tmp/sample_table\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/tmp/sample_table/end_year=2015/","end_year=2015/",0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532846571,"submitTime":1501532846544,"finishTime":1501532849168,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5cb6efcd-fbf1-4858-a6b2-226ece37b83c"},{"version":"CommandV1","origId":3117922773650696,"guid":"3dbbec54-4e8c-48a6-89e9-887bb3413cf8","subtype":"command","commandType":"auto","position":86.0,"command":"null_item_schema = StructType([StructField(\"col1\", StringType(), True),\n                               StructField(\"col2\", IntegerType(), True)])\nnull_df = sqlContext.createDataFrame([(\"test\", 1), (None, 2)], null_item_schema)\ndisplay(null_df.filter(\"col1 IS NOT NULL\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["test",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col1","type":"\"string\"","metadata":"{}"},{"name":"col2","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532852169,"submitTime":1501532852143,"finishTime":1501532852434,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7da5ee97-c67c-4475-a181-598c9c2d60d0"},{"version":"CommandV1","origId":3117922773650697,"guid":"98fe4a01-7ebe-45db-b7c8-6ffc2177908f","subtype":"command","commandType":"auto","position":87.0,"command":"adult_df = sqlContext.read.\\\n    format(\"com.databricks.spark.csv\").\\\n    option(\"header\", \"false\").\\\n    option(\"inferSchema\", \"true\").load(\"dbfs:/databricks-datasets/adult/adult.data\")\nadult_df.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- _c0: integer (nullable = true)\n |-- _c1: string (nullable = true)\n |-- _c2: double (nullable = true)\n |-- _c3: string (nullable = true)\n |-- _c4: double (nullable = true)\n |-- _c5: string (nullable = true)\n |-- _c6: string (nullable = true)\n |-- _c7: string (nullable = true)\n |-- _c8: string (nullable = true)\n |-- _c9: string (nullable = true)\n |-- _c10: double (nullable = true)\n |-- _c11: double (nullable = true)\n |-- _c12: double (nullable = true)\n |-- _c13: string (nullable = true)\n |-- _c14: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532858755,"submitTime":1501532858721,"finishTime":1501532860065,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d2498add-e524-48c3-8a69-2bed6fc52d70"},{"version":"CommandV1","origId":3117922773650698,"guid":"dfa03e13-2ba5-450b-8d48-f7dbf14156a5","subtype":"command","commandType":"auto","position":88.0,"command":"%scala\n// Create the case classes for our domain\ncase class Department(id: String, name: String)\ncase class Employee(firstName: String, lastName: String, email: String, salary: Int)\ncase class DepartmentWithEmployees(department: Department, employees: Seq[Employee])\n\n// Create the Departments\nval department1 = new Department(\"123456\", \"Computer Science\")\nval department2 = new Department(\"789012\", \"Mechanical Engineering\")\nval department3 = new Department(\"345678\", \"Theater and Drama\")\nval department4 = new Department(\"901234\", \"Indoor Recreation\")\n\n// Create the Employees\nval employee1 = new Employee(\"michael\", \"armbrust\", \"no-reply@berkeley.edu\", 100000)\nval employee2 = new Employee(\"xiangrui\", \"meng\", \"no-reply@stanford.edu\", 120000)\nval employee3 = new Employee(\"matei\", null, \"no-reply@waterloo.edu\", 140000)\nval employee4 = new Employee(null, \"wendell\", \"no-reply@princeton.edu\", 160000)\n\n// Create the DepartmentWithEmployees instances from Departments and Employees\nval departmentWithEmployees1 = new DepartmentWithEmployees(department1, Seq(employee1, employee2))\nval departmentWithEmployees2 = new DepartmentWithEmployees(department2, Seq(employee3, employee4))\nval departmentWithEmployees3 = new DepartmentWithEmployees(department3, Seq(employee1, employee4))\nval departmentWithEmployees4 = new DepartmentWithEmployees(department4, Seq(employee2, employee3))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class Department\ndefined class Employee\ndefined class DepartmentWithEmployees\ndepartment1: Department = Department(123456,Computer Science)\ndepartment2: Department = Department(789012,Mechanical Engineering)\ndepartment3: Department = Department(345678,Theater and Drama)\ndepartment4: Department = Department(901234,Indoor Recreation)\nemployee1: Employee = Employee(michael,armbrust,no-reply@berkeley.edu,100000)\nemployee2: Employee = Employee(xiangrui,meng,no-reply@stanford.edu,120000)\nemployee3: Employee = Employee(matei,null,no-reply@waterloo.edu,140000)\nemployee4: Employee = Employee(null,wendell,no-reply@princeton.edu,160000)\ndepartmentWithEmployees1: DepartmentWithEmployees = DepartmentWithEmployees(Department(123456,Computer Science),List(Employee(michael,armbrust,no-reply@berkeley.edu,100000), Employee(xiangrui,meng,no-reply@stanford.edu,120000)))\ndepartmentWithEmployees2: DepartmentWithEmployees = DepartmentWithEmployees(Department(789012,Mechanical Engineering),List(Employee(matei,null,no-reply@waterloo.edu,140000), Employee(null,wendell,no-reply@princeton.edu,160000)))\ndepartmentWithEmployees3: DepartmentWithEmployees = DepartmentWithEmployees(Department(345678,Theater and Drama),List(Employee(michael,armbrust,no-reply@berkeley.edu,100000), Employee(null,wendell,no-reply@princeton.edu,160000)))\ndepartmentWithEmployees4: DepartmentWithEmployees = DepartmentWithEmployees(Department(901234,Indoor Recreation),List(Employee(xiangrui,meng,no-reply@stanford.edu,120000), Employee(matei,null,no-reply@waterloo.edu,140000)))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532875474,"submitTime":1501532875447,"finishTime":1501532875777,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2194b2f3-d0bf-487c-870d-60bdbc34a4fc"},{"version":"CommandV1","origId":3117922773650699,"guid":"c649994d-e450-4f12-8fe7-082a84113df2","subtype":"command","commandType":"auto","position":89.0,"command":"%scala\nval departmentsWithEmployeesSeq1 = Seq(departmentWithEmployees1, departmentWithEmployees2)\nval df1 = departmentsWithEmployeesSeq1.toDF()\ndisplay(df1)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]]],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000],[null,"wendell","no-reply@princeton.edu",160000]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532883532,"submitTime":1501532883505,"finishTime":1501532884153,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d34f5489-fc69-437c-8ef1-2fabfd58c6ec"},{"version":"CommandV1","origId":3117922773650700,"guid":"96371976-eb36-49e7-b1d9-c1b1fb91e186","subtype":"command","commandType":"auto","position":90.0,"command":"%scala\nval departmentsWithEmployeesSeq2 = Seq(departmentWithEmployees3, departmentWithEmployees4)\nval df2 = departmentsWithEmployeesSeq2.toDF()\ndisplay(df2)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@princeton.edu",160000]]],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532889858,"submitTime":1501532889830,"finishTime":1501532890209,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"77195b34-82f8-43e1-a089-0138948eb390"},{"version":"CommandV1","origId":3117922773650701,"guid":"a2e9e04d-500c-4dc6-99b5-24d1f40cb621","subtype":"command","commandType":"auto","position":91.0,"command":"%scala\nval unionDF = df1.unionAll(df2)\ndisplay(unionDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]]],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000],[null,"wendell","no-reply@princeton.edu",160000]]],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@princeton.edu",160000]]],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532896716,"submitTime":1501532896688,"finishTime":1501532896929,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7e2dcb1b-e43c-41ca-9a60-838ba0e9ceb2"},{"version":"CommandV1","origId":3117922773650702,"guid":"0135de26-a529-4666-b325-8b1bee1a06d4","subtype":"command","commandType":"auto","position":92.0,"command":"%scala\n// Remove the file if it exists\ndbutils.fs.rm(\"/tmp/databricks-df-example.parquet\", true)\nunionDF.write.parquet(\"/tmp/databricks-df-example.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532904647,"submitTime":1501532904620,"finishTime":1501532905983,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9a67fa12-6741-495a-8574-5daa0c53900e"},{"version":"CommandV1","origId":3117922773650703,"guid":"4ed02ade-f11a-4ee9-9f9e-5190b8a3be4d","subtype":"command","commandType":"auto","position":93.0,"command":"%scala\nval parquetDF = sqlContext.read.parquet(\"/tmp/databricks-df-example.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">parquetDF: org.apache.spark.sql.DataFrame = [department: struct&lt;id: string, name: string&gt;, employees: array&lt;struct&lt;firstName:string,lastName:string,email:string,salary:int&gt;&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532910996,"submitTime":1501532910969,"finishTime":1501532911526,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c55b18af-bcb4-4648-a879-16701b856857"},{"version":"CommandV1","origId":3117922773650704,"guid":"c50e52fd-ab17-40ba-958b-e392e77d6e7b","subtype":"command","commandType":"auto","position":94.0,"command":"%scala\nval explodeDF = parquetDF.explode($\"employees\") {\n  case Row(employee: Seq[Row]) => employee.map{ employee =>\n    val firstName = employee(0).asInstanceOf[String]\n    val lastName = employee(1).asInstanceOf[String]\n    val email = employee(2).asInstanceOf[String]\n    val salary = employee(3).asInstanceOf[Int]\n    Employee(firstName, lastName, email, salary)\n  }\n}.cache()\ndisplay(explodeDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000],[null,"wendell","no-reply@princeton.edu",160000]],"matei",null,"no-reply@waterloo.edu",140000],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000],[null,"wendell","no-reply@princeton.edu",160000]],null,"wendell","no-reply@princeton.edu",160000],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@princeton.edu",160000]],"michael","armbrust","no-reply@berkeley.edu",100000],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@princeton.edu",160000]],null,"wendell","no-reply@princeton.edu",160000],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]],"michael","armbrust","no-reply@berkeley.edu",100000],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]],"xiangrui","meng","no-reply@stanford.edu",120000],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]],"xiangrui","meng","no-reply@stanford.edu",120000],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]],"matei",null,"no-reply@waterloo.edu",140000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"},{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532917508,"submitTime":1501532917481,"finishTime":1501532918775,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a46650a2-e389-4e60-ab37-2f9709413be1"},{"version":"CommandV1","origId":3117922773650705,"guid":"4b3c78f8-d6a5-4d31-ab9a-d7e8d928772a","subtype":"command","commandType":"auto","position":95.0,"command":"%scala\nexplodeDF","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res41: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [department: struct&lt;id: string, name: string&gt;, employees: array&lt;struct&lt;firstName:string,lastName:string,email:string,salary:int&gt;&gt; ... 4 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532924196,"submitTime":1501532924168,"finishTime":1501532924281,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"db4c814d-2b52-4884-95d6-fb1ab90113cc"},{"version":"CommandV1","origId":3117922773650706,"guid":"2ead7d5f-dfd9-46de-9af3-ac44092f7013","subtype":"command","commandType":"auto","position":96.0,"command":"%scala\nval filterDF = explodeDF\n  .filter($\"firstName\" === \"xiangrui\" || $\"firstName\" === \"michael\")\n  .sort($\"lastName\".asc)\ndisplay(filterDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]],"michael","armbrust","no-reply@berkeley.edu",100000],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@princeton.edu",160000]],"michael","armbrust","no-reply@berkeley.edu",100000],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]],"xiangrui","meng","no-reply@stanford.edu",120000],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]],"xiangrui","meng","no-reply@stanford.edu",120000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"},{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532930730,"submitTime":1501532930718,"finishTime":1501532931006,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a2b30cb0-34ca-4a9c-8837-48b47ca18ee7"},{"version":"CommandV1","origId":3117922773650707,"guid":"fea1c144-14bc-4db9-aad6-4654ba2811f6","subtype":"command","commandType":"auto","position":97.0,"command":"%scala\nval whereDF = explodeDF.where(($\"firstName\" === \"xiangrui\") || ($\"firstName\" === \"michael\")).sort($\"lastName\".asc)\ndisplay(whereDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]],"michael","armbrust","no-reply@berkeley.edu",100000],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@princeton.edu",160000]],"michael","armbrust","no-reply@berkeley.edu",100000],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]],"xiangrui","meng","no-reply@stanford.edu",120000],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]],"xiangrui","meng","no-reply@stanford.edu",120000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"},{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532940050,"submitTime":1501532940021,"finishTime":1501532940267,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d75844b7-7461-453d-b196-81184e04d14d"},{"version":"CommandV1","origId":3117922773650708,"guid":"31f53dc8-e0dc-49f2-b15b-83cd57415187","subtype":"command","commandType":"auto","position":98.0,"command":"%scala\nval naFunctions = explodeDF.na\nval nonNullDF = naFunctions.fill(\"--\")\ndisplay(nonNullDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000],[null,"wendell","no-reply@princeton.edu",160000]],"matei","--","no-reply@waterloo.edu",140000],[["789012","Mechanical Engineering"],[["matei",null,"no-reply@waterloo.edu",140000],[null,"wendell","no-reply@princeton.edu",160000]],"--","wendell","no-reply@princeton.edu",160000],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@princeton.edu",160000]],"michael","armbrust","no-reply@berkeley.edu",100000],[["345678","Theater and Drama"],[["michael","armbrust","no-reply@berkeley.edu",100000],[null,"wendell","no-reply@princeton.edu",160000]],"--","wendell","no-reply@princeton.edu",160000],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]],"michael","armbrust","no-reply@berkeley.edu",100000],[["123456","Computer Science"],[["michael","armbrust","no-reply@berkeley.edu",100000],["xiangrui","meng","no-reply@stanford.edu",120000]],"xiangrui","meng","no-reply@stanford.edu",120000],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]],"xiangrui","meng","no-reply@stanford.edu",120000],[["901234","Indoor Recreation"],[["xiangrui","meng","no-reply@stanford.edu",120000],["matei",null,"no-reply@waterloo.edu",140000]],"matei","--","no-reply@waterloo.edu",140000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"},{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532947286,"submitTime":1501532947258,"finishTime":1501532947527,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9e1d7223-47a0-4040-a35b-ccd61c43dcbe"},{"version":"CommandV1","origId":3117922773650709,"guid":"8eecd648-b57f-426f-9759-8789d95f816c","subtype":"command","commandType":"auto","position":99.0,"command":"%scala\nval filterNonNullDF = nonNullDF.filter($\"firstName\" === \"\" || $\"lastName\" === \"\").sort($\"email\".asc)\ndisplay(filterNonNullDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"department","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"employees","type":"{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"firstName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"lastName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"email\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"salary\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true}","metadata":"{}"},{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"email","type":"\"string\"","metadata":"{}"},{"name":"salary","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532954061,"submitTime":1501532954033,"finishTime":1501532954272,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2629bfea-9de2-4dc5-b1cd-2cc59acab389"},{"version":"CommandV1","origId":3117922773650710,"guid":"66d9ebca-0f95-49eb-a779-d7b1c3664401","subtype":"command","commandType":"auto","position":100.0,"command":"%scala\nimport org.apache.spark.sql.functions._\nval countDistinctDF = nonNullDF.select($\"firstName\", $\"lastName\")\n  .groupBy($\"firstName\", $\"lastName\")\n  .agg(countDistinct($\"firstName\") as \"distinct_first_names\")\ndisplay(countDistinctDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["xiangrui","meng",1],["michael","armbrust",1],["matei","--",1],["--","wendell",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"firstName","type":"\"string\"","metadata":"{}"},{"name":"lastName","type":"\"string\"","metadata":"{}"},{"name":"distinct_first_names","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532969556,"submitTime":1501532969528,"finishTime":1501532970614,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"54c6ec48-9b77-4b55-8788-a6dec97d32ad"},{"version":"CommandV1","origId":3117922773650711,"guid":"22a5917a-9e54-4816-9d92-64de2cda4934","subtype":"command","commandType":"auto","position":101.0,"command":"%scala\ncountDistinctDF.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*HashAggregate(keys=[firstName#3086, lastName#3087], functions=[count(distinct firstName#3086)])\n+- *HashAggregate(keys=[firstName#3086, lastName#3087], functions=[partial_count(distinct firstName#3086)])\n   +- *HashAggregate(keys=[firstName#3086, lastName#3087, firstName#3086], functions=[])\n      +- Exchange hashpartitioning(firstName#3086, lastName#3087, firstName#3086, 200)\n         +- *HashAggregate(keys=[firstName#3086, lastName#3087, firstName#3086], functions=[])\n            +- *Project [coalesce(firstName#2891, --) AS firstName#3086, coalesce(lastName#2892, --) AS lastName#3087]\n               +- InMemoryTableScan [firstName#2891, lastName#2892]\n                     +- InMemoryRelation [department#2886, employees#2887, firstName#2891, lastName#2892, email#2893, salary#2894], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas)\n                           +- Generate UserDefinedGenerator(employees#2887), true, false, [firstName#2891, lastName#2892, email#2893, salary#2894]\n                              +- *FileScan parquet [department#2886,employees#2887] Batched: false, Format: Parquet, Location: InMemoryFileIndex[dbfs:/tmp/databricks-df-example.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;department:struct&lt;id:string,name:string&gt;,employees:array&lt;struct&lt;firstName:string,lastName:...\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532978312,"submitTime":1501532978283,"finishTime":1501532978693,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"273efd08-3386-407f-8831-22deaca68dfc"},{"version":"CommandV1","origId":3117922773650712,"guid":"7ecd0aeb-fce9-4221-b214-dc24633fbdf7","subtype":"command","commandType":"auto","position":102.0,"command":"%scala\n// register the DataFrame as a temp table so that we can query it using SQL\nnonNullDF.registerTempTable(\"databricks_df_example\")\n\n// Perform the same query as the DataFrame above and return ``explain``\nsqlContext.sql(\"\"\"\nSELECT firstName, lastName, count(distinct firstName) as distinct_first_names\nFROM databricks_df_example\nGROUP BY firstName, lastName\n\"\"\").explain","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*HashAggregate(keys=[firstName#3086, lastName#3087], functions=[count(distinct firstName#3086)])\n+- *HashAggregate(keys=[firstName#3086, lastName#3087], functions=[partial_count(distinct firstName#3086)])\n   +- *HashAggregate(keys=[firstName#3086, lastName#3087, firstName#3086], functions=[])\n      +- Exchange hashpartitioning(firstName#3086, lastName#3087, firstName#3086, 200)\n         +- *HashAggregate(keys=[firstName#3086, lastName#3087, firstName#3086], functions=[])\n            +- *Project [coalesce(firstName#2891, --) AS firstName#3086, coalesce(lastName#2892, --) AS lastName#3087]\n               +- InMemoryTableScan [firstName#2891, lastName#2892]\n                     +- InMemoryRelation [department#2886, employees#2887, firstName#2891, lastName#2892, email#2893, salary#2894], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas)\n                           +- Generate UserDefinedGenerator(employees#2887), true, false, [firstName#2891, lastName#2892, email#2893, salary#2894]\n                              +- *FileScan parquet [department#2886,employees#2887] Batched: false, Format: Parquet, Location: InMemoryFileIndex[dbfs:/tmp/databricks-df-example.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;department:struct&lt;id:string,name:string&gt;,employees:array&lt;struct&lt;firstName:string,lastName:...\n&lt;console&gt;:62: warning: method registerTempTable in class Dataset is deprecated: Use createOrReplaceTempView(viewName) instead.\nnonNullDF.registerTempTable(&quot;databricks_df_example&quot;)\n          ^\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532987910,"submitTime":1501532987881,"finishTime":1501532988023,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eea68192-69c8-4a6d-a1dd-3aeeb7373153"},{"version":"CommandV1","origId":3117922773650713,"guid":"6cf2e100-1fd5-4e31-ab58-48cf959d3410","subtype":"command","commandType":"auto","position":103.0,"command":"%scala\n// Sum up all the salaries\nval salarySumDF = nonNullDF.agg(\"salary\" -> \"sum\")\ndisplay(salarySumDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1040000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"sum(salary)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501532994750,"submitTime":1501532994720,"finishTime":1501532994991,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b5a99682-c02d-461e-b484-cf9622e83770"},{"version":"CommandV1","origId":3117922773650714,"guid":"03a8668a-ea04-4f78-a5ed-a7ec5d94e500","subtype":"command","commandType":"auto","position":104.0,"command":"%scala\nnonNullDF.describe(\"salary\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+------------------+\n|summary|            salary|\n+-------+------------------+\n|  count|                 8|\n|   mean|          130000.0|\n| stddev|23904.572186687874|\n|    min|            100000|\n|    max|            160000|\n+-------+------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533002130,"submitTime":1501533002100,"finishTime":1501533002377,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aec2d5a9-24b2-48a0-acc9-4f207826e506"},{"version":"CommandV1","origId":3117922773650715,"guid":"742b0bd1-295c-4591-8e63-41a7ba6bca9a","subtype":"command","commandType":"auto","position":105.0,"command":"%scala\nval veryNestedDF = Seq((\"1\", (2, (3, 4)))).toDF()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">veryNestedDF: org.apache.spark.sql.DataFrame = [_1: string, _2: struct&lt;_1: int, _2: struct&lt;_1: int, _2: int&gt;&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533009005,"submitTime":1501533008976,"finishTime":1501533009385,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6734daa7-6c6c-4034-98f8-727116960da3"},{"version":"CommandV1","origId":3117922773650716,"guid":"02ce30a8-880c-466a-be5f-caf35ecc35af","subtype":"command","commandType":"auto","position":106.0,"command":"%scala\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n\nimplicit class DataFrameFlattener(df: DataFrame) {\n  def flattenSchema: DataFrame = {\n    df.select(flatten(Nil, df.schema): _*)\n  }\n\n  protected def flatten(path: Seq[String], schema: DataType): Seq[Column] = schema match {\n    case s: StructType => s.fields.flatMap(f => flatten(path :+ f.name, f.dataType))\n    case other => col(path.map(n => s\"`$n`\").mkString(\".\")).as(path.mkString(\".\")) :: Nil\n  }\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\ndefined class DataFrameFlattener\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533016244,"submitTime":1501533016214,"finishTime":1501533016471,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ca984ac1-1414-4e56-98ab-eca69ce3c4f5"},{"version":"CommandV1","origId":3117922773650717,"guid":"f9eb14c8-a9dc-4119-91d9-542325e111c7","subtype":"command","commandType":"auto","position":107.0,"command":"%scala\ndisplay(veryNestedDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1",[2,[3,4]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"_1","type":"\"string\"","metadata":"{}"},{"name":"_2","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"_1\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}},{\"name\":\"_2\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"_1\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}},{\"name\":\"_2\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533022449,"submitTime":1501533022420,"finishTime":1501533022756,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"20ce2bd0-69f2-44bf-8e07-882ef6ecda11"},{"version":"CommandV1","origId":3117922773650718,"guid":"3ccc3502-4df8-474f-a7a0-c89bb639786f","subtype":"command","commandType":"auto","position":108.0,"command":"%scala\ndisplay(veryNestedDF.flattenSchema)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1",2,3,4]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"_1","type":"\"string\"","metadata":"{}"},{"name":"_2._1","type":"\"integer\"","metadata":"{}"},{"name":"_2._2._1","type":"\"integer\"","metadata":"{}"},{"name":"_2._2._2","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533028892,"submitTime":1501533028862,"finishTime":1501533029065,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ffbbe251-8449-4438-b1ab-9a95937eedea"},{"version":"CommandV1","origId":3117922773650719,"guid":"4ef82cf9-50c1-45b8-9563-a5349fccc413","subtype":"command","commandType":"auto","position":109.0,"command":"%scala\ndbutils.fs.rm(\"/tmp/databricks-df-example.parquet\", true)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res53: Boolean = true\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533036138,"submitTime":1501533036108,"finishTime":1501533036740,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1a425f13-8521-4e01-9f91-8da69aa4633a"},{"version":"CommandV1","origId":3117922773650720,"guid":"21393586-d5bf-4180-bf02-ecdb2ddcea4e","subtype":"command","commandType":"auto","position":110.0,"command":"%scala\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql._\nimport org.apache.hadoop.io.LongWritable\nimport org.apache.hadoop.io.Text\nimport org.apache.hadoop.conf.Configuration\nimport org.apache.hadoop.mapreduce.lib.input.TextInputFormat\n\n// Build an example DataFrame dataset to work with.\ndbutils.fs.rm(\"/tmp/dataframe_sample.csv\", true)\ndbutils.fs.put(\"/tmp/dataframe_sample.csv\", \"\"\"\nid|end_date|start_date|location\n1|2015-10-14 00:00:00|2015-09-14 00:00:00|CA-SF\n2|2015-10-15 01:00:20|2015-08-14 00:00:00|CA-SD\n3|2015-10-16 02:30:00|2015-01-14 00:00:00|NY-NY\n4|2015-10-17 03:00:20|2015-02-14 00:00:00|NY-NY\n5|2015-10-18 04:30:00|2014-04-14 00:00:00|CA-LA\n\"\"\", true)\n\nval conf = new Configuration\nconf.set(\"textinputformat.record.delimiter\", \"\\n\")\nval rdd = sc.newAPIHadoopFile(\"/tmp/dataframe_sample.csv\", classOf[TextInputFormat], classOf[LongWritable], classOf[Text], conf).map(_._2.toString).filter(_.nonEmpty)\n\nval header = rdd.first()\n// Parse the header line\nval rdd_noheader = rdd.filter(x => !x.contains(\"id\"))\n// Convert the RDD[String] to an RDD[Rows]. Create an array using the delimiter and use Row.fromSeq()\nval row_rdd = rdd_noheader.map(x => x.split('|')).map(x => Row.fromSeq(x))\n\nval df_schema =\n  StructType(\n    header.split('|').map(fieldName => StructField(fieldName, StringType, true)))\n\nvar df = sqlContext.createDataFrame(row_rdd, df_schema)\ndf.printSchema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Wrote 273 bytes.\nroot\n |-- id: string (nullable = true)\n |-- end_date: string (nullable = true)\n |-- start_date: string (nullable = true)\n |-- location: string (nullable = true)\n\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql._\nimport org.apache.hadoop.io.LongWritable\nimport org.apache.hadoop.io.Text\nimport org.apache.hadoop.conf.Configuration\nimport org.apache.hadoop.mapreduce.lib.input.TextInputFormat\nconf: org.apache.hadoop.conf.Configuration = Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml\nrdd: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[758] at filter at &lt;console&gt;:93\nheader: String = id|end_date|start_date|location\nrdd_noheader: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[759] at filter at &lt;console&gt;:97\nrow_rdd: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[761] at map at &lt;console&gt;:99\ndf_schema: org.apache.spark.sql.types.StructType = StructType(StructField(id,StringType,true), StructField(end_date,StringType,true), StructField(start_date,StringType,true), StructField(location,StringType,true))\ndf: org.apache.spark.sql.DataFrame = [id: string, end_date: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533047071,"submitTime":1501533047040,"finishTime":1501533048067,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6eb13cb3-9992-4dc1-9472-59c9e139ba8b"},{"version":"CommandV1","origId":3117922773650721,"guid":"db9cf084-493f-4d32-9534-e9c022beb937","subtype":"command","commandType":"auto","position":111.0,"command":"%scala\n// Instead of registering a UDF, call the builtin functions to perform operations on the columns.\n// This will provide a performance improvement as the builtins compile and run in the platform's JVM.\n\n// Convert to a Date type\nval timestamp2datetype: (Column) => Column = (x) => { to_date(x) }\ndf = df.withColumn(\"date\", timestamp2datetype(col(\"end_date\")))\n\n// Parse out the date only\nval timestamp2date: (Column) => Column = (x) => { regexp_replace(x,\" (\\\\d+)[:](\\\\d+)[:](\\\\d+).*$\", \"\") }\ndf = df.withColumn(\"date_only\", timestamp2date(col(\"end_date\")))\n\n// Split a string and index a field\nval parse_city: (Column) => Column = (x) => { split(x, \"-\")(1) }\ndf = df.withColumn(\"city\", parse_city(col(\"location\")))\n\n// Perform a date diff function\nval dateDiff: (Column, Column) => Column = (x, y) => { datediff(to_date(y), to_date(x)) }\ndf = df.withColumn(\"date_diff\", dateDiff(col(\"start_date\"), col(\"end_date\")))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">timestamp2datetype: org.apache.spark.sql.Column =&gt; org.apache.spark.sql.Column = &lt;function1&gt;\ndf: org.apache.spark.sql.DataFrame = [id: string, end_date: string ... 6 more fields]\ntimestamp2date: org.apache.spark.sql.Column =&gt; org.apache.spark.sql.Column = &lt;function1&gt;\ndf: org.apache.spark.sql.DataFrame = [id: string, end_date: string ... 6 more fields]\nparse_city: org.apache.spark.sql.Column =&gt; org.apache.spark.sql.Column = &lt;function1&gt;\ndf: org.apache.spark.sql.DataFrame = [id: string, end_date: string ... 6 more fields]\ndateDiff: (org.apache.spark.sql.Column, org.apache.spark.sql.Column) =&gt; org.apache.spark.sql.Column = &lt;function2&gt;\ndf: org.apache.spark.sql.DataFrame = [id: string, end_date: string ... 6 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533057063,"submitTime":1501533057032,"finishTime":1501533057507,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"be1c29c8-c60e-4887-b66b-8775cda1b1c6"},{"version":"CommandV1","origId":3117922773650722,"guid":"aaa60545-c607-4c74-a129-7e7095eacdb5","subtype":"command","commandType":"auto","position":112.0,"command":"%scala\ndf.registerTempTable(\"sample_df\")\ndisplay(sql(\"select * from sample_df\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1","2015-10-14 00:00:00","2015-09-14 00:00:00","CA-SF","2015-10-14","2015-10-14","SF",30],["2","2015-10-15 01:00:20","2015-08-14 00:00:00","CA-SD","2015-10-15","2015-10-15","SD",62],["3","2015-10-16 02:30:00","2015-01-14 00:00:00","NY-NY","2015-10-16","2015-10-16","NY",275],["4","2015-10-17 03:00:20","2015-02-14 00:00:00","NY-NY","2015-10-17","2015-10-17","NY",245],["5","2015-10-18 04:30:00","2014-04-14 00:00:00","CA-LA","2015-10-18","2015-10-18","LA",552]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"end_date","type":"\"string\"","metadata":"{}"},{"name":"start_date","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"date","type":"\"date\"","metadata":"{}"},{"name":"date_only","type":"\"string\"","metadata":"{}"},{"name":"city","type":"\"string\"","metadata":"{}"},{"name":"date_diff","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533064026,"submitTime":1501533063994,"finishTime":1501533064451,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1b24a293-b954-4ce1-90f8-5d9c46f3aa83"},{"version":"CommandV1","origId":3117922773650723,"guid":"77eeab23-0878-46b1-a3e2-10dcd995f533","subtype":"command","commandType":"auto","position":113.0,"command":"%scala\nval rdd_json = df.toJSON\nrdd_json.take(2).foreach(println)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">{&quot;id&quot;:&quot;1&quot;,&quot;end_date&quot;:&quot;2015-10-14 00:00:00&quot;,&quot;start_date&quot;:&quot;2015-09-14 00:00:00&quot;,&quot;location&quot;:&quot;CA-SF&quot;,&quot;date&quot;:&quot;2015-10-14&quot;,&quot;date_only&quot;:&quot;2015-10-14&quot;,&quot;city&quot;:&quot;SF&quot;,&quot;date_diff&quot;:30}\n{&quot;id&quot;:&quot;2&quot;,&quot;end_date&quot;:&quot;2015-10-15 01:00:20&quot;,&quot;start_date&quot;:&quot;2015-08-14 00:00:00&quot;,&quot;location&quot;:&quot;CA-SD&quot;,&quot;date&quot;:&quot;2015-10-15&quot;,&quot;date_only&quot;:&quot;2015-10-15&quot;,&quot;city&quot;:&quot;SD&quot;,&quot;date_diff&quot;:62}\nrdd_json: org.apache.spark.sql.Dataset[String] = [value: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533072047,"submitTime":1501533072017,"finishTime":1501533072633,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eb42efc8-9c42-4e10-bc55-c99d4a0b6c5e"},{"version":"CommandV1","origId":3117922773650724,"guid":"0008040a-703b-4f3c-bdc0-e24a7044ab65","subtype":"command","commandType":"auto","position":114.0,"command":"%scala\nval add_n = udf((x: Integer, y: Integer) => x + y)\n\n// We register a UDF that adds a column to the DataFrame, and we cast the id column to an Integer type.\ndf = df.withColumn(\"id_offset\", add_n(lit(1000), col(\"id\").cast(\"int\")))\ndisplay(df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1","2015-10-14 00:00:00","2015-09-14 00:00:00","CA-SF","2015-10-14","2015-10-14","SF",30,1001],["2","2015-10-15 01:00:20","2015-08-14 00:00:00","CA-SD","2015-10-15","2015-10-15","SD",62,1002],["3","2015-10-16 02:30:00","2015-01-14 00:00:00","NY-NY","2015-10-16","2015-10-16","NY",275,1003],["4","2015-10-17 03:00:20","2015-02-14 00:00:00","NY-NY","2015-10-17","2015-10-17","NY",245,1004],["5","2015-10-18 04:30:00","2014-04-14 00:00:00","CA-LA","2015-10-18","2015-10-18","LA",552,1005]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"end_date","type":"\"string\"","metadata":"{}"},{"name":"start_date","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"date","type":"\"date\"","metadata":"{}"},{"name":"date_only","type":"\"string\"","metadata":"{}"},{"name":"city","type":"\"string\"","metadata":"{}"},{"name":"date_diff","type":"\"integer\"","metadata":"{}"},{"name":"id_offset","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533080309,"submitTime":1501533080278,"finishTime":1501533080760,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"df35eca5-95d2-4b70-91a7-67ebfb976dbd"},{"version":"CommandV1","origId":3117922773650725,"guid":"4551fe32-8383-42a4-95f1-fe9c59330c21","subtype":"command","commandType":"auto","position":115.0,"command":"%scala\nval last_n_days = udf((x: Integer, y: Integer) => {\n  if (x < y) true else false\n})\n\n//last_n_days = udf(lambda x, y: True if x < y else False, BooleanType())\n\nval df_filtered = df.filter(last_n_days(col(\"date_diff\"), lit(90)))\ndisplay(df_filtered)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1","2015-10-14 00:00:00","2015-09-14 00:00:00","CA-SF","2015-10-14","2015-10-14","SF",30,1001],["2","2015-10-15 01:00:20","2015-08-14 00:00:00","CA-SD","2015-10-15","2015-10-15","SD",62,1002]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"end_date","type":"\"string\"","metadata":"{}"},{"name":"start_date","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"date","type":"\"date\"","metadata":"{}"},{"name":"date_only","type":"\"string\"","metadata":"{}"},{"name":"city","type":"\"string\"","metadata":"{}"},{"name":"date_diff","type":"\"integer\"","metadata":"{}"},{"name":"id_offset","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533087390,"submitTime":1501533087359,"finishTime":1501533087951,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"896462de-3387-4b50-bbb6-450851511b35"},{"version":"CommandV1","origId":3117922773650726,"guid":"c712fd16-4c7f-4504-87a2-fdc20e23acab","subtype":"command","commandType":"auto","position":116.0,"command":"%scala\n// Both return DataFrame types\nval df_1 = table(\"sample_df\")\nval df_2 = sqlContext.sql(\"select * from sample_df\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df_1: org.apache.spark.sql.DataFrame = [id: string, end_date: string ... 6 more fields]\ndf_2: org.apache.spark.sql.DataFrame = [id: string, end_date: string ... 6 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533096102,"submitTime":1501533096072,"finishTime":1501533096255,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e24255c1-871b-4c49-b901-e26a8019e0f3"},{"version":"CommandV1","origId":3117922773650727,"guid":"5da355bb-59fa-4685-8d66-aacaaa12be60","subtype":"command","commandType":"auto","position":117.0,"command":"%scala\nsqlContext.clearCache()\nsqlContext.cacheTable(\"sample_df\")\nsqlContext.uncacheTable(\"sample_df\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533106623,"submitTime":1501533106591,"finishTime":1501533106816,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6f331c0b-6ab7-475c-879e-c632ff5697fc"},{"version":"CommandV1","origId":3117922773650728,"guid":"ed89602c-3e9d-488b-b9c0-6b8e2b6250e2","subtype":"command","commandType":"auto","position":118.0,"command":"%scala\n// Provide the min, count, and avg and groupBy the location column. Diplay the results\nvar agg_df = df.groupBy(\"location\").agg(min(\"id\"), count(\"id\"), avg(\"date_diff\"))\ndisplay(agg_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["NY-NY","3",2,260.0],["CA-SF","1",1,30.0],["CA-LA","5",1,552.0],["CA-SD","2",1,62.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"min(id)","type":"\"string\"","metadata":"{}"},{"name":"count(id)","type":"\"long\"","metadata":"{}"},{"name":"avg(date_diff)","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533117506,"submitTime":1501533117476,"finishTime":1501533118243,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"637a0465-3085-4ad2-9605-1eefa14c5b98"},{"version":"CommandV1","origId":3117922773650729,"guid":"cb27870d-28dd-41b6-99b5-a37c0f3159ad","subtype":"command","commandType":"auto","position":119.0,"command":"%scala\ndf = df.withColumn(\"end_month\", month(col(\"end_date\")))\ndf = df.withColumn(\"end_year\", year(col(\"end_date\")))\ndbutils.fs.rm(\"/tmp/sample_table\", true)\ndf.write.partitionBy(\"end_year\", \"end_month\").parquet(\"/tmp/sample_table\")\ndisplay(dbutils.fs.ls(\"/tmp/sample_table\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/tmp/sample_table/end_year=2015/","end_year=2015/",0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533125265,"submitTime":1501533125233,"finishTime":1501533127884,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fb06e390-1254-4261-b60f-7137b61f15b1"},{"version":"CommandV1","origId":3117922773650730,"guid":"3b55aca7-b511-4337-baf8-76709833422a","subtype":"command","commandType":"auto","position":120.0,"command":"%scala\nval null_item_schema = StructType(Array(StructField(\"col1\", StringType, true),\n                               StructField(\"col2\", IntegerType, true)))\n\nval null_dataset = sc.parallelize(Array((\"test\", 1 ), (null, 2))).map(x => Row.fromTuple(x))\nval null_df = sqlContext.createDataFrame(null_dataset, null_item_schema)\ndisplay(null_df.filter(\"col1 IS NOT NULL\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["test",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col1","type":"\"string\"","metadata":"{}"},{"name":"col2","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533134921,"submitTime":1501533134890,"finishTime":1501533135245,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"38a0ef02-188c-4735-9b33-661bb2969ebe"},{"version":"CommandV1","origId":3117922773650731,"guid":"84fa9123-53a2-4edf-a0a2-581c49f45d93","subtype":"command","commandType":"auto","position":121.0,"command":"%scala\nval adult_df = sqlContext.read.\n    format(\"com.databricks.spark.csv\").\n    option(\"header\", \"false\").\n    option(\"inferSchema\", \"true\").load(\"dbfs:/databricks-datasets/adult/adult.data\")\nadult_df.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- _c0: integer (nullable = true)\n |-- _c1: string (nullable = true)\n |-- _c2: double (nullable = true)\n |-- _c3: string (nullable = true)\n |-- _c4: double (nullable = true)\n |-- _c5: string (nullable = true)\n |-- _c6: string (nullable = true)\n |-- _c7: string (nullable = true)\n |-- _c8: string (nullable = true)\n |-- _c9: string (nullable = true)\n |-- _c10: double (nullable = true)\n |-- _c11: double (nullable = true)\n |-- _c12: double (nullable = true)\n |-- _c13: string (nullable = true)\n |-- _c14: string (nullable = true)\n\nadult_df: org.apache.spark.sql.DataFrame = [_c0: int, _c1: string ... 13 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533142449,"submitTime":1501533142417,"finishTime":1501533143314,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"455c6f6a-eb6c-4058-b1f2-ae40765edcbd"},{"version":"CommandV1","origId":3117922773650732,"guid":"1e118bf6-b899-4f8b-b969-226c5eafe818","subtype":"command","commandType":"auto","position":122.0,"command":"%scala\nrequire(sc.version.replace(\".\", \"\").substring(0,3).toInt >= 160, \"Spark 1.6.0+ required to run this notebook.\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;require&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-44-77c708bcc552&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>require<span class=\"ansiyellow\">(</span>sc<span class=\"ansiyellow\">.</span>version<span class=\"ansiyellow\">.</span>replace<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;.&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>substring<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>toInt <span class=\"ansiyellow\">&gt;=</span> <span class=\"ansicyan\">160</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;Spark 1.6.0+ required to run this notebook.&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;require&apos; is not defined</div>","workflows":[],"startTime":1501533161723,"submitTime":1501533161690,"finishTime":1501533161903,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"541f1f9a-2adc-4ae6-b2be-522797c1abc6"},{"version":"CommandV1","origId":3117922773650733,"guid":"24457082-9ff0-45db-b6db-4ec961d136c9","subtype":"command","commandType":"auto","position":123.0,"command":"%scala\nval dataset = Seq(1, 2, 3).toDS()\ndataset.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+\n|value|\n+-----+\n|    1|\n|    2|\n|    3|\n+-----+\n\ndataset: org.apache.spark.sql.Dataset[Int] = [value: int]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533172039,"submitTime":1501533172007,"finishTime":1501533172415,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c9c46a09-3391-45f3-ad15-2879805eb649"},{"version":"CommandV1","origId":3117922773650734,"guid":"12381817-578c-4d3e-b119-119cda9bf686","subtype":"command","commandType":"auto","position":124.0,"command":"%scala\ncase class Person(name: String, age: Int)\n\nval personDS = Seq(Person(\"Max\", 33), Person(\"Adam\", 32), Person(\"Muller\", 62)).toDS()\npersonDS.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------+---+\n|  name|age|\n+------+---+\n|   Max| 33|\n|  Adam| 32|\n|Muller| 62|\n+------+---+\n\ndefined class Person\npersonDS: org.apache.spark.sql.Dataset[Person] = [name: string, age: int]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533179291,"submitTime":1501533179259,"finishTime":1501533179656,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"91f139c3-767c-4a74-a0de-e0744c07a0d6"},{"version":"CommandV1","origId":3117922773650735,"guid":"f19db0eb-3406-42bb-b367-3a086758d457","subtype":"command","commandType":"auto","position":125.0,"command":"%scala\nval rdd = sc.parallelize(Seq((1, \"Spark\"), (2, \"Databricks\")))\nval integerDS = rdd.toDS()\nintegerDS.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+----------+\n| _1|        _2|\n+---+----------+\n|  1|     Spark|\n|  2|Databricks|\n+---+----------+\n\nrdd: org.apache.spark.rdd.RDD[(Int, String)] = ParallelCollectionRDD[798] at parallelize at &lt;console&gt;:89\nintegerDS: org.apache.spark.sql.Dataset[(Int, String)] = [_1: int, _2: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533187184,"submitTime":1501533187153,"finishTime":1501533187471,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0b6625a3-044c-4938-82dd-6b0b61589b7b"},{"version":"CommandV1","origId":3117922773650736,"guid":"f4d4be2d-9212-45a7-bb95-b97d7f6fedba","subtype":"command","commandType":"auto","position":126.0,"command":"%scala\ncase class Company(name: String, foundingYear: Int, numEmployees: Int)\nval inputSeq = Seq(Company(\"ABC\", 1998, 310), Company(\"XYZ\", 1983, 904), Company(\"NOP\", 2005, 83))\nval df = sc.parallelize(inputSeq).toDF()\n\nval companyDS = df.as[Company]\ncompanyDS.show()","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Failed to serialize task 3477, not attempting to retry it. Exception during serialization: java.io.NotSerializableException: org.apache.hadoop.conf.Configuration","error":"<div class=\"ansiout\">Serialization stack:\n\t- object not serializable (class: org.apache.hadoop.conf.Configuration, value: Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: conf, type: class org.apache.hadoop.conf.Configuration)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@25988cfd)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@745076a9)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@3af3209c)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@5974ddff)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@704582af)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@6c55411f)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@2af63196)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@101c29a0)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@8920b00)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@1ee9a09f)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@20fbfbb0)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@6704d424)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@73fb4fa8)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@59eac27a)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@125c8889)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@3e56e0d4)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@4fb78b58)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@1c9528fc)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@5212bece)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC@51822846)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC@2c9f5341)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC@1ca34f46)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC@471eebff)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC, line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC@1e3107e5)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034124.$read, name: $iw, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034124.$read, line9cf4dd39b0174659a4d4f91c3706e034124.$read@1947007)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $VAL856, type: class line9cf4dd39b0174659a4d4f91c3706e034124.$read)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@2e4f500f)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $outer, type: class line9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@157e4d9a)\n\t- field (class: line9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$Company, name: $outer, type: class line9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$Company, Company(ABC,1998,310))\n\t- element of array (index: 0)\n\t- array (class [Lline9cf4dd39b0174659a4d4f91c3706e034146.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$Company;, size 1)\n\t- field (class: scala.collection.mutable.WrappedArray$ofRef, name: array, type: class [Ljava.lang.Object;)\n\t- object (class scala.collection.mutable.WrappedArray$ofRef, WrappedArray(Company(ABC,1998,310)))\n\t- writeObject data (class: org.apache.spark.rdd.ParallelCollectionPartition)\n\t- object (class org.apache.spark.rdd.ParallelCollectionPartition, org.apache.spark.rdd.ParallelCollectionPartition@8705)\n\t- field (class: org.apache.spark.scheduler.ResultTask, name: partition, type: interface org.apache.spark.Partition)\n\t- object (class org.apache.spark.scheduler.ResultTask, ResultTask(483, 2))\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1937)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1950)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1963)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:333)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset$$anonfun$7.apply(Dataset.scala:252)\n\tat org.apache.spark.sql.Dataset$$anonfun$7.apply(Dataset.scala:248)\n\tat org.apache.spark.sql.Dataset$$anonfun$60.apply(Dataset.scala:2791)\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:87)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:70)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:2790)\n\tat org.apache.spark.sql.Dataset.showString(Dataset.scala:248)\n\tat org.apache.spark.sql.Dataset.show(Dataset.scala:643)\n\tat org.apache.spark.sql.Dataset.show(Dataset.scala:602)\n\tat org.apache.spark.sql.Dataset.show(Dataset.scala:611)</div>","workflows":[],"startTime":1501533194324,"submitTime":1501533194324,"finishTime":1501533194927,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3bf0cc90-db13-497d-b032-f5615ced4258"},{"version":"CommandV1","origId":3117922773650737,"guid":"45601a5e-694e-4785-a1ff-2d9f4e71b91c","subtype":"command","commandType":"auto","position":127.0,"command":"%scala\nval rdd = sc.parallelize(Seq((1, \"Spark\"), (2, \"Databricks\"), (3, \"Notebook\")))\nval df = rdd.toDF(\"Id\", \"Name\")\n\nval dataset = df.as[(Int, String)]\ndataset.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+----------+\n| Id|      Name|\n+---+----------+\n|  1|     Spark|\n|  2|Databricks|\n|  3|  Notebook|\n+---+----------+\n\nrdd: org.apache.spark.rdd.RDD[(Int, String)] = ParallelCollectionRDD[806] at parallelize at &lt;console&gt;:104\ndf: org.apache.spark.sql.DataFrame = [Id: int, Name: string]\ndataset: org.apache.spark.sql.Dataset[(Int, String)] = [Id: int, Name: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533202269,"submitTime":1501533202236,"finishTime":1501533202771,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec4e0e1d-3695-4b84-a0ac-89783c67712d"},{"version":"CommandV1","origId":3117922773650738,"guid":"b1bf196e-96ba-4ff6-9d31-76f2d0a09615","subtype":"command","commandType":"auto","position":128.0,"command":"%scala\nval wordsDataset = sc.parallelize(Seq(\"Spark I am your father\", \"May the spark be with you\", \"Spark I am your father\")).toDS()\nval groupedDataset = wordsDataset.flatMap(_.toLowerCase.split(\" \"))\n                                 .filter(_ != \"\")\n                                 .groupBy(\"value\")\nval countsDataset = groupedDataset.count()\ncountsDataset.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------+-----+\n| value|count|\n+------+-----+\n|father|    2|\n|   you|    1|\n|  with|    1|\n|    be|    1|\n|  your|    2|\n|   may|    1|\n| spark|    3|\n|   the|    1|\n|     i|    2|\n|    am|    2|\n+------+-----+\n\nwordsDataset: org.apache.spark.sql.Dataset[String] = [value: string]\ngroupedDataset: org.apache.spark.sql.RelationalGroupedDataset = org.apache.spark.sql.RelationalGroupedDataset@6f98b6f7\ncountsDataset: org.apache.spark.sql.DataFrame = [value: string, count: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533219960,"submitTime":1501533219928,"finishTime":1501533220726,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"68bbb030-0adc-4b89-85e7-11e53b5cc6ec"},{"version":"CommandV1","origId":3117922773650739,"guid":"a117eae7-6e83-4b7b-a126-5b5ef4e4c433","subtype":"command","commandType":"auto","position":129.0,"command":"%scala\ncase class Employee(name: String, age: Int, departmentId: Int, salary: Double)\ncase class Department(id: Int, name: String)\n\ncase class Record(name: String, age: Int, salary: Double, departmentId: Int, departmentName: String)\ncase class ResultSet(departmentId: Int, departmentName: String, avgSalary: Double)\n\nval employeeDataSet1 = sc.parallelize(Seq(Employee(\"Max\", 22, 1, 100000.0), Employee(\"Adam\", 33, 2, 93000.0), Employee(\"Eve\", 35, 2, 89999.0), Employee(\"Muller\", 39, 3, 120000.0))).toDS()\nval employeeDataSet2 = sc.parallelize(Seq(Employee(\"John\", 26, 1, 990000.0), Employee(\"Joe\", 38, 3, 115000.0))).toDS()\nval departmentDataSet = sc.parallelize(Seq(Department(1, \"Engineering\"), Department(2, \"Marketing\"), Department(3, \"Sales\"))).toDS()\n\nval employeeDataset = employeeDataSet1.union(employeeDataSet2)\n\ndef averageSalary(key: (Int, String), iterator: Iterator[Record]): ResultSet = {\n   val (total, count) = iterator.foldLeft(0.0, 0.0) {\n       case ((total, count), x) => (total + x.salary, count + 1)\n   }\n   ResultSet(key._1, key._2, total/count)\n}\n\nval averageSalaryDataset = employeeDataset.joinWith(departmentDataSet, $\"departmentId\" === $\"id\", \"inner\")\n                                           .map(record => Record(record._1.name, record._1.age, record._1.salary, record._1.departmentId, record._2.name))\n                                           .filter(record => record.age > 25)\n                                           .groupBy($\"departmentId\", $\"departmentName\")\n                                           .avg()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class Employee\ndefined class Department\ndefined class Record\ndefined class ResultSet\nemployeeDataSet1: org.apache.spark.sql.Dataset[Employee] = [name: string, age: int ... 2 more fields]\nemployeeDataSet2: org.apache.spark.sql.Dataset[Employee] = [name: string, age: int ... 2 more fields]\ndepartmentDataSet: org.apache.spark.sql.Dataset[Department] = [id: int, name: string]\nemployeeDataset: org.apache.spark.sql.Dataset[Employee] = [name: string, age: int ... 2 more fields]\naverageSalary: (key: (Int, String), iterator: Iterator[Record])ResultSet\naverageSalaryDataset: org.apache.spark.sql.DataFrame = [departmentId: int, departmentName: string ... 3 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533240095,"submitTime":1501533240061,"finishTime":1501533241047,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"75f0ea1b-a4f3-415d-8a09-9cb9b61080e3"},{"version":"CommandV1","origId":3117922773650740,"guid":"c13c4505-9fb0-4f11-b7e8-928f8bdd84de","subtype":"command","commandType":"auto","position":130.0,"command":"%scala\naverageSalaryDataset.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------+--------------+--------+-----------+-----------------+\n|departmentId|departmentName|avg(age)|avg(salary)|avg(departmentId)|\n+------------+--------------+--------+-----------+-----------------+\n|           2|     Marketing|    34.0|    91499.5|              2.0|\n|           1|   Engineering|    26.0|   990000.0|              1.0|\n|           3|         Sales|    38.5|   117500.0|              3.0|\n+------------+--------------+--------+-----------+-----------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533245922,"submitTime":1501533245888,"finishTime":1501533247909,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1395c800-16c8-4227-a8de-1ffdf95e2efe"},{"version":"CommandV1","origId":3117922773650741,"guid":"d7b9ee88-5205-44eb-a240-ce54bbf7c383","subtype":"command","commandType":"auto","position":131.0,"command":"%scala\nimport org.apache.spark.sql.functions._\n\nval wordsDataset = sc.parallelize(Seq(\"Spark I am your father\", \"May the spark be with you\", \"Spark I am your father\")).toDS()\nval result = wordsDataset\n               .flatMap(_.split(\" \"))               // Split on whitespace\n               .filter(_ != \"\")                     // Filter empty words\n               .map(_.toLowerCase())\n               .toDF()                              // Convert to DataFrame to perform aggregation / sorting\n               .groupBy($\"value\")                   // Count number of occurences of each word\n               .agg(count(\"*\") as \"numOccurances\")\n               .orderBy($\"numOccurances\" desc)      // Show most common words first\nresult.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------+-------------+\n| value|numOccurances|\n+------+-------------+\n| spark|            3|\n|  your|            2|\n|father|            2|\n|     i|            2|\n|    am|            2|\n|   you|            1|\n|    be|            1|\n|  with|            1|\n|   the|            1|\n|   may|            1|\n+------+-------------+\n\nwarning: there were 1 feature warning(s); re-run with -feature for details\nimport org.apache.spark.sql.functions._\nwordsDataset: org.apache.spark.sql.Dataset[String] = [value: string]\nresult: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [value: string, numOccurances: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501533254029,"submitTime":1501533253996,"finishTime":1501533254855,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2e9115b9-ec8b-4100-9052-b4bef6e6e2b7"}],"dashboards":[],"guid":"245fa732-c126-43d9-a607-b187719f72e4","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
